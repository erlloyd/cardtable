{"version":3,"sources":["../node_modules/peerjs/dist sync","serviceWorkerRegistration.ts","constants/app-constants.ts","store/localStorage.ts","features/cards-data/initialState.ts","store/global.actions.ts","features/game/initialState.ts","constants/card-constants.ts","features/game/game.slice.ts","features/cards-data/cards-data.slice.ts","features/cards/cards.actions.ts","utilities/geo.ts","constants/card-pack-mapping.ts","constants/game-type-properties-mapping.tsx","features/cards-data/cards-data.selectors.ts","features/game/game.selectors.ts","features/cards/cards.selectors.ts","features/cards/cards.thunks.ts","features/cards/initialState.ts","features/cards/cards.slice.ts","features/counters/counters.actions.ts","features/counters/initialState.ts","features/counters/counters.slice.ts","store/rootReducer.ts","store/peer-js-redux-middleware.ts","store/configureStore.ts","PlayerHand.tsx","CardTokens.tsx","CardTokensContainer.tsx","constants/card-missing-image-map.ts","CardModifiers.tsx","CardModifiersContainer.tsx","Card.tsx","CardStackCardSelector.tsx","CardStackCardSelectorContainer.tsx","FileUploader.tsx","ContextMenu.tsx","Counter.tsx","DeckLoader.tsx","EncounterLoader.tsx","EncounterLoaderContainer.tsx","FirstPlayerToken.tsx","features/counters/counters.selectors.ts","FirstPlayerTokenContainer.tsx","PeerConnector.tsx","TopLayer.tsx","utilities/card-utils.ts","RadialMenu.tsx","PlayerHandContainer.tsx","PlanetMenuUtils.tsx","PlanetMenu.tsx","RadialMenuContainer.tsx","SpecificCardLoader.tsx","SpecificCardLoaderContainer.tsx","TokenValueModifier.tsx","OptionsMenu.tsx","OptionsMenuContainer.tsx","utilities/text-utils.ts","Game.tsx","generated/packsList.ts","generated/packsList_lotr.ts","features/cards-data/cards-data.thunks.ts","GameContainer.tsx","features/counters/counters.thunks.ts","utilities/marvel-txt-converter.ts","features/game/game.thunks.ts","images/card-table-transparent.png","App.tsx","AppContainer.tsx","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","GameType","myPeerRef","uuidv4","possibleColors","loadState","key","serializedState","localStorage","getItem","baseState","JSON","parse","present","err","queryParamsGameType","URLSearchParams","search","get","localGameState","initialState","activeDataType","activeGameType","MarvelChampions","data","resetApp","createAction","receiveRemoteGameState","verifyRemoteGameState","startDraggingCardFromHand","localStorageState","playerColors","playerNumbers","peerId","previewCard","menuPreviewCardJsonId","radialMenuPosition","specificCardLoaderPosition","draggingCardFromHand","StatusTokenType","CounterTokenType","stageZoom","x","y","stagePosition","drawCardsIntoHand","gameSlice","createSlice","name","reducers","updateZoom","action","payload","updatePosition","connectToRemoteGame","setPlayerInfo","ref","color","playerNumber","setPeerId","requestResync","setPreviewCardId","clearPreviewCard","setMenuPreviewCardJsonId","clearMenuPreviewCardJsonId","updateActiveGameType","quitGame","showRadialMenuAtPosition","hideRadialMenu","showSpecificCardLoader","hideSpecificCardLoader","stopDraggingCardFromHand","toggleDrawCardsIntoHand","extraReducers","builder","addCase","game","_action","actions","convertMarvelToCommonFormat","cardMarvelFormat","images","octgnId","octgn_id","quantity","doubleSided","double_sided","backLink","back_link","typeCode","type_code","subTypeCode","extraInfo","setCode","set_code","packCode","pack_code","factionCode","faction_code","duplicate_of","convertLOTRToCommonFormat","encounterCard","cardLOTRFormat","cardBackImage","Back","ImagePath","frontImage","Front","frontImageWithoutExtension","split","slice","join","length","Slug","CardSet","replaceAll","RingsDbCardId","Title","front","back","OctgnGuid","Quantity","CardType","CardSubType","storeCardData","isPlayerPack","careAboutDups","cs","stateLocation","entities","encounterEntities","card","cardsDataSlice","loadCardsData","activeData","setData","SetData","forEach","set","setTypeCode","card_set_type_code","cardsInSet","LordOfTheRingsLivingCardGame","Scenarios","scenario","Cycle","Product","loadCardsDataForPack","packType","isHeroPack","includes","pack","map","c","cards","loadCardsForEncounterSet","activeSet","concat","filter","cd","toLocaleLowerCase","indexOf","addCardStackWithId","pullCardOutOfCardStackWithId","drawCardsOutOfCardStackWithIds","startCardMoveWithSplitStackId","replaceCardStack","setStackShuffling","createDeckFromTextFileWithIds","cardConstants","getDistance","point1","point2","deltaX","deltaY","Math","sqrt","getCenter","p1","p2","CARD_PACK_REMAPPING","bkw","cap","drs","hlk","trors","twc","EXTRA_CARDS","doctor_strange","jsonId","ant","wsp","GamePropertiesMap","marvelchampions","deckSite","decklistApi","encounterUiName","backgroundImageLocation","possibleIcons","modifiers","attributeId","attributeName","icon","slot","tokens","stunned","tokenType","Stunned","touchMenuLetter","touchMenuIcon","fontSize","menuText","menuRemoveText","imagePath","confused","Confused","tough","Tough","damage","counterTokenType","Damage","isNumeric","threat","Threat","generic","Generic","lotrlcg","iconId","iconName","iconImageUrl","getCurrentCardData","cardsData","getCardsData","getCardsDataEntities","createSelector","getCardsDataHeroEntities","getCardsDataHeroEntitiesArrayWithoutDuplicates","Object","values","getCardsDataHerosByName","cardsDataByName","getCardsDataPlayerCardsByName","getCardsDataEncounterEntities","getCardsDataSetData","getCardsDataSetDataAsEncounterEntities","setDataToReturn","entries","value","cis","originalOrder","reduce","orderMap","entity","index","sort","a","b","getCardsDataEncounterEntitiesBySetCode","herosData","setTypesEncounters","campaignCards","pc","push","undefined","getGame","getPlayerColors","getPlayerNumbers","getPeerId","getActiveGameType","getRadialMenuPosition","getSpecificCardLoaderPosition","getMenuPreviewCard","controlledBy","exhausted","faceup","fill","statusTokens","counterTokens","selected","dragging","shuffling","cardStack","extraIcons","getCards","liveState","getPlayerHands","playerHands","getCardMapById","getPanMode","panMode","getMultiselectMode","multiselectMode","getDropTargetCardsById","returnVal","dropTargetCards","ownerRef","shuffleStack","dispatch","getState","cardsState","find","s","stackToShuffle","shuffledStack","shuffle","newStack","setTimeout","drawCardsOutOfCardStack","myPlayerNumber","possibleIds","Array","from","numberToDraw","_i","payloadWithIds","idsToUse","drawIntoHand","fetchDecklistById","createAsyncThunk","thunkApi","axios","gameType","decklistId","response","getMarvelCards","getLOTRCards","heroCardsData","heroSetCode","investigator_code","encounterCardsData","heroObligationDeck","replace","heroEncounterDeckData","heroEncounterDeck","extraCards","position","heroId","replaceDuplicateCards","dataId","extraHeroCards","relatedEncounterDeck","encounterDeckId","relatedObligationDeck","obligationDeckId","heroData","newSlots","slots","cardData","heroStack","heroes","cardDetails","array","temporaryValue","randomIndex","returnArray","stringify","currentIndex","floor","random","generateDefaultPlayerHands","queryParamsCardsString","JSONCrush","uncrush","attachTargetCards","ghostCards","outOfSyncWithRemote","defaultState","getCardStackWithId","mutateCardWithId","callback","cardToUpdate","foreachSelectedAndControlledCard","actorRef","foreachUnselectedCard","getDropTargetCard","draggedCardPosition","allowedDistance","possibleDropTargets","distance","c1","c2","deleteCardStackReducer","ACTOR_REF","stackIndex","findIndex","splice","getAttachDrawPos","baseCard","drawPos","takenSpace","i","xToDraw","yToDraw","unselectAllCardsReducer","cardsSlice","selectCard","unselectOtherCards","unselectCard","toggleSelectCard","exhaustCard","deleteCardStack","cardMove","movedCards","primaryCard","dx","dy","possibleAttachTargets","attachTarget","gc","attachGhostCard","movedCard","endCardMove","attachTargetCardStacks","unshift","dropTargetCard","cardFromHandMove","CARD_DROP_TARGET_DISTANCE","selectMultipleCards","ids","unselectAllCards","togglePanMode","toggleMultiselectMode","flipCards","reverse","resetCards","toggleToken","adjustCounterToken","delta","adjustModifier","modifierId","clearAllModifiers","clearCardTokens","reorderPlayerHand","hand","result","sourceIndex","removed","destinationIndex","removeFromPlayerHand","addToPlayerHand","playerIndex","playerHand","type","addToExistingCardStack","existingStack","existingStackId","cardJsonIds","addExtraIcon","removeExtraIcon","toggleExtraIcon","isEqual","original","cardToReplaceStack","cardStackToUse","cardStackId","newCardStack","newCard","assign","cardIndexToRemove","cardToStartMoving","splitTopCard","cardToMove","topCard","shift","splitCardId","sourceCardStackId","topCardDetails","facedown","stackToUpdate","handleLoadDeck","fulfilled","potentialHeroCard","heroCardStack","heroCard","mainDeckStack","cardPadding","newDeck","encounterDeck","obligationDeck","addNewCounterWithId","queryParamsCountersString","counters","firstPlayerCounterPosition","countersSlice","updateCounterValue","counter","removeCounter","moveCounter","newPos","moveFirstPlayerCounter","updateCounterColor","newColor","pos","undoableState","combineReducers","rootReducer","undoable","limit","groupBy","groupByActionTypes","excludeAction","blacklistRemoteActions","setupConnection","conn","storeAPI","on","INITIAL_STATE_MSG","RESYNC","send","PING","REMOTE_ACTION","customizedMiddleware","getDefaultMiddleware","thunk","immutableCheck","serializableCheck","activeCon","cgpPeer","Peer","host","path","secure","debug","iceServers","urls","username","credential","remoteParamArray","href","remoteId","connect","metadata","stateToSend","cloneDeep","setPlayerInfoAction","setInterval","currentState","peerConnection","onconnectionstatechange","ev","connectionState","next","ImageLoadingStatus","desiredWidth","desiredHeight","CardTokens","props","damageImg","threatImg","genericImg","unmounted","imagesLoaded","Image","tokenInfo","currentGameType","onload","setState","src","prevProps","prevState","this","damageX","damageY","showDamage","damageToken","scale","naturalWidth","naturalHeight","width","height","fillPatternImage","damageText","text","align","verticalAlign","threatX","threatY","showThreat","threatToken","threatText","genericX","genericY","showGeneric","Component","CardTokensContainer","CARD_ALREADY_ROTATED_MAP","MISSING_CARD_IMAGE_MAP","process","CardModifiers","imgs","modifiersInfo","additionalIcons","newImagesLoaded","m","updatedImagesLoaded","nodesToRender","modifierX","isPreview","cardWidth","modifierTextX","modifierY","showModifier","img","modifierValue","modifierToken","modifierText","background","iconX","iconY","CardModifiersContainer","AnimatedAny","animated","HORIZONTAL_TYPE_CODES","stringArraysEqual","array1","array2","every","Card","stunnedImg","confusedImg","toughImg","touchTimer","rect","shuffleToggle","initCardImages","imgUrls","imageLoaded","onerror","imageLoadFailed","imgUrl","getStrokeColor","dropTargetColor","selectedColor","renderUnanimatedCard","heightToUse","widthToUse","imgToUse","complete","getScale","offset","to","rotation","animatedProps","Rect","node","cornerRadius","stroke","strokeWidth","fillPatternRotation","shouldRenderImageHorizontal","fillPatternScaleX","fillPatternScaleY","shadowForStrokeEnabled","hitStrokeWidth","opacity","isGhost","draggable","onDragStart","handleDragStart","onDragMove","handleDragMove","onDragEnd","handleDragEnd","onDblClick","handleDoubleClick","onDblTap","handleDoubleTap","onClick","handleClick","onTap","handleTap","onMouseDown","handleMouseDown","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchEnd","onMouseOver","handleMouseOver","onMouseOut","handleMouseOut","onContextMenu","handleContextMenu","cardStackOffset","numCardsInStack","shouldRenderStunned","cardState","tokenImagesLoaded","stunnedToken","getTokenInSlot","confusedToken","toughToken","cardTokens","cardModifiers","cardHeight","renderCardName","event","target","handleTapOrClick","wasTouch","cancelBubble","clearTimeout","handleHover","handleHoverLeave","prevImgUrls","currentRotation","duration","renderCard","textOffset","shouldRender","dimensions","stunnedOffset","native","typeCodes","plainCardBack","widthHorizontal","heightHorizontal","some","CardStackCardSelector","cardsDataInStack","renderTouchList","className","FormControl","InputLabel","Select","onChange","val","handleSelected","cardsDataEntities","variant","MenuItem","stopPropagation","preventDefault","preview","renderAutocomplete","Autocomplete","options","getOptionLabel","option","style","onHighlightChange","handleHighlightChange","renderInput","params","TextField","label","_event","reason","clearPreview","cardSelected","onKeyPress","touchBased","CardStackCardSelectorContainer","FileUploader","hiddenFileInput","React","useRef","current","evt","document","createEvent","initEvent","dispatchEvent","files","fileUploaded","handleFile","display","ContextMenu","nestedRef","renderMenuItem","children","parentMenuOpen","menuOpen","parentElement","focus","nestedI","nestedIndex","fileUploader","file","reader","FileReader","readAsText","readerEvent","content","fileLoadedAction","hideContextMenu","handleContextItemClicked","handleMenuClosed","item","nativeEvent","pointerType","contextItemClicked","items","blur","Menu","keepMounted","open","onClose","anchorReference","anchorEl","anchorPosition","top","left","Counter","handleDecrement","updateCounterValueBy","handleIncrement","DeckLoader","inputValue","focusInputField","input","querySelector","handleKeyPress","loadDeckId","EncounterLoader","questCards","encounterCards","filteredCards","oc","totalCards","loadCards","encounterData","EncounterLoaderContainer","ownProps","FirstPlayerToken","updatePos","image","getCounters","getCurrentCounters","getFirstPlayerTokenPos","FirstPlayerTokenContainer","PeerConnector","inputRef","TopLayer","completed","offsetContent","containerStyle","trasparentBackground","backgroundColor","anyCardStackHasStatus","status","stacks","getMySelectedCards","generateLCGCDNImageUrl","codeToUse","groupCode","substring","cardCode","toLocaleUpperCase","cardSuffix","getImgUrls","topCardData","codeForMissingCheck","missingImageOverride","checkMissingImageMap","getItemStyle","snapshot","draggableStyle","dropAnimation","draggingOver","visibility","userSelect","margin","MenuType","DrawMode","PlayerHand","tapped","modal","imgUrlToStatusMap","showMenu","bind","provided","destination","droppableId","source","cardDroppedJson","playerHandData","droppedOnTable","droppedBackInHand","renderTopLayer","randIndex","dropPos","onBeforeCapture","direction","clearPreviewCardJsonId","innerRef","isDraggingOver","alignItems","padding","overflowX","overflowY","bottom","zIndex","boxSizing","droppableProps","IconButton","draggableId","onPointerEnter","setPreviewCardJsonId","onPointerLeave","draggableProps","dragHandleProps","renderCardContents","placeholder","renderDroppableIfDragging","loadedImgs","url","iData","Loaded","firstLoadedImage","onLoad","onError","LoadingFailed","alt","isDraggingAtAll","overflow","PlayerHandContainer","num","reactPieMenu","require","PieMenu","default","Slice","RenderType","renderMenuSlices","visibleMenu","setVisibleMenu","currentDrawMode","setCurrentDrawMode","currentModifier","setCurrentModifer","slices","backMenu","StatusTokenActions","renderStatusTokensMenu","TopLevelActions","CounterTokenActions","renderCounterTokensMenu","DrawActions","renderDrawMenu","DrawNumber","renderDrawNumberMenu","ModifierActions","renderModifierMenu","ModifierNumber","renderModifierNumberMenu","ModifierExtraIcons","renderModifierExtraIconsMenu","renderTopLevelMenu","renderMenuWithBackButton","onSelect","selectedCardStacks","flatMap","showCardSelector","FaceUp","FaceDown","mi","toString","_","setCurrentModifier","RadialMenu","useState","max","radius","centerRadius","RadialMenuContainer","peerRef","SpecificCardLoader","SpecificCardLoaderContainer","TokenValueModifier","newValue","updated","Button","marginLeft","OptionsMenu","showContextMenuAtPosition","Tooltip","title","cx","anyCardsSelected","visualViewport","undo","redo","OptionsMenuContainer","ActionCreators","copyToClipboard","clipboard","writeText","Game","stage","doubleTapTimer","lastCenter","lastDist","lastMousePos","captureLastMousePos","componentWillUnmount","removeEventListener","handleResize","handleCounterValueUpdate","handleCounterDrag","noOp","renderEmptyMessage","renderContextMenu","showContextMenu","containerRect","container","getBoundingClientRect","pointerPosition","contextMenuPosition","contextMenuItems","clearContextMenu","renderPreviewCardModal","previewCardModal","renderOptionsMenu","renderDeckImporter","showDeckImporter","deckImporterPosition","clearDeckImporter","handleImportDeck","getRelativePositionFromTarget","renderEncounterImporter","showEncounterImporter","encounterImporterPosition","clearEncounterImporter","handleLoadEncounter","renderCardSearch","showCardSearch","cardSearchPosition","cardStackForSearching","clearCardSearch","cardSearchTouchBased","handleCardSelectedFromCardStack","renderPeerConnector","showPeerConnector","peerConnectorPosition","clearPeerConnector","handlePeerConnect","renderTokenModifier","showTokenValueModifier","tokenValueModifierPosition","tokenValueModifierProps","clearTokenValueModifier","addCardStack","pullCardOutOfCardStack","handleStageClickOrTap","mousePos","selectStartPos","handleWheel","oldScale","gameState","pointer","getPointerPosition","mousePointTo","newScale","handleCounterContextMenu","counterId","menuItems","handleCardContextMenu","cardId","mySelectedCards","saveDeckAsJson","tokenInfoForGameType","modifiersForGameType","extraIconsForGameType","handleCardClick","modifierKeyHeld","shiftKey","metaKey","ctrlKey","handleSelectAndExhaust","showOrToggleModalPreviewCard","handleCardDragStart","draggingCard","hasStack","upperRightPoint","TouchEvent","startCardMove","handleCardDragEnd","innerHeight","min","translatedMax","translatedMin","modifier","intCode","parseInt","Number","isNaN","handleKeyDown","getRawPreviewCardPosition","horizontal","pointerPos","screenMidPointX","innerWidth","screenMidPointY","posParam","transform","getAbsoluteTransform","copy","invert","point","MouseEvent","button","selecting","getSelectionRectInfo","selectRect","abs","handleMouseUp","drewASelectionRect","selectedCards","currSelectedCards","Intersects","touch1","touches","touch2","handleMultiTouch","handleMouseMove","isDragging","stopDrag","clientX","clientY","newCenter","dist","pointTo","currentTarget","jsonContents","createDeckFromJson","addNewCounter","origin","pathname","generateGameStateUrl","getCardType","mainCardData","getCardName","cardInQuestion","getCardCode","idToGrab","stageHeight","stageWidth","Konva","hitOnDragEnabled","playmatImage","playmatImageLoaded","allJsonData","addEventListener","activeElement","body","el","staticCards","dropTargetCardsById","movingCards","iAmDragging","possiblePreviewCards","menuPreviewCard","previewCards","_card","previewCardHeight","isHorizontal","rawPos","previewPos","previewCardWidth","playmatScale","tabIndex","onKeyDown","onMouseUp","onMouseMove","myDropTargetCard","dt","isSelect","Consumer","store","onWheel","packList","getSpecificMarvelPack","packName","res","getSpecificLOTRPack","getSpecificLOTRScenario","GameContainer","Promise","all","marvelPackList","lotrPackList","scenarioListLOTR","AllCards","payloadWithId","createDeckFromTxt","heroCardsDataByName","playerCardsDataByName","heroDataByName","playerCardDataByName","txtContents","nonEmptyLines","l","trim","heroName","packLineIndex","startsWith","hero","pattern","slotLines","sl","cardName","convertMarvelTxtToDeckInfo","_dispatch","currentStoreState","crushedCardsString","crush","crushedCountersString","encodeURIComponent","objectData","filename","createElement","download","appendChild","click","removeChild","renderGamePicker","mainLogo","labelId","toUpperCase","App","clearQueryParams","useEffect","AppContainer","history","replaceState","rtkConfigureStore","reducer","middleware","devTools","subscribe","throttle","blacklistStateKeys","setItem","saveState","configureStore","ReactDOM","render","StrictMode","getElementById","URL","fetch","headers","contentType","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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AOyiB,EAAM5jB,OAIe,GAAzB4iB,CAA6Be,IChB5CwC,GAAuD,CAClE,SAAS,GAGEC,GAAoD,CAC/D,SACEC,yDAKF,SACEA,2DAKF,SACEA,yDAKF,SACEA,2DAKF,SACEA,yDAKF,SACEA,2DAKF,QACEA,yDAKF,0BACEA,2DAKF,QACEA,yDAKF,0BACEA,2DAKF,SACEA,yDAKF,SACEA,2DAKF,QAAS,qEACT,0BACE,qEAEF,QAAS,qEACT,0BACE,qEAEF,MAAS,mDAGT,SAAU,iDACV,SAAU,iDACV,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEAGT,SAAU,iDACV,SAAU,iDACV,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEAGT,SAAU,iDACV,SACE,qEACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,uEACF,MAAS,oEACT,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEAGF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,SACE,qEACF,0BACE,qEACF,SACE,qEACF,MAAS,qEACT,SACE,qEACF,0BACE,qEACF,SACE,qEACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,SAAU,iDACV,SAAU,iDACV,MAAS,qEACT,MAAS,qEACT,MAAS,mEACT,MAAS,mEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,SAAU,iDACV,SAAU,iDACV,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,uEACF,MACE,uEACF,MACE,uEACF,MACE,uEACF,MAAS,8DACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MACE,sEACF,MACE,sEACF,MACE,yFACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MACE,sEACF,MACE,sEACF,MACE,sEAGF,SAAU,iDACV,SAAU,iDACV,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,SAAU,iDACV,SAAU,iDACV,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEAGT,SACE,qEACF,SACE,qEACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEAGT,SACE,qEACF,SACE,qEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,uEACF,MACE,uEACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,oEACT,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEAGF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,MACE,sEACF,MACE,sEACF,MACE,sEACF,MACE,sEAGF,MACE,sEACF,MACE,sEACF,MACE,sEAGF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,MACE,sEACF,MACE,sEACF,MACE,sEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,MACE,sEACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MACE,uEACF,MACE,uEACF,MACE,uEACF,MACE,uEACF,MACE,uEAGF,MAAS,oEACT,MACE,sEACF,MAAS,oEACT,MACE,sEAGF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEAGT,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,SACE,qEACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,MACE,sEACF,MACE,sEACF,MACE,sEACF,MAAS,oEAGT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEAGT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,SACE,qEACF,SACE,qEACF,MAAS,oEACT,MAAS,oEACT,MAAS,oEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEACT,MAAS,qEAGT,MACE,sEACF,MACE,sEACF,MAAS,oEAGT,SACE,qEACF,SACE,q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tJ,SACbxF,MAAO8O,EAAQ9O,MACf9L,MAAO4a,EAAQ5a,MACf8uB,qBAAsB,EAAKiM,yBACzBngB,EAAQ/f,IAEVssB,kBAAmB,EAAKoX,yBACtB3jB,EAAQ/f,IAEV+qB,UAAW,EAAKoV,kBAAkBpgB,EAAQ/f,KAZ5C,UACU+f,EAAQ/f,GADlB,kBAgBJ,eAAC,KAAD,CAAOwvB,gBAAgB,EAAvB,UACGlX,EAAW/M,OAAOg+B,GAAah+B,OAAOk+B,GAEvC,cAAC,GAAD,CACErlB,gBAAiB,EAAKR,MAAMQ,kBAG7BylB,KAEH,cAAC,KAAD,UACE,cAAC,KAAD,CACEzlC,EAAG,EAAKjD,MAAM+hC,eAAe9+B,EAC7BC,EAAG,EAAKlD,MAAM+hC,eAAe7+B,EAC7B6gB,MAAO,EAAK/jB,MAAMylC,WAAW1hB,MAC7BC,OAAQ,EAAKhkB,MAAMylC,WAAWzhB,OAC9B6E,OAAO,SACPC,YAAa,qB,GAledhE,aC7LN8kB,GAAW,CACxB,WACA,qBACA,WACA,qBACA,WACA,qBACA,YACA,sBACA,YACA,sBACA,WACA,qBACA,WACA,qBACA,WACA,qBACA,qBACA,WACA,qBACA,WACA,qBACA,WACA,qBACA,YACA,sBACA,WACA,qBACA,qBACA,WACA,qBACA,YACA,sBACA,YACA,sBACA,uBACA,aACA,uBACA,qBACA,WACA,qBACA,YACA,sBACA,WACA,sBC5CaA,GAAW,CACxB,8BACA,wCACA,qCACA,4BACA,sCACA,wCACA,8BACA,uCACA,6BACA,yBACA,sCACA,4BACA,4BACA,yBACA,4CACA,sCACA,4BACA,mCACA,wBACA,yCACA,+BACA,gBACA,gCACA,+CACA,0CACA,gCACA,wCACA,iCACA,wCACA,8BACA,yBACA,6BACA,iBACA,mCACA,mCACA,2CACA,iCACA,oCACA,+BACA,sCACA,4BACA,2BACA,6BACA,8BACA,+BACA,8BACA,uCACA,0CACA,qCACA,4CACA,qBACA,sBACA,mCACA,+CACA,0CACA,mCACA,yBACA,yCACA,oCACA,0BACA,wBACA,mCACA,yBACA,6BACA,kCACA,wBACA,+BACA,wCACA,8BACA,wBACA,oCACA,0BACA,2CACA,iCACA,2CACA,+BACA,8BACA,wBACA,yBACA,qCACA,2BACA,sCACA,4BACA,0BACA,8BACA,4BACA,kCACA,wBACA,iCACA,uBACA,mCACA,yBACA,uCACA,6BACA,oCACA,kCACA,wBACA,+BACA,wCACA,8BACA,6BACA,mCACA,4BACA,8BACA,uBACA,wCACA,8BACA,mCACA,4CACA,qCACA,2BACA,oCACA,0BACA,0BACA,qCACA,+BACA,qBACA,sBACA,gCACA,0BACA,iCACA,uBACA,4BACA,sBACA,qCACA,2BACA,sBACA,4CACA,kCACA,wBACA,qCACA,wBACA,sCACA,6BACA,0BACA,iCACA,mCACA,iCACA,0CACA,oCACA,0BACA,0BACA,yCACA,+BACA,kCACA,wBACA,0CACA,gCACA,8BACA,8BACA,6BACA,uCACA,6BACA,0CACA,gCACA,mCACA,8BACA,0BACA,0BACA,0BACA,iCACA,8BACA,oCACA,0BACA,0CACA,+BACA,wCACA,gDACA,uBC5FMC,GAAqB,yCAAG,WAC5BC,GAD4B,gBAAAx5B,EAAA,sEAGLiE,KAAM9S,IACF,cAAgBqoC,GAJf,cAGtBp1B,EAHsB,yBAMrB,CACLq1B,IAAKr1B,EACLpO,SAAUwjC,EAAS1iC,MAAM,SAAS,KARR,2CAAH,sDAYrB4iC,GAAmB,yCAAG,WAC1BF,GAD0B,gBAAAx5B,EAAA,sEAGHiE,KAAM9S,IACF,cAAgBqoC,GAJjB,cAGpBp1B,EAHoB,yBAMnB,CACLq1B,IAAKr1B,EACLpO,SAAUwjC,EAAS1iC,MAAM,SAAS,KARV,2CAAH,sDAYnB6iC,GAAuB,yCAAG,WAC9B1gC,GAD8B,gBAAA+G,EAAA,sEAGPiE,KAAM9S,IACF,wBAA0B8H,EAAW,SAJlC,cAGxBmL,EAHwB,yBAMvBA,GANuB,2CAAH,sDC6Cdw1B,GApDOzoB,aAhBE,SAACzhB,GACvB,MAAO,CACLsC,aAAc0O,GAAgBhR,GAC9BuC,cAAe0O,GAAiBjR,GAChCiK,MAAOiI,GAASlS,GAChB8O,UAAWE,GAAqBhP,GACh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","file":"static/js/main.40b05b91.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 235;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://cra.link/PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://cra.link/PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import { v4 as uuidv4 } from \"uuid\";\n\nexport const myPeerRef = uuidv4();\n\nexport enum GameType {\n  MarvelChampions = \"marvelchampions\",\n  LordOfTheRingsLivingCardGame = \"lotrlcg\",\n}\n\nexport type PlayerColor =\n  | \"red\"\n  | \"cyan\"\n  | \"green\"\n  | \"blue\"\n  | \"magenta\"\n  | \"yellow\";\n\nexport const possibleColors: PlayerColor[] = [\n  \"red\",\n  \"cyan\",\n  \"green\",\n  \"blue\",\n  \"magenta\",\n  \"yellow\",\n];\n\nexport const playerHandHeightPx: number = 70;\n\nexport const playerHandElementId: string = \"card-table-player-hand-area\";\n","import { RootState } from \"./rootReducer\";\n\nexport const loadState = (key: string) => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    if (serializedState === null) {\n      return {};\n    }\n    const baseState = JSON.parse(serializedState || \"{}\");\n\n    return baseState.present ?? baseState;\n  } catch (err) {\n    console.error(\"problem parsing\");\n    return {};\n  }\n};\n\nexport const saveState = (state: RootState) => {\n  const blacklistStateKeys = [\"cardsData\"];\n  try {\n    Object.entries(state).forEach(([key, value]) => {\n      if (!blacklistStateKeys.includes(key)) {\n        const serializedState = JSON.stringify(value);\n        localStorage.setItem(key, serializedState);\n      }\n    });\n  } catch {\n    // ignore write errors\n    console.error(\"Error writing state to local storage\");\n  }\n};\n","import { GameType } from \"../../constants/app-constants\";\nimport { CardData } from \"../../external-api/common-card-data\";\nimport { loadState } from \"../../store/localStorage\";\nimport { IGameState } from \"../game/initialState\";\n\nexport interface ICardData {\n  [key: string]: CardData;\n}\n\nexport interface CardInSet {\n  code: string;\n  quantity: number;\n}\n\nexport interface Set {\n  name: string;\n  setTypeCode: string;\n  cardsInSet: CardInSet[];\n}\n\nexport interface ISetData {\n  [key: string]: Set;\n}\n\nexport interface ICardsDataState {\n  activeDataType: GameType;\n  data: { [key in GameType]?: IGameCardsDataState };\n}\nexport interface IGameCardsDataState {\n  entities: ICardData;\n  encounterEntities: ICardData;\n  setData: ISetData;\n}\n\nconst queryParams = new URLSearchParams(window.location.search);\nconst queryParamsGameType = queryParams.get(\"gameType\");\n\nconst localGameState: IGameState = loadState(\"game\");\n\nconst gameType = queryParamsGameType ?? localGameState.activeGameType;\n\nexport const initialState: ICardsDataState = {\n  activeDataType: (gameType as GameType) ?? GameType.MarvelChampions,\n  data: {},\n};\n","import { createAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"./rootReducer\";\n\nexport const resetApp = createAction(\"resetAction\");\n\nexport const receiveRemoteGameState = createAction<RootState>(\n  \"receiveRemoteGameState\"\n);\n\nexport const verifyRemoteGameState = createAction<RootState>(\n  \"verifyRemoteGameState\"\n);\n\nexport const startDraggingCardFromHand = createAction(\n  \"startDraggingCardFromHand\"\n);\n","import { Vector2d } from \"konva/lib/types\";\nimport {\n  GameType,\n  myPeerRef,\n  PlayerColor,\n} from \"../../constants/app-constants\";\nimport { loadState } from \"../../store/localStorage\";\n\nexport interface IPreviewCard {\n  id: string;\n}\n\nexport interface IGameState {\n  stageZoom: Vector2d;\n  stagePosition: Vector2d;\n  radialMenuPosition: Vector2d | null;\n  specificCardLoaderPosition: Vector2d | null;\n  playerColors: { [key: string]: PlayerColor };\n  playerNumbers: { [key: string]: number };\n  peerId: string;\n  previewCard: IPreviewCard | null;\n  menuPreviewCardJsonId: string | null;\n  activeGameType: GameType | null;\n  draggingCardFromHand: boolean;\n  drawCardsIntoHand: boolean;\n}\n\nconst queryParams = new URLSearchParams(window.location.search);\nconst queryParamsGameType = queryParams.get(\"gameType\");\n\nconst localStorageState: IGameState = !!queryParamsGameType\n  ? { activeGameType: queryParamsGameType }\n  : loadState(\"game\");\n\nlocalStorageState.playerColors = {};\nlocalStorageState.playerColors[myPeerRef] = \"red\";\nlocalStorageState.playerNumbers = {};\nlocalStorageState.playerNumbers[myPeerRef] = 1;\nlocalStorageState.peerId = \"\";\nlocalStorageState.previewCard = null;\nlocalStorageState.menuPreviewCardJsonId = null;\nlocalStorageState.radialMenuPosition = null;\nlocalStorageState.specificCardLoaderPosition = null;\nlocalStorageState.draggingCardFromHand = false;\n\nconst defaultState: IGameState = {\n  playerColors: {},\n  playerNumbers: {},\n  stageZoom: { x: 0.5, y: 0.5 },\n  stagePosition: { x: 0, y: 0 },\n  peerId: \"\",\n  previewCard: null,\n  menuPreviewCardJsonId: null,\n  activeGameType: null,\n  radialMenuPosition: null,\n  specificCardLoaderPosition: null,\n  draggingCardFromHand: false,\n  drawCardsIntoHand: true,\n};\nexport const initialState: IGameState = {\n  ...defaultState,\n  ...localStorageState,\n};\n","export const cardConstants = {\n  CARD_HEIGHT: 209,\n  CARD_WIDTH: 150,\n  CARD_PREVIEW_HEIGHT: 418,\n  CARD_PREVIEW_WIDTH: 300,\n  MOUSE_DRAG_SPLIT_DISTANCE: 50,\n  TOUCH_DRAG_SPLIT_DISTANCE: 100,\n};\n\nexport enum StatusTokenType {\n  Stunned = \"stunned\",\n  Confused = \"confused\",\n  Tough = \"tough\",\n}\n\nexport enum CounterTokenType {\n  Damage = \"damage\",\n  Threat = \"threat\",\n  Generic = \"generic\",\n}\n","import { CaseReducer, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { Vector2d } from \"konva/lib/types\";\nimport { GameType, PlayerColor } from \"../../constants/app-constants\";\nimport {\n  receiveRemoteGameState,\n  resetApp,\n  startDraggingCardFromHand,\n} from \"../../store/global.actions\";\nimport { IGameState, initialState } from \"./initialState\";\n\n// Reducers\nconst updateZoomReducer: CaseReducer<IGameState, PayloadAction<Vector2d>> = (\n  state,\n  action\n) => {\n  state.stageZoom = action.payload;\n  return state;\n};\n\nconst updatePositionReducer: CaseReducer<\n  IGameState,\n  PayloadAction<Vector2d>\n> = (state, action) => {\n  state.stagePosition = action.payload;\n  return state;\n};\n\nconst connectToRemoteGameReducer: CaseReducer<\n  IGameState,\n  PayloadAction<string>\n> = () => {};\n\nconst setPlayerInfoReducer: CaseReducer<\n  IGameState,\n  PayloadAction<{ ref: string; color: PlayerColor; playerNumber: number }>\n> = (state, action) => {\n  state.playerColors[action.payload.ref] = action.payload.color;\n  state.playerNumbers[action.payload.ref] = action.payload.playerNumber;\n};\n\nconst setPeerIdReducer: CaseReducer<IGameState, PayloadAction<string>> = (\n  state,\n  action\n) => {\n  state.peerId = action.payload;\n};\n\nconst setPreviewCardIdReducer: CaseReducer<\n  IGameState,\n  PayloadAction<string>\n> = (state, action) => {\n  if (!state.previewCard) {\n    state.previewCard = { id: action.payload };\n  } else if (state.previewCard.id !== action.payload) {\n    state.previewCard.id = action.payload;\n  }\n};\n\nconst clearPreviewCardReducer: CaseReducer<IGameState> = (state) => {\n  state.previewCard = null;\n};\n\nconst setMenuPreviewCardJsonIdReducer: CaseReducer<\n  IGameState,\n  PayloadAction<string>\n> = (state, action) => {\n  state.menuPreviewCardJsonId = action.payload;\n};\n\nconst clearMenuPreviewCardJsonIdReducer: CaseReducer<IGameState> = (state) => {\n  state.menuPreviewCardJsonId = null;\n};\n\nconst requestResyncReducer: CaseReducer<IGameState> = () => {};\n\nconst updateActiveGameTypeReducer: CaseReducer<\n  IGameState,\n  PayloadAction<GameType>\n> = (state, action) => {\n  state.activeGameType = action.payload;\n};\n\nconst quitGameReducer: CaseReducer<IGameState> = (state) => {\n  state.activeGameType = null;\n};\n\nconst showRadialMenuAtPositionReducer: CaseReducer<\n  IGameState,\n  PayloadAction<Vector2d>\n> = (state, action) => {\n  state.radialMenuPosition = action.payload;\n};\n\nconst hideRadialMenuReducer: CaseReducer<IGameState> = (state) => {\n  state.radialMenuPosition = null;\n};\n\nconst showSpecificCardLoaderReducer: CaseReducer<\n  IGameState,\n  PayloadAction<Vector2d>\n> = (state, action) => {\n  state.specificCardLoaderPosition = action.payload;\n};\n\nconst hideSpecificCardLoaderReducer: CaseReducer<IGameState> = (state) => {\n  state.specificCardLoaderPosition = null;\n};\n\nconst stopDraggingCardFromHandReducer: CaseReducer<IGameState> = (state) => {\n  state.draggingCardFromHand = false;\n};\n\nconst toggleDrawCardsIntoHandReducer: CaseReducer<IGameState> = (state) => {\n  state.drawCardsIntoHand = !state.drawCardsIntoHand;\n};\n\n// slice\nconst gameSlice = createSlice({\n  name: \"game\",\n  initialState: initialState,\n  reducers: {\n    updateZoom: updateZoomReducer,\n    updatePosition: updatePositionReducer,\n    connectToRemoteGame: connectToRemoteGameReducer,\n    setPlayerInfo: setPlayerInfoReducer,\n    setPeerId: setPeerIdReducer,\n    requestResync: requestResyncReducer,\n    setPreviewCardId: setPreviewCardIdReducer,\n    clearPreviewCard: clearPreviewCardReducer,\n    setMenuPreviewCardJsonId: setMenuPreviewCardJsonIdReducer,\n    clearMenuPreviewCardJsonId: clearMenuPreviewCardJsonIdReducer,\n    updateActiveGameType: updateActiveGameTypeReducer,\n    quitGame: quitGameReducer,\n    showRadialMenuAtPosition: showRadialMenuAtPositionReducer,\n    hideRadialMenu: hideRadialMenuReducer,\n    showSpecificCardLoader: showSpecificCardLoaderReducer,\n    hideSpecificCardLoader: hideSpecificCardLoaderReducer,\n    stopDraggingCardFromHand: stopDraggingCardFromHandReducer,\n    toggleDrawCardsIntoHand: toggleDrawCardsIntoHandReducer,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(receiveRemoteGameState, (state, action) => {\n      state.activeGameType = action.payload.game.activeGameType;\n    });\n    builder.addCase(resetApp, (state, _action) => {\n      state.stagePosition = { x: 0, y: 0 };\n      state.stageZoom = { x: 0.5, y: 0.5 };\n      state.previewCard = null;\n    });\n    builder.addCase(startDraggingCardFromHand, (state, _action) => {\n      state.draggingCardFromHand = true;\n    });\n  },\n});\n\nexport const {\n  updateZoom,\n  updatePosition,\n  connectToRemoteGame,\n  setPlayerInfo,\n  setPeerId,\n  requestResync,\n  setPreviewCardId,\n  clearPreviewCard,\n  setMenuPreviewCardJsonId,\n  clearMenuPreviewCardJsonId,\n  updateActiveGameType,\n  quitGame,\n  showRadialMenuAtPosition,\n  hideRadialMenu,\n  showSpecificCardLoader,\n  hideSpecificCardLoader,\n  stopDraggingCardFromHand,\n  toggleDrawCardsIntoHand,\n} = gameSlice.actions;\n\nexport default gameSlice.reducer;\n","import {\n  createSlice,\n  CaseReducer,\n  PayloadAction,\n  Draft,\n} from \"@reduxjs/toolkit\";\nimport {\n  initialState,\n  ICardsDataState,\n  IGameCardsDataState,\n} from \"./initialState\";\n\n// import * as PackData from \"../../generated/packs\";\n// import { CardData as CardDataLOTR } from \"../../external-api/beorn-json-data\";\nimport {\n  CardData as CardDataMarvel,\n  CardPack as CardPackMarvel,\n} from \"../../external-api/marvel-card-data\";\nimport SetData from \"../../external/marvelsdb-json-data/sets.json\";\nimport Scenarios from \"../../external/ringsteki-json-data/scenarios.json\";\nimport { CardData } from \"../../external-api/common-card-data\";\nimport { GameType } from \"../../constants/app-constants\";\nimport {\n  CardPack as CardPackLOTR,\n  CardData as CardDataLOTR,\n} from \"../../external-api/beorn-json-data\";\nimport { updateActiveGameType } from \"../game/game.slice\";\nimport { receiveRemoteGameState } from \"../../store/global.actions\";\n\n// Utilities\nconst convertMarvelToCommonFormat = (\n  cardMarvelFormat: CardDataMarvel\n): CardData => {\n  const mappedCardData: CardData = {\n    code: cardMarvelFormat.code,\n    name: cardMarvelFormat.name,\n    images: null,\n    octgnId: cardMarvelFormat.octgn_id ?? null,\n    quantity: cardMarvelFormat.quantity,\n    doubleSided: !!cardMarvelFormat.double_sided,\n    backLink: cardMarvelFormat.back_link ?? null,\n    typeCode: cardMarvelFormat.type_code,\n    subTypeCode: null,\n    extraInfo: {\n      setCode: cardMarvelFormat.set_code ?? null,\n      packCode: cardMarvelFormat.pack_code,\n      factionCode: cardMarvelFormat.faction_code,\n    },\n    duplicate_of: cardMarvelFormat.duplicate_of,\n  };\n  return mappedCardData;\n};\n\nconst convertLOTRToCommonFormat =\n  (encounterCard: boolean) =>\n  (cardLOTRFormat: CardDataLOTR): CardData => {\n    // if (!cardLOTRFormat.RingsDbCardId) {\n    //   console.log(\n    //     `No RingsDB Id for ${cardLOTRFormat.Slug} from ${cardLOTRFormat.CardSet}`\n    //   );\n    // }\n\n    // if (cardLOTRFormat.Front && !cardLOTRFormat.Front.ImagePath) {\n    //   console.log(\n    //     `No Front Image Path for ${cardLOTRFormat.Slug} from ${cardLOTRFormat.CardSet}`\n    //   );\n    // }\n\n    let cardBackImage = cardLOTRFormat.Back?.ImagePath;\n\n    if (cardLOTRFormat.Back && !cardLOTRFormat.Back.ImagePath) {\n      const frontImage = cardLOTRFormat.Front.ImagePath;\n      const frontImageWithoutExtension = frontImage\n        .split(\".\")\n        .slice(0, -1)\n        .join(\".\");\n      if (\n        frontImageWithoutExtension[frontImageWithoutExtension.length - 1] !==\n        \"A\"\n      ) {\n        console.log(\n          `No Non-B Back Image Path for ${cardLOTRFormat.Slug} from ${cardLOTRFormat.CardSet}`\n        );\n      } else {\n        cardBackImage = frontImage.replaceAll(\"A.\", \"B.\");\n      }\n    }\n\n    const mappedCardData: CardData = {\n      code: encounterCard ? cardLOTRFormat.Slug : cardLOTRFormat.RingsDbCardId,\n      name: cardLOTRFormat.Title,\n      images: {\n        front: cardLOTRFormat.Front.ImagePath,\n        back: cardBackImage ?? null,\n      },\n      octgnId: cardLOTRFormat.OctgnGuid ?? null,\n      quantity: cardLOTRFormat.Quantity ?? 1,\n      doubleSided: !!cardLOTRFormat.Back,\n      backLink: null,\n      typeCode: cardLOTRFormat.CardType,\n      subTypeCode: cardLOTRFormat.CardSubType,\n      extraInfo: {\n        setCode: cardLOTRFormat.CardSet ?? null,\n        packCode: \"TODO - lotr\",\n        factionCode: encounterCard ? \"encounter\" : \"player\",\n      },\n    };\n    return mappedCardData;\n  };\n\n// Reducers\nconst loadCardsDataReducer: CaseReducer<ICardsDataState> = (state) => {\n  //This reducer is only intended to be called a single time each load.\n  state.data = {};\n  // const heroPacks = Object.entries(PackData)\n  //   .filter(([key, _value]) => !key.includes(\"_encounter\"))\n  //   .map(([key, value]) => (value as unknown) as CardPackMarvel);\n\n  // const encounterPacks = Object.entries(PackData)\n  //   .filter(([key, value]) => key.includes(\"_encounter\"))\n  //   .map(([key, value]) => (value as unknown) as CardPackMarvel);\n\n  // heroPacks.forEach((pack) =>\n  //   pack.map(convertMarvelToCommonFormat).forEach((card: CardData) => {\n  //     if (state.entities[card.code]) {\n  //       console.error(\"Found multiple cards with code \" + card.code);\n  //     }\n\n  //     // if (!card.octgn_id) {\n  //     //   console.error(`Card ${card.code} had no octgn_id!`);\n  //     // }\n\n  //     state.entities[card.code] = card;\n  //   })\n  // );\n\n  // encounterPacks.forEach((pack) =>\n  //   pack.map(convertMarvelToCommonFormat).forEach((card: CardData) => {\n  //     if (state.encounterEntities[card.code]) {\n  //       console.error(\"Found multiple cards with code \" + card.code);\n  //     }\n\n  //     // if (!card.octgn_id) {\n  //     //   console.error(`Card ${card.code}: ${card.name} had no octgn_id!`);\n  //     // }\n\n  //     state.encounterEntities[card.code] = card;\n  //   })\n  // );\n\n  let activeData = state.data[GameType.MarvelChampions];\n  if (!!activeData) {\n    activeData.setData = {};\n  } else {\n    state.data[GameType.MarvelChampions] = {\n      entities: {},\n      encounterEntities: {},\n      setData: {},\n    };\n    activeData = state.data[GameType.MarvelChampions];\n  }\n\n  SetData.forEach((set) => {\n    if (!!activeData) {\n      activeData.setData[set.code] = {\n        name: set.name,\n        setTypeCode: set.card_set_type_code,\n        cardsInSet: [],\n      };\n    }\n  });\n\n  activeData = state.data[GameType.LordOfTheRingsLivingCardGame];\n\n  if (!!activeData) {\n    activeData.setData = {};\n  } else {\n    state.data[GameType.LordOfTheRingsLivingCardGame] = {\n      entities: {},\n      encounterEntities: {},\n      setData: {},\n    };\n    activeData = state.data[GameType.LordOfTheRingsLivingCardGame];\n  }\n\n  Scenarios.forEach((scenario) => {\n    if (!!activeData) {\n      activeData.setData[scenario.Slug] = {\n        name: scenario.Title,\n        setTypeCode: scenario.Cycle || scenario.Product,\n        cardsInSet: [],\n      };\n    }\n  });\n\n  return state;\n};\n\nconst storeCardData =\n  (isPlayerPack: boolean, careAboutDups: boolean) =>\n  (cs: {\n    location: Draft<IGameCardsDataState> | undefined;\n    card: CardData;\n  }) => {\n    const stateLocation = isPlayerPack\n      ? (cs.location as IGameCardsDataState).entities\n      : (cs.location as IGameCardsDataState).encounterEntities;\n\n    // if (!card.octgn_id) {\n    //   console.error(`Card ${card.code} had no octgn_id!`);\n    // }\n\n    if (!(cs.card.code[0] === \"0\" && cs.card.code[1] === \"0\")) {\n      if (stateLocation[cs.card.code]) {\n        if (careAboutDups) {\n          console.error(\n            \"Found multiple cards with code \" +\n              cs.card.code +\n              \" \" +\n              cs.card.name +\n              \" \" +\n              cs.card.extraInfo.setCode +\n              \" Existing card is \" +\n              stateLocation[cs.card.code].name +\n              \" \" +\n              stateLocation[cs.card.code].extraInfo.setCode\n          );\n        }\n      }\n      stateLocation[cs.card.code] = cs.card;\n    }\n  };\n\nconst loadCardsForEncounterSetReducer: CaseReducer<\n  ICardsDataState,\n  PayloadAction<{\n    setCode: string;\n    cards: CardDataLOTR[];\n  }>\n> = (state, action) => {\n  const activeData = state.data[GameType.LordOfTheRingsLivingCardGame];\n  const activeSet = activeData?.setData[action.payload.setCode];\n\n  if (!action.payload.cards.map) {\n    console.log(\"No cards found for scenario \" + action.payload.setCode);\n    return;\n  }\n\n  action.payload.cards\n    .map(convertLOTRToCommonFormat(true))\n    .map((c) => {\n      return {\n        location: state.data[GameType.LordOfTheRingsLivingCardGame],\n        card: c,\n      };\n    })\n    .forEach(storeCardData(false, false));\n\n  if (!!activeSet) {\n    activeSet.cardsInSet = activeSet.cardsInSet.concat(\n      action.payload.cards\n        .filter(\n          (cd) => cd.CardSet.toLocaleLowerCase().indexOf(\"nightmare\") === -1\n        )\n        .map((cd) => {\n          return {\n            code: cd.Slug,\n            quantity: cd.Quantity,\n          };\n        })\n    );\n  }\n\n  return state;\n};\n\nconst loadCardsDataForPackReducer: CaseReducer<\n  ICardsDataState,\n  PayloadAction<{\n    packType: GameType;\n    pack: CardPackMarvel | CardPackLOTR;\n    pack_code: string;\n  }>\n> = (state, action) => {\n  if (!state.data[action.payload.packType]) {\n    state.data[action.payload.packType] = {\n      entities: {},\n      encounterEntities: {},\n      setData: {},\n    };\n  }\n\n  if (action.payload.packType === GameType.MarvelChampions) {\n    //This reducer is only intended to be called a single time each load.\n    const isHeroPack = !action.payload.pack_code.includes(\"_encounter\");\n\n    const pack = action.payload.pack as CardPackMarvel;\n\n    pack\n      .map(convertMarvelToCommonFormat)\n      .map((c) => {\n        return { location: state.data[action.payload.packType], card: c };\n      })\n      .forEach(storeCardData(isHeroPack, true));\n  } else if (\n    action.payload.packType === GameType.LordOfTheRingsLivingCardGame\n  ) {\n    const pack = action.payload.pack as CardPackLOTR;\n    if (!pack.cards) {\n      console.log(pack);\n    }\n    pack.cards\n      .map(convertLOTRToCommonFormat(false))\n      .map((c) => {\n        return { location: state.data[action.payload.packType], card: c };\n      })\n      .forEach(storeCardData(true, true));\n  }\n\n  return state;\n};\n\n// slice\nconst cardsDataSlice = createSlice({\n  name: \"cardsData\",\n  initialState: initialState,\n  reducers: {\n    loadCardsData: loadCardsDataReducer,\n    loadCardsDataForPack: loadCardsDataForPackReducer,\n    loadCardsForEncounterSet: loadCardsForEncounterSetReducer,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(receiveRemoteGameState, (state, action) => {\n      state.activeDataType =\n        action.payload.game.activeGameType ?? GameType.MarvelChampions;\n    });\n    builder.addCase(updateActiveGameType, (state, action) => {\n      state.activeDataType = action.payload;\n    });\n  },\n});\n\nexport const { loadCardsData, loadCardsDataForPack, loadCardsForEncounterSet } =\n  cardsDataSlice.actions;\n\nexport default cardsDataSlice.reducer;\n","import { createAction } from \"@reduxjs/toolkit\";\nimport { Vector2d } from \"konva/lib/types\";\nimport { ICardDetails } from \"./initialState\";\n\nexport interface AddCardStackWithIdPayload {\n  cardJsonIds: string[];\n  position: Vector2d;\n  id: string;\n}\n\nexport interface PullCardOutOfCardStackWithIdPayload {\n  cardStackId: string;\n  jsonId: string;\n  pos: Vector2d;\n  id: string;\n}\n\nexport interface StartCardMoveWithSplitStackIdPayload {\n  id: string;\n  splitTopCard: boolean;\n  splitCardId: string;\n}\n\nexport interface DrawCardsOutOfCardStackWithIdsPayload {\n  cardStackId: string;\n  numberToDraw: number;\n  facedown?: boolean;\n  idsToUse: string[];\n  drawIntoHand: boolean;\n  playerNumber: number;\n}\n\nexport interface ReplaceCardStackPayload {\n  id: string;\n  newStack: ICardDetails[];\n}\n\nexport interface CreateDeckPayload {\n  position: Vector2d;\n  heroId: string;\n  data: any;\n  dataId: string;\n  extraHeroCards: ICardDetails[];\n  relatedEncounterDeck: string[];\n  encounterDeckId: string;\n  relatedObligationDeck: string[];\n  obligationDeckId: string;\n}\n\nexport const addCardStackWithId =\n  createAction<AddCardStackWithIdPayload>(\"addCardStackWithId\");\n\nexport const pullCardOutOfCardStackWithId =\n  createAction<PullCardOutOfCardStackWithIdPayload>(\n    \"pullCardOutOfCardStackWithId\"\n  );\n\nexport const drawCardsOutOfCardStackWithIds =\n  createAction<DrawCardsOutOfCardStackWithIdsPayload>(\n    \"drawCardsOutOfCardStackWithIds\"\n  );\n\nexport const startCardMoveWithSplitStackId =\n  createAction<StartCardMoveWithSplitStackIdPayload>(\n    \"startCardMoveWithSplitStackId\"\n  );\n\nexport const replaceCardStack =\n  createAction<ReplaceCardStackPayload>(\"replaceCardStack\");\n\nexport const setStackShuffling = createAction<{\n  id: string;\n  shuffling: boolean;\n}>(\"setStackShuffling\");\n\nexport const createDeckFromTextFileWithIds = createAction<CreateDeckPayload>(\n  \"createDeckFromTextFileWithIds\"\n);\n","import { Vector2d } from \"konva/lib/types\";\n\nexport const getDistance = (point1: Vector2d, point2: Vector2d): number => {\n  const deltaX = point1.x - point2.x;\n  const deltaY = point1.y - point2.y;\n  return Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n};\n\nexport const getCenter = (p1: Vector2d, p2: Vector2d) => {\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2,\n  };\n};\n","import { ICardDetails } from \"../features/cards/initialState\";\n\n// For some reason, the codes from marvelcdb and the images from cardgamedb can be off\nexport const CARD_PACK_REMAPPING: { [key: string]: string } = {\n  bkw: \"07\",\n  cap: \"04\",\n  drs: \"08\",\n  hlk: \"09\",\n  trors: \"10\",\n  twc: \"03\",\n};\n\n// export const EXTRA_CARDS: { [key: string]: { [key: string]: number } } = {\n//   doctor_strange: {\n//     \"09032\": 1,\n//     \"09033\": 1,\n//     \"09034\": 1,\n//     \"09035\": 1,\n//     \"09036\": 1,\n//   },\n//   ant: {\n//     \"12001c\": 1,\n//   },\n// };\n\nexport const EXTRA_CARDS: { [key: string]: ICardDetails[] } = {\n  doctor_strange: [\n    { jsonId: \"09032\" },\n    { jsonId: \"09033\" },\n    { jsonId: \"09034\" },\n    { jsonId: \"09035\" },\n    { jsonId: \"09036\" },\n  ],\n  ant: [{ jsonId: \"12001c\" }],\n  wsp: [{ jsonId: \"13001c\" }],\n};\n","import { GameType } from \"./app-constants\";\nimport * as React from \"react\";\nimport NewReleasesIcon from \"@material-ui/icons/NewReleases\";\nimport HelpIcon from \"@material-ui/icons/Help\";\nimport SecurityIcon from \"@material-ui/icons/Security\";\nimport { CounterTokenType, StatusTokenType } from \"../constants/card-constants\";\n\nexport interface GameProperties {\n  deckSite: string;\n  decklistApi: string;\n  encounterUiName: string;\n  backgroundImageLocation: string;\n  possibleIcons: IconInfo[];\n  modifiers: ModifierInfo[];\n  tokens: {\n    stunned: TokenInfo | null;\n    confused: TokenInfo | null;\n    tough: TokenInfo | null;\n    damage: NumericTokenInfo | null;\n    threat: NumericTokenInfo | null;\n    generic: NumericTokenInfo | null;\n  };\n}\n\nexport interface TokenInfoBase {\n  touchMenuLetter: string | null;\n  touchMenuIcon: JSX.Element | null;\n  menuText: string;\n  imagePath: string;\n}\nexport interface NumericTokenInfo extends TokenInfoBase {\n  isNumeric: boolean;\n  counterTokenType: CounterTokenType;\n}\n\nexport interface TokenInfo extends TokenInfoBase {\n  menuRemoveText: string;\n  tokenType: StatusTokenType;\n}\n\nexport interface ModifierInfo {\n  attributeId: string;\n  attributeName: string;\n  icon: string;\n  slot: number;\n}\n\nexport interface IconInfo {\n  iconId: string;\n  iconName: string;\n  iconImageUrl: string;\n}\n\nexport const GamePropertiesMap: { [key in GameType]: GameProperties } = {\n  marvelchampions: {\n    deckSite: \"marvelcdb.com\",\n    decklistApi: \"https://marvelcdb.com/api/public/decklist/\",\n    encounterUiName: \"Encounter Set\",\n    backgroundImageLocation:\n      process.env.PUBLIC_URL + \"/images/table/background_marvelchampions.png\",\n    possibleIcons: [],\n    modifiers: [\n      {\n        attributeId: \"thwart\",\n        attributeName: \"Thwart\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/marvel/thwart.png\",\n        slot: 1,\n      },\n      {\n        attributeId: \"attack\",\n        attributeName: \"Attack\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/marvel/attack.png\",\n        slot: 2,\n      },\n      {\n        attributeId: \"defense\",\n        attributeName: \"Defense\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/marvel/defense.png\",\n        slot: 3,\n      },\n    ],\n    tokens: {\n      stunned: {\n        tokenType: StatusTokenType.Stunned,\n        touchMenuLetter: null,\n        touchMenuIcon: <NewReleasesIcon fontSize=\"large\"></NewReleasesIcon>,\n        menuText: \"Stun\",\n        menuRemoveText: \"Remove Stun\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/stunned.png\",\n      },\n      confused: {\n        tokenType: StatusTokenType.Confused,\n        touchMenuLetter: null,\n        touchMenuIcon: <HelpIcon fontSize=\"large\"></HelpIcon>,\n        menuText: \"Confuse\",\n        menuRemoveText: \"Remove Confuse\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/confused.png\",\n      },\n      tough: {\n        tokenType: StatusTokenType.Tough,\n        touchMenuLetter: null,\n        touchMenuIcon: <SecurityIcon fontSize=\"large\"></SecurityIcon>,\n        menuText: \"Tough\",\n        menuRemoveText: \"Remove Tough\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/tough.png\",\n      },\n      damage: {\n        counterTokenType: CounterTokenType.Damage,\n        isNumeric: true,\n        touchMenuLetter: \"Dmg\",\n        touchMenuIcon: null,\n        menuText: \"Set Damage\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/damage.png\",\n      },\n      threat: {\n        counterTokenType: CounterTokenType.Threat,\n        isNumeric: true,\n        touchMenuLetter: \"Thr\",\n        touchMenuIcon: null,\n        menuText: \"Set Threat\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/threat.png\",\n      },\n      generic: {\n        counterTokenType: CounterTokenType.Generic,\n        isNumeric: true,\n        touchMenuLetter: \"Gen\",\n        touchMenuIcon: null,\n        menuText: \"Set Generic Tokens\",\n        imagePath:\n          process.env.PUBLIC_URL + \"/images/standard/generic_counter.png\",\n      },\n    },\n  },\n  lotrlcg: {\n    deckSite: \"ringsdb.com\",\n    decklistApi: \"https://ringsdb.com/api/public/decklist/\",\n    encounterUiName: \"Scenario\",\n    backgroundImageLocation:\n      process.env.PUBLIC_URL + \"/images/table/background_lotrlcg.jpg\",\n    possibleIcons: [\n      {\n        iconId: \"tactics\",\n        iconName: \"Tactics\",\n        iconImageUrl:\n          process.env.PUBLIC_URL + \"/images/standard/lotr/tactics.png\",\n      },\n      {\n        iconId: \"leadership\",\n        iconName: \"Leadership\",\n        iconImageUrl:\n          process.env.PUBLIC_URL + \"/images/standard/lotr/leadership.png\",\n      },\n      {\n        iconId: \"spirit\",\n        iconName: \"Spirit\",\n        iconImageUrl:\n          process.env.PUBLIC_URL + \"/images/standard/lotr/spirit.png\",\n      },\n      {\n        iconId: \"lore\",\n        iconName: \"Lore\",\n        iconImageUrl: process.env.PUBLIC_URL + \"/images/standard/lotr/lore.png\",\n      },\n    ],\n    modifiers: [\n      {\n        attributeId: \"threat\",\n        attributeName: \"Threat\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/lotr/threat.png\",\n        slot: 1,\n      },\n      {\n        attributeId: \"willpower\",\n        attributeName: \"Willpower\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/lotr/willpower.png\",\n        slot: 2,\n      },\n      {\n        attributeId: \"attack\",\n        attributeName: \"Attack\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/lotr/attack.png\",\n        slot: 3,\n      },\n      {\n        attributeId: \"defense\",\n        attributeName: \"Defense\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/lotr/defense.png\",\n        slot: 4,\n      },\n      {\n        attributeId: \"hitpoints\",\n        attributeName: \"Hit Points\",\n        icon: process.env.PUBLIC_URL + \"/images/standard/lotr/hitpoints.png\",\n        slot: 5,\n      },\n    ],\n    tokens: {\n      stunned: {\n        tokenType: StatusTokenType.Stunned,\n        touchMenuLetter: \"Q\",\n        touchMenuIcon: null,\n        menuText: \"Quest\",\n        menuRemoveText: \"Remove From Quest\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/quest.png\",\n      },\n      confused: null,\n      tough: null,\n      damage: {\n        counterTokenType: CounterTokenType.Damage,\n        isNumeric: true,\n        touchMenuLetter: \"Dmg\",\n        touchMenuIcon: null,\n        menuText: \"Set Damage\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/damage_lotr.png\",\n      },\n      threat: {\n        counterTokenType: CounterTokenType.Threat,\n        isNumeric: true,\n        touchMenuLetter: \"Prg\",\n        touchMenuIcon: null,\n        menuText: \"Set Progress\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/progress.png\",\n      },\n      generic: {\n        counterTokenType: CounterTokenType.Generic,\n        isNumeric: true,\n        touchMenuLetter: \"Res\",\n        touchMenuIcon: null,\n        menuText: \"Set Resource Tokens\",\n        imagePath: process.env.PUBLIC_URL + \"/images/standard/resource.png\",\n      },\n    },\n  },\n};\n","import { createSelector } from \"@reduxjs/toolkit\";\nimport { CardData } from \"../../external-api/common-card-data\";\nimport { RootState } from \"../../store/rootReducer\";\nimport { ICardsDataState, Set } from \"../cards-data/initialState\";\n\nexport interface IEncounterEntity {\n  setCode: string;\n  setData: Set;\n  cards: CardData[];\n}\n\nconst getCurrentCardData = (cardsData: ICardsDataState) => {\n  return (\n    cardsData.data[cardsData.activeDataType] ?? {\n      entities: {},\n      encounterEntities: {},\n      setData: {},\n    }\n  );\n};\n\nexport const getCardsData = (state: RootState) => state.cardsData;\n\nexport const getCardsDataEntities = createSelector(\n  getCardsData,\n  (cardsData) => {\n    const data = getCurrentCardData(cardsData);\n    return { ...data.entities, ...data.encounterEntities };\n  }\n);\n\nexport const getCardsDataHeroEntities = createSelector(\n  getCardsData,\n  (cardsData) => {\n    const data = getCurrentCardData(cardsData);\n    return data.entities;\n  }\n);\n\nexport const getCardsDataHeroEntitiesArrayWithoutDuplicates = createSelector(\n  getCardsDataHeroEntities,\n  (cardsData) => {\n    return Object.values(cardsData).filter((c) => !c.duplicate_of);\n  }\n);\n\nexport const getCardsDataHerosByName = createSelector(\n  getCardsData,\n  (cardsData) => {\n    const data = getCurrentCardData(cardsData);\n    let cardsDataByName: { [key: string]: CardData } = {};\n    Object.values(data.entities).forEach((cd) => {\n      if (cd.typeCode === \"hero\") {\n        cardsDataByName[cd.name] = cd;\n      }\n    });\n    return cardsDataByName;\n  }\n);\n\nexport const getCardsDataPlayerCardsByName = createSelector(\n  getCardsData,\n  (cardsData) => {\n    const data = getCurrentCardData(cardsData);\n    let cardsDataByName: { [key: string]: CardData } = {};\n    Object.values(data.entities).forEach((cd) => {\n      if (cd.typeCode !== \"hero\") {\n        cardsDataByName[cd.name] = cd;\n      }\n    });\n    return cardsDataByName;\n  }\n);\n\nexport const getCardsDataEncounterEntities = createSelector(\n  getCardsData,\n  (cardsData) => {\n    const data = getCurrentCardData(cardsData);\n    return data.encounterEntities;\n  }\n);\n\nexport const getCardsDataSetData = createSelector(getCardsData, (cardsData) => {\n  const data = getCurrentCardData(cardsData);\n  return data.setData;\n});\n\nexport const getCardsDataSetDataAsEncounterEntities = createSelector(\n  getCardsDataSetData,\n  getCardsDataEncounterEntities,\n  (setData, encounterEntities) => {\n    const setDataToReturn = Object.entries(setData).map(([key, value]) => {\n      const encounterEntity: IEncounterEntity = {\n        setCode: key,\n        setData: value,\n        cards: value.cardsInSet.map((cis) => encounterEntities[cis.code]),\n      };\n\n      return encounterEntity;\n    });\n\n    // Go through and get the original index of every \"type\" of set\n    const originalOrder = setDataToReturn.reduce((orderMap, entity, index) => {\n      if (!orderMap[entity.setData.setTypeCode]) {\n        orderMap[entity.setData.setTypeCode] = index;\n      }\n\n      return orderMap;\n    }, {} as { [key: string]: number });\n\n    return setDataToReturn.sort(\n      (a, b) =>\n        originalOrder[a.setData.setTypeCode] -\n        originalOrder[b.setData.setTypeCode]\n    );\n  }\n);\n\nexport const getCardsDataEncounterEntitiesBySetCode = createSelector(\n  getCardsDataEncounterEntities,\n  getCardsDataHeroEntities,\n  getCardsDataSetData,\n  (encounterEntities, herosData, setData): IEncounterEntity[] => {\n    const setTypesEncounters: { [key: string]: CardData[] } = {};\n\n    const campaignCards = Object.values(herosData)\n      .filter((pc) => pc.extraInfo.factionCode === \"campaign\")\n      .sort((a, b) => (a.code < b.code ? -1 : a.code > b.code ? 1 : 0));\n\n    Object.values(encounterEntities)\n      .sort((a, b) => (a.code < b.code ? -1 : a.code > b.code ? 1 : 0))\n      .concat(campaignCards)\n      .forEach((encounterCard) => {\n        const setCode = encounterCard.extraInfo.setCode || \"unknown\";\n        if (!!setTypesEncounters[setCode]) {\n          setTypesEncounters[setCode].push(encounterCard);\n        } else {\n          setTypesEncounters[setCode] = [encounterCard];\n        }\n      });\n\n    const setDataToReturn = Object.entries(setTypesEncounters)\n      .map(([key, value]) => ({\n        setCode: key,\n        setData: setData[key],\n        cards: value,\n      }))\n      .filter(\n        (set) =>\n          set.setData.setTypeCode !== \"nemesis\" &&\n          set.setData.setTypeCode !== \"hero\"\n      );\n\n    // Go through and get the original index of every \"type\" of set\n    const originalOrder = setDataToReturn.reduce((orderMap, entity, index) => {\n      if (orderMap[entity.setData.setTypeCode] === undefined) {\n        orderMap[entity.setData.setTypeCode] = index;\n      }\n\n      return orderMap;\n    }, {} as { [key: string]: number });\n\n    console.log(originalOrder);\n\n    return setDataToReturn.sort(\n      (a, b) =>\n        originalOrder[a.setData.setTypeCode] -\n        originalOrder[b.setData.setTypeCode]\n    );\n  }\n);\n","import { createSelector } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../../store/rootReducer\";\nimport { ICardStack } from \"../cards/initialState\";\n\nexport const getGame = (state: RootState) => state.game;\n\nexport const getCurrentZoom = createSelector(getGame, (game) => {\n  return game.stageZoom;\n});\n\nexport const getPlayerColors = createSelector(getGame, (game) => {\n  return game.playerColors;\n});\n\nexport const getPlayerNumbers = createSelector(getGame, (game) => {\n  return game.playerNumbers;\n});\n\nexport const getPeerId = createSelector(getGame, (game) => game.peerId);\n\nexport const getActiveGameType = createSelector(\n  getGame,\n  (game) => game.activeGameType\n);\n\nexport const getRadialMenuPosition = createSelector(\n  getGame,\n  (game) => game.radialMenuPosition\n);\n\nexport const getSpecificCardLoaderPosition = createSelector(\n  getGame,\n  (game) => game.specificCardLoaderPosition\n);\n\nexport const getPreviewCard = createSelector(\n  getGame,\n  (game) => game.previewCard\n);\n\nexport const getMenuPreviewCard = createSelector(getGame, (game) => {\n  if (!game.menuPreviewCardJsonId) return null;\n\n  const menuPreviewCard: ICardStack = {\n    id: \"menu-preview-card\",\n    controlledBy: \"\",\n    exhausted: false,\n    faceup: true,\n    fill: \"gray\",\n    x: 0,\n    y: 0,\n    statusTokens: {\n      stunned: false,\n      confused: false,\n      tough: false,\n    },\n    counterTokens: {\n      damage: 0,\n      threat: 0,\n      generic: 0,\n    },\n    selected: false,\n    dragging: false,\n    shuffling: false,\n    cardStack: [{ jsonId: game.menuPreviewCardJsonId }],\n    modifiers: {},\n    extraIcons: [],\n  };\n\n  return menuPreviewCard;\n});\n","import { createSelector } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../../store/rootReducer\";\nimport { ICardStack } from \"./initialState\";\n\nexport const getCards = (state: RootState) => state.liveState.present.cards;\nexport const getPlayerHands = (state: RootState) =>\n  state.liveState.present.cards.playerHands;\n\nexport const getCardMapById = createSelector(getCards, (cards) => {\n  return cards.cards.reduce((map: { [k: string]: ICardStack }, card) => {\n    map[card.id] = card;\n    return map;\n  }, {});\n});\n\nexport const cardsSelectedWithPeerRef = (peerRef: string) =>\n  createSelector(getCards, (cards) => {\n    return cards.cards.filter((c) => c.selected && c.controlledBy === peerRef);\n  });\n\nexport const anyCardsSelectedWithPeerRef = (peerRef: string) =>\n  createSelector(getCards, (cards) => {\n    return cards.cards.some((c) => c.selected && c.controlledBy === peerRef);\n  });\n\nexport const getPanMode = (state: RootState) =>\n  state.liveState.present.cards.panMode;\n\nexport const getMultiselectMode = (state: RootState) =>\n  state.liveState.present.cards.multiselectMode;\n\nexport const getDropTargetCardsById = createSelector(getCards, (cards) => {\n  const returnVal: {\n    [key: string]: { ownerRef: string; card: ICardStack | null };\n  } = {};\n  Object.entries(cards.dropTargetCards).forEach(([key, value]) => {\n    if (!!value) {\n      returnVal[value.id] = { ownerRef: key, card: value };\n    }\n  });\n\n  return returnVal;\n});\n\nexport const getPlayerCardsForPlayerNumber = (num: number) =>\n  createSelector(getPlayerHands, (playerHands) => {\n    const index = num - 1;\n    return index >= 0 && index < playerHands.length ? playerHands[index] : null;\n  });\n","import { Action, createAsyncThunk, ThunkAction } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { Vector2d } from \"konva/lib/types\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { GameType, myPeerRef } from \"../../constants/app-constants\";\nimport { EXTRA_CARDS } from \"../../constants/card-pack-mapping\";\nimport { GamePropertiesMap } from \"../../constants/game-type-properties-mapping\";\nimport { RootState } from \"../../store/rootReducer\";\nimport { convertMarvelTxtToDeckInfo } from \"../../utilities/marvel-txt-converter\";\nimport {\n  getCardsDataEncounterEntities,\n  getCardsDataHeroEntities,\n  getCardsDataHerosByName,\n  getCardsDataPlayerCardsByName,\n} from \"../cards-data/cards-data.selectors\";\nimport { ICardData } from \"../cards-data/initialState\";\nimport { getGame } from \"../game/game.selectors\";\nimport {\n  addCardStackWithId,\n  createDeckFromTextFileWithIds,\n  drawCardsOutOfCardStackWithIds,\n  pullCardOutOfCardStackWithId,\n  replaceCardStack,\n  setStackShuffling,\n  startCardMoveWithSplitStackId,\n} from \"./cards.actions\";\nimport { getCards } from \"./cards.selectors\";\nimport { ICardDetails, ICardStack } from \"./initialState\";\n\ninterface DeckData {\n  investigator_code: string;\n  slots: { [key: string]: number };\n}\n\ninterface AddCardStackPayload {\n  cardJsonIds: string[];\n  position: Vector2d;\n}\n\nexport interface PullCardOutOfCardStackPayload {\n  cardStackId: string;\n  jsonId: string;\n  pos: Vector2d;\n}\n\nexport interface StartCardMovePayload {\n  id: string;\n  splitTopCard: boolean;\n}\n\nexport interface DrawCardsOutOfCardStackPayload {\n  cardStackId: string;\n  numberToDraw: number;\n  facedown?: boolean;\n}\n\nexport const shuffleStack =\n  (id?: string): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch, getState) => {\n    const cardsState = getCards(getState());\n    const stacksToShuffle = !!id\n      ? [cardsState.cards.find((c) => c.id === id)]\n      : cardsState.cards.filter(\n          (c) => c.selected && c.controlledBy === myPeerRef\n        );\n\n    stacksToShuffle\n      .filter((s): s is ICardStack => !!s && s.cardStack.length > 1)\n      .forEach((stackToShuffle) => {\n        dispatch(setStackShuffling({ id: stackToShuffle.id, shuffling: true }));\n        const shuffledStack = shuffle(stackToShuffle.cardStack);\n        dispatch(\n          replaceCardStack({ id: stackToShuffle.id, newStack: shuffledStack })\n        );\n\n        // We have to do a setTimeout here, because if we do it in this event loop,\n        // the overall change for this card is nothing for the shuffling param\n        setTimeout(() => {\n          dispatch(\n            setStackShuffling({ id: stackToShuffle.id, shuffling: false })\n          );\n        });\n      });\n  };\n\nexport const addCardStack =\n  (\n    payload: AddCardStackPayload\n  ): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch) => {\n    const payloadWithId = {\n      ...payload,\n      id: uuidv4(),\n    };\n    dispatch(addCardStackWithId(payloadWithId));\n  };\n\nexport const pullCardOutOfCardStack =\n  (\n    payload: PullCardOutOfCardStackPayload\n  ): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch) => {\n    const payloadWithId = {\n      ...payload,\n      id: uuidv4(),\n    };\n    dispatch(pullCardOutOfCardStackWithId(payloadWithId));\n  };\n\nexport const startCardMove =\n  (\n    payload: StartCardMovePayload\n  ): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch) => {\n    const payloadWithId = {\n      ...payload,\n      splitCardId: uuidv4(),\n    };\n    dispatch(startCardMoveWithSplitStackId(payloadWithId));\n  };\n\nexport const drawCardsOutOfCardStack =\n  (\n    payload: DrawCardsOutOfCardStackPayload\n  ): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch, getState) => {\n    const myPlayerNumber = getGame(getState()).playerNumbers[myPeerRef];\n    const drawCardsIntoHand = getGame(getState()).drawCardsIntoHand;\n    const possibleIds = Array.from({ length: payload.numberToDraw }).map((_i) =>\n      uuidv4()\n    );\n    const payloadWithIds = {\n      ...payload,\n      idsToUse: possibleIds,\n      drawIntoHand: drawCardsIntoHand,\n      playerNumber: myPlayerNumber,\n    };\n    dispatch(drawCardsOutOfCardStackWithIds(payloadWithIds));\n  };\n\nexport const createDeckFromTxt =\n  (payload: {\n    gameType: GameType;\n    position: Vector2d;\n    txtContents: string;\n  }): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch, getState) => {\n    if (payload.gameType === GameType.MarvelChampions) {\n      const heroCardsDataByName = getCardsDataHerosByName(getState());\n      const playerCardsDataByName = getCardsDataPlayerCardsByName(getState());\n      dispatch(\n        createDeckFromTextFileWithIds(\n          getMarvelCards(\n            convertMarvelTxtToDeckInfo(\n              heroCardsDataByName,\n              playerCardsDataByName,\n              payload.position,\n              payload.txtContents\n            ),\n            getState(),\n            {\n              gameType: payload.gameType,\n              decklistId: -1,\n              position: payload.position,\n            }\n          )\n        )\n      );\n    }\n  };\n\nexport const createDeckFromJson =\n  (payload: {\n    gameType: GameType;\n    position: Vector2d;\n    jsonContents: string;\n  }): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch, getState) => {\n    if (payload.gameType === GameType.MarvelChampions) {\n      // const heroCardsDataByName = getCardsDataHerosByName(getState());\n      // const playerCardsDataByName = getCardsDataPlayerCardsByName(getState());\n      dispatch(\n        createDeckFromTextFileWithIds(\n          getMarvelCards(JSON.parse(payload.jsonContents), getState(), {\n            gameType: payload.gameType,\n            decklistId: -1,\n            position: payload.position,\n          })\n        )\n      );\n    }\n  };\n\nexport const fetchDecklistById = createAsyncThunk(\n  \"decklist/fetchByIdStatus\",\n  async (\n    payload: { gameType: GameType; decklistId: number; position: Vector2d },\n    thunkApi\n  ) => {\n    const response = await axios.get(\n      `${GamePropertiesMap[payload.gameType].decklistApi}${payload.decklistId}`\n    );\n    const state: RootState = thunkApi.getState() as RootState;\n\n    switch (payload.gameType) {\n      case GameType.MarvelChampions:\n        return getMarvelCards(response, state, payload);\n      case GameType.LordOfTheRingsLivingCardGame:\n        return getLOTRCards(response, state, payload);\n    }\n  }\n);\n\nconst getMarvelCards = (\n  response: { data: DeckData },\n  state: RootState,\n  payload: { gameType: GameType; decklistId: number; position: Vector2d }\n) => {\n  const heroCardsData = getCardsDataHeroEntities(state);\n  const heroSet = heroCardsData[response.data.investigator_code];\n  const heroSetCode = heroSet.extraInfo.setCode;\n  const encounterCardsData = getCardsDataEncounterEntities(state);\n\n  let heroObligationDeck: string[] = [];\n  Object.entries(encounterCardsData)\n    .filter(\n      ([_key, value]) =>\n        (value.extraInfo.setCode === `${heroSetCode}` ||\n          value.extraInfo.setCode === `${heroSetCode}_nemesis` ||\n          value.extraInfo.setCode ===\n            `${heroSetCode?.replace(\"_hero\", \"\")}_nemesis`) &&\n        value.typeCode === \"obligation\"\n    )\n    .forEach(([key, value]) => {\n      heroObligationDeck = heroObligationDeck.concat(\n        Array.from({ length: value.quantity }).map((_i) => key)\n      );\n    });\n\n  // get the encounter cards for this deck\n  const heroEncounterDeckData = Object.values(encounterCardsData).filter(\n    (value) =>\n      (value.extraInfo.setCode === `${heroSetCode}_nemesis` ||\n        value.extraInfo.setCode ===\n          `${heroSetCode?.replace(\"_hero\", \"\")}_nemesis`) &&\n      value.typeCode !== \"obligation\"\n  );\n\n  let heroEncounterDeck: string[] = [];\n  heroEncounterDeckData.forEach((cd) => {\n    heroEncounterDeck = heroEncounterDeck.concat(\n      Array.from({ length: cd.quantity }).map((_i) => cd.code)\n    );\n  });\n\n  // check to see if there are any special extra cards for this hero\n  const extraCards = EXTRA_CARDS[heroSetCode ?? \"\"] ?? [];\n\n  // response.data.slots = { ...extraCards, ...response.data.slots };\n\n  return {\n    position: payload.position,\n    heroId: uuidv4(),\n    data: replaceDuplicateCards(response.data, heroCardsData),\n    dataId: uuidv4(),\n    extraHeroCards: extraCards,\n    relatedEncounterDeck: heroEncounterDeck,\n    encounterDeckId: uuidv4(),\n    relatedObligationDeck: heroObligationDeck,\n    obligationDeckId: uuidv4(),\n  };\n};\n\nconst replaceDuplicateCards = (\n  data: DeckData,\n  heroData: ICardData\n): DeckData => {\n  const newSlots: { [key: string]: number } = {};\n  Object.keys(data.slots).forEach((jsonId) => {\n    const cardData = heroData[jsonId];\n    if (cardData && cardData.duplicate_of) {\n      newSlots[cardData.duplicate_of] = data.slots[jsonId];\n    } else {\n      newSlots[jsonId] = data.slots[jsonId];\n    }\n  });\n  return {\n    investigator_code: data.investigator_code,\n    slots: newSlots,\n  };\n};\n\nconst getLOTRCards = (\n  response: any,\n  state: RootState,\n  payload: { gameType: GameType; decklistId: number; position: Vector2d }\n) => {\n  const heroCardsData = getCardsDataHeroEntities(state);\n\n  let heroStack: ICardDetails[] = [];\n\n  Object.entries(response.data.heroes).forEach(([key, value]) => {\n    const cardDetails: ICardDetails[] = Array.from(Array(value).keys()).map(\n      (): ICardDetails => ({ jsonId: key })\n    );\n    heroStack = heroStack.concat(cardDetails);\n  });\n\n  const newSlots: { [key: string]: number } = {};\n\n  Object.entries(response.data.slots).forEach(([key, value]) => {\n    //get the card data to make sure it's not a hero\n    const cardData = heroCardsData[key];\n    if (!cardData) {\n      throw new Error(`Couldn't find card data for ${key}`);\n    }\n\n    if (cardData.typeCode !== \"Hero\") {\n      newSlots[key] = value as number;\n    }\n  });\n\n  response.data.slots = newSlots;\n\n  return {\n    position: payload.position,\n    heroId: uuidv4(),\n    data: response.data,\n    dataId: uuidv4(),\n    extraHeroCards: heroStack,\n    relatedEncounterDeck: [],\n    encounterDeckId: uuidv4(),\n    relatedObligationDeck: [],\n    obligationDeckId: uuidv4(),\n  };\n};\n\nconst shuffle = (array: ICardDetails[]): ICardDetails[] => {\n  const returnArray = JSON.parse(JSON.stringify(array));\n  var currentIndex = returnArray.length,\n    temporaryValue,\n    randomIndex;\n\n  // While there remain elements to shuffle...\n  while (0 !== currentIndex) {\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex -= 1;\n\n    // And swap it with the current element.\n    temporaryValue = returnArray[currentIndex];\n    returnArray[currentIndex] = returnArray[randomIndex];\n    returnArray[randomIndex] = temporaryValue;\n  }\n\n  return returnArray;\n};\n","import { loadState } from \"../../store/localStorage\";\nimport {\n  CounterTokenType,\n  StatusTokenType,\n} from \"../../constants/card-constants\";\nimport JSONCrush from \"jsoncrush\";\n\nexport interface IPlayerHand {\n  cards: ICardDetails[];\n}\n\nexport interface ICardStack {\n  controlledBy: string;\n  dragging: boolean;\n  shuffling: boolean;\n  exhausted: boolean;\n  faceup: boolean;\n  fill: string;\n  id: string;\n  selected: boolean;\n  x: number;\n  y: number;\n  cardStack: ICardDetails[];\n  statusTokens: {\n    [K in StatusTokenType]: boolean;\n  };\n  counterTokens: {\n    [K in CounterTokenType]: number;\n  };\n  modifiers: {\n    [K: string]: number;\n  };\n  extraIcons: string[];\n}\n\nexport interface ICardDetails {\n  jsonId: string;\n}\n\nexport interface ICardsState {\n  outOfSyncWithRemote: boolean;\n  cards: ICardStack[];\n  ghostCards: ICardStack[];\n  playerHands: IPlayerHand[];\n  dropTargetCards: { [key: string]: ICardStack | null };\n  attachTargetCards: { [key: string]: ICardStack | null };\n  panMode: boolean;\n  multiselectMode: boolean;\n}\n\nconst MAX_PLAYERS = 4;\n\nexport const generateDefaultPlayerHands = (): IPlayerHand[] =>\n  Array(MAX_PLAYERS).fill({ cards: [] });\n\nconst queryParams = new URLSearchParams(window.location.search);\nconst queryParamsCardsString = queryParams.get(\"cards\");\nconst queryParamsCards = !!queryParamsCardsString\n  ? { cards: JSON.parse(JSONCrush.uncrush(queryParamsCardsString)) }\n  : null;\n\nconst localStorageState: ICardsState =\n  queryParamsCards || (loadState(\"liveState\")?.cards ?? {});\n\n// Make sure initially, none of the cards are \"owned\" / \"selected\" / \"shuffling\"\nif (!!localStorageState.cards) {\n  localStorageState.cards.forEach((c) => {\n    c.controlledBy = \"\";\n    c.selected = false;\n    c.shuffling = false;\n\n    // handle missing modifiers\n    if (!c.modifiers) {\n      c.modifiers = {};\n    }\n\n    // handle missing possibleIcons\n    if (!c.extraIcons) {\n      c.extraIcons = [];\n    }\n  });\n}\n\nlocalStorageState.attachTargetCards = {};\nlocalStorageState.dropTargetCards = {};\nlocalStorageState.ghostCards = [];\nlocalStorageState.outOfSyncWithRemote = false;\n\nconst defaultState: ICardsState = {\n  outOfSyncWithRemote: false,\n  cards: [],\n  ghostCards: [],\n  dropTargetCards: {},\n  attachTargetCards: {},\n  panMode: true,\n  multiselectMode: false,\n  playerHands: generateDefaultPlayerHands(),\n};\n\nexport const initialState: ICardsState = {\n  ...defaultState,\n  ...localStorageState,\n};\n","import isEqual from \"lodash.isequal\";\nimport {\n  CaseReducer,\n  createSlice,\n  Draft,\n  original,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { Vector2d } from \"konva/lib/types\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport {\n  cardConstants,\n  CounterTokenType,\n  StatusTokenType,\n} from \"../../constants/card-constants\";\nimport {\n  receiveRemoteGameState,\n  resetApp,\n  startDraggingCardFromHand,\n  verifyRemoteGameState,\n} from \"../../store/global.actions\";\nimport { getDistance } from \"../../utilities/geo\";\nimport {\n  addCardStackWithId,\n  createDeckFromTextFileWithIds,\n  CreateDeckPayload,\n  drawCardsOutOfCardStackWithIds,\n  pullCardOutOfCardStackWithId,\n  replaceCardStack,\n  setStackShuffling,\n  startCardMoveWithSplitStackId,\n} from \"./cards.actions\";\nimport { fetchDecklistById } from \"./cards.thunks\";\nimport {\n  generateDefaultPlayerHands,\n  ICardDetails,\n  ICardsState,\n  ICardStack,\n  initialState,\n} from \"./initialState\";\n\nconst CARD_DROP_TARGET_DISTANCE = 30;\nconst CARD_ATTACH_TARGET_MIN_DISTANCE = 50;\nconst CARD_ATTACH_TARGET_MAX_DISTANCE = 150;\n\n// Helper methods\nconst getCardStackWithId = (\n  state: ICardsState,\n  id: string\n): ICardStack | undefined => {\n  return state.cards.find((card) => card.id === id);\n};\n\nconst mutateCardWithId = (\n  state: ICardsState,\n  id: string,\n  ref: string,\n  callback: (card: ICardStack) => void\n) => {\n  const cardToUpdate = getCardStackWithId(state, id);\n  if (\n    cardToUpdate &&\n    (cardToUpdate.controlledBy === \"\" || cardToUpdate.controlledBy === ref)\n  ) {\n    callback(cardToUpdate);\n  }\n};\n\nconst foreachSelectedAndControlledCard = (\n  state: ICardsState,\n  actorRef: string,\n  callback: (card: ICardStack) => void\n) => {\n  state.cards\n    .filter((card) => card.selected && card.controlledBy === actorRef)\n    .forEach((card) => callback(card));\n};\n\nconst foreachUnselectedCard = (\n  state: ICardsState,\n  callback: (card: ICardStack) => void\n) => {\n  state.cards\n    .filter((card) => !card.selected)\n    .forEach((card) => callback(card));\n};\n\nconst getDropTargetCard = (\n  state: ICardsState,\n  draggedCardPosition: Vector2d,\n  allowedDistance: number = CARD_DROP_TARGET_DISTANCE\n): ICardStack | null => {\n  // go through and find if any unselected cards are potential drop targets\n  // If so, get the closest one. But only if the card is owned / controlled by us\n  const possibleDropTargets: { distance: number; card: ICardStack }[] = [];\n\n  foreachUnselectedCard(state, (card) => {\n    // console.log(`card pos: ${card.x}, ${card.y}`);\n    // console.log(\n    //   `compare pos: ${draggedCardPosition.x}, ${draggedCardPosition.y}`\n    // );\n    const distance = getDistance({ x: card.x, y: card.y }, draggedCardPosition);\n    if (distance < allowedDistance) {\n      possibleDropTargets.push({\n        distance,\n        card,\n      });\n    }\n  });\n\n  return (\n    possibleDropTargets.sort((c1, c2) => c1.distance - c2.distance)[0]?.card ??\n    null\n  );\n};\n\n// Reducers\nconst selectCardReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{ id: string; unselectOtherCards: boolean }>\n> = (state, action) => {\n  if (action.payload.unselectOtherCards) {\n    unselectAllCardsReducer(state, action);\n  }\n\n  mutateCardWithId(\n    state,\n    action.payload.id,\n    (action as any).ACTOR_REF,\n    (card) => {\n      card.selected = true;\n      card.controlledBy = (action as any).ACTOR_REF;\n    }\n  );\n};\n\nconst unselectCardReducer: CaseReducer<ICardsState, PayloadAction<string>> = (\n  state,\n  action\n) => {\n  mutateCardWithId(state, action.payload, (action as any).ACTOR_REF, (card) => {\n    card.selected = false;\n    card.controlledBy = \"\";\n  });\n};\n\nconst toggleSelectCardReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<string>\n> = (state, action) => {\n  mutateCardWithId(state, action.payload, (action as any).ACTOR_REF, (card) => {\n    card.selected = !card.selected;\n    if (!card.selected) {\n      card.controlledBy = \"\";\n    } else {\n      card.controlledBy = (action as any).ACTOR_REF;\n    }\n  });\n};\n\nconst exhaustCardReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<string | undefined>\n> = (state, action) => {\n  state.cards\n    .filter(\n      (card) =>\n        card.controlledBy === (action as any).ACTOR_REF &&\n        (card.id === (action.payload ?? \"\") || card.selected)\n    )\n    .forEach((card) => {\n      card.exhausted = !card.exhausted;\n    });\n};\n\nconst deleteCardStackReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<string | undefined>\n> = (state, action) => {\n  foreachSelectedAndControlledCard(state, (action as any).ACTOR_REF, (card) => {\n    const stackIndex = state.cards.findIndex((c) => c.id === card.id);\n    if (stackIndex !== -1) {\n      state.cards.splice(stackIndex, 1);\n    }\n  });\n};\n\nconst clearCardTokensReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<string | undefined>\n> = (state, action) => {\n  state.cards\n    .filter(\n      (card) =>\n        card.controlledBy === (action as any).ACTOR_REF &&\n        (card.id === (action.payload ?? \"\") || card.selected)\n    )\n    .forEach((card) => {\n      card.statusTokens = {\n        tough: false,\n        stunned: false,\n        confused: false,\n      };\n\n      card.counterTokens = {\n        damage: 0,\n        threat: 0,\n        generic: 0,\n      };\n\n      card.modifiers = {};\n      card.extraIcons = [];\n    });\n};\n\nconst getAttachDrawPos = (\n  state: Draft<ICardsState>,\n  baseCard: ICardStack\n): Vector2d => {\n  let drawPos = { x: 0, y: 0 };\n  let takenSpace = true;\n  for (let i = 0; takenSpace; i++) {\n    const xToDraw = baseCard.x + (i + 1) * 50;\n    const yToDraw = baseCard.y - (i + 1) * 50;\n\n    drawPos = { x: xToDraw, y: yToDraw };\n\n    //Check for existing card\n    takenSpace = !!state.cards.find((c) => c.x === xToDraw && c.y === yToDraw);\n  }\n  return drawPos;\n};\n\nconst cardFromHandMoveReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{ x: number; y: number }>\n> = (state, action) => {\n  state.dropTargetCards[(action as any).ACTOR_REF] = getDropTargetCard(\n    state,\n    action.payload,\n    CARD_DROP_TARGET_DISTANCE * 2\n  );\n};\n\nconst cardMoveReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{ id: string; dx: number; dy: number }>\n> = (state, action) => {\n  const movedCards: ICardStack[] = [];\n\n  let primaryCard: ICardStack | null = null;\n\n  state.cards\n    .filter(\n      (card) =>\n        card.id === action.payload.id ||\n        (card.selected && card.controlledBy === (action as any).ACTOR_REF)\n    )\n    .forEach((card) => {\n      if (card.id === action.payload.id) {\n        primaryCard = card;\n      }\n\n      card.x += action.payload.dx;\n      card.y += action.payload.dy;\n\n      movedCards.push(card);\n    });\n\n  // Not sure why I have to do this typescript....\n  primaryCard = primaryCard as ICardStack | null;\n\n  if (\n    !!primaryCard &&\n    (primaryCard as ICardStack).controlledBy === (action as any).ACTOR_REF\n  ) {\n    state.dropTargetCards[(action as any).ACTOR_REF] = getDropTargetCard(\n      state,\n      !!primaryCard ? { x: primaryCard.x, y: primaryCard.y } : { x: 0, y: 0 }\n    );\n  }\n\n  // go through and find if any unselected cards are potential attach targets\n  // If so, get the closest one. But only if the card is owned / controlled by us\n  const possibleAttachTargets: { distance: number; card: ICardStack }[] = [];\n  if (\n    !!primaryCard &&\n    (primaryCard as ICardStack).controlledBy === (action as any).ACTOR_REF\n  ) {\n    foreachUnselectedCard(state, (card) => {\n      const distance = getDistance(\n        !!primaryCard ? { x: primaryCard.x, y: primaryCard.y } : { x: 0, y: 0 },\n        { x: card.x, y: card.y }\n      );\n      if (\n        distance < CARD_ATTACH_TARGET_MAX_DISTANCE &&\n        distance > CARD_ATTACH_TARGET_MIN_DISTANCE &&\n        card.x < (primaryCard?.x ?? 0) &&\n        card.y > (primaryCard?.y ?? 0)\n      ) {\n        possibleAttachTargets.push({\n          distance,\n          card,\n        });\n      }\n    });\n  }\n\n  state.attachTargetCards[(action as any).ACTOR_REF] =\n    possibleAttachTargets.sort((c1, c2) => c1.distance - c2.distance)[0]\n      ?.card ?? null;\n\n  const attachTarget = state.attachTargetCards[(action as any).ACTOR_REF];\n  if (!!attachTarget) {\n    // First, figure out where we should draw the ghost card. Keep moving up\n    // and to the right until there's not a card there\n\n    const drawPos = getAttachDrawPos(state, attachTarget);\n\n    // Next, check if there's already a ghost card where we were going to draw\n    const existingGhostCard = state.ghostCards.find(\n      (gc) =>\n        gc.x === drawPos.x &&\n        gc.y === drawPos.y &&\n        gc.cardStack.length > 0 &&\n        gc.cardStack[0].jsonId === \"-1\"\n    );\n    if (!existingGhostCard) {\n      const attachGhostCard: ICardStack = JSON.parse(\n        JSON.stringify(attachTarget)\n      );\n      // In general we don't want to do this (generate ids in here) but since this is just a temporary ghost card that we won't\n      // ever refer to by id, it should be safe.\n      attachGhostCard.id = uuidv4();\n      attachGhostCard.x = drawPos.x;\n      attachGhostCard.y = drawPos.y;\n      attachGhostCard.cardStack = [{ jsonId: \"-1\" }];\n      state.ghostCards.push(attachGhostCard);\n    }\n  } else {\n    // remove all 'attachment' ghost cards\n    state.ghostCards = state.ghostCards.filter(\n      (gc) => gc.cardStack.length > 0 && gc.cardStack[0].jsonId !== \"-1\"\n    );\n  }\n\n  // put the moved cards at the end. TODO: we could just store the move order or move time\n  // or something, and the array could be a selector\n  movedCards.forEach((movedCard) => {\n    state.cards.push(state.cards.splice(state.cards.indexOf(movedCard), 1)[0]);\n  });\n};\n\nconst endCardMoveReducer: CaseReducer<ICardsState, PayloadAction<string>> = (\n  state,\n  action\n) => {\n  let dropTargetCards: ICardDetails[] = [];\n  let attachTargetCardStacks: ICardStack[] = [];\n  state.cards\n    .filter(\n      (card) =>\n        card.id === action.payload ||\n        (card.selected && card.controlledBy === (action as any).ACTOR_REF)\n    )\n    .forEach((card) => {\n      card.dragging = false;\n\n      if (!!state.attachTargetCards[(action as any).ACTOR_REF]) {\n        attachTargetCardStacks.push(card);\n      } else if (!!state.dropTargetCards[(action as any).ACTOR_REF]) {\n        // Add the cards to the drop Target card stack\n        dropTargetCards = dropTargetCards.concat(card.cardStack);\n      }\n    });\n\n  const attachTarget = state.attachTargetCards[(action as any).ACTOR_REF];\n  if (!!attachTarget) {\n    const drawPos = getAttachDrawPos(state, attachTarget);\n\n    attachTargetCardStacks.forEach((cs, index) => {\n      cs.x = drawPos.x + index * 50;\n      cs.y = drawPos.y - index * 50;\n      state.cards.unshift(state.cards.splice(state.cards.indexOf(cs), 1)[0]);\n    });\n    // Now, if there was a drop target card, remove all those cards from the state\n  } else if (!!state.dropTargetCards[(action as any).ACTOR_REF]) {\n    state.cards = state.cards.filter(\n      (card) =>\n        !(\n          card.id === action.payload ||\n          (card.selected && card.controlledBy === (action as any).ACTOR_REF)\n        )\n    );\n\n    const dropTargetCard = state.cards.find(\n      (card) => card.id === state.dropTargetCards[(action as any).ACTOR_REF]?.id\n    );\n    if (!!dropTargetCard && dropTargetCards.length > 0) {\n      // add the cards we've collected to the top of the stack\n      dropTargetCard.cardStack = dropTargetCards.concat(\n        dropTargetCard.cardStack\n      );\n    }\n  }\n\n  state.ghostCards = [];\n  state.dropTargetCards[(action as any).ACTOR_REF] = null;\n  state.attachTargetCards[(action as any).ACTOR_REF] = null;\n};\n\nconst selectMultipleCardsReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{ ids: string[]; unselectOtherCards?: boolean }>\n> = (state, action) => {\n  // first, if we were told to unselect our other cards, do that\n  if (!!action.payload.unselectOtherCards) {\n    unselectAllCardsReducer(state, action as unknown as any);\n  }\n\n  action.payload.ids\n    .map((id) => state.cards.find((card) => card.id === id))\n    .forEach((card) => {\n      if (\n        card &&\n        (card.controlledBy === \"\" ||\n          card.controlledBy === (action as any).ACTOR_REF)\n      ) {\n        card.selected = true;\n        card.controlledBy = (action as any).ACTOR_REF;\n      }\n    });\n};\n\nconst unselectAllCardsReducer: CaseReducer<ICardsState, PayloadAction<any>> = (\n  state,\n  action\n) => {\n  state.cards\n    .filter(\n      (card) =>\n        card.controlledBy === \"\" ||\n        card.controlledBy === (action as any).ACTOR_REF\n    )\n    .forEach((card) => {\n      card.selected = false;\n      card.controlledBy = \"\";\n    });\n};\n\nconst togglePanModeReducer: CaseReducer<ICardsState> = (state) => {\n  state.panMode = !state.panMode;\n};\n\nconst toggleMultiselectModeReducer: CaseReducer<ICardsState> = (state) => {\n  state.multiselectMode = !state.multiselectMode;\n};\n\nconst flipCardsReducer: CaseReducer<ICardsState> = (state, action) => {\n  state.cards\n    .filter(\n      (card) =>\n        card.selected &&\n        (card.controlledBy === \"\" ||\n          card.controlledBy === (action as any).ACTOR_REF)\n    )\n    .forEach((card) => {\n      card.faceup = !card.faceup;\n      card.cardStack = card.cardStack.reverse();\n    });\n};\n\nconst resetCardsReducer: CaseReducer<ICardsState> = (state) => {\n  state.cards = [];\n  state.playerHands = generateDefaultPlayerHands();\n};\n\nconst toggleTokenReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{ id?: string; tokenType: StatusTokenType; value?: boolean }>\n> = (state, action) => {\n  foreachSelectedAndControlledCard(state, (action as any).ACTOR_REF, (card) => {\n    if (action.payload.value !== undefined) {\n      card.statusTokens[action.payload.tokenType] = action.payload.value;\n    } else {\n      card.statusTokens[action.payload.tokenType] =\n        !card.statusTokens[action.payload.tokenType];\n    }\n  });\n};\n\nconst adjustCounterTokenReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{\n    id?: string;\n    tokenType: CounterTokenType;\n    delta?: number;\n    value?: number;\n  }>\n> = (state, action) => {\n  let cardsToToggle = state.cards.filter(\n    (c) =>\n      (!!action.payload.id && action.payload.id === c.id) ||\n      (c.selected && c.controlledBy === (action as any).ACTOR_REF)\n  );\n\n  cardsToToggle.forEach((c) => {\n    if (action.payload.value !== undefined) {\n      c.counterTokens[action.payload.tokenType] = action.payload.value;\n    } else if (action.payload.delta !== undefined) {\n      c.counterTokens[action.payload.tokenType] += action.payload.delta;\n    }\n    if (c.counterTokens[action.payload.tokenType] < 0) {\n      c.counterTokens[action.payload.tokenType] = 0;\n    }\n  });\n};\n\nconst adjustModifierReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{\n    id?: string;\n    modifierId: string;\n    delta?: number;\n    value?: number;\n  }>\n> = (state, action) => {\n  let cardsToToggle = state.cards.filter(\n    (c) =>\n      (!!action.payload.id && action.payload.id === c.id) ||\n      (c.selected && c.controlledBy === (action as any).ACTOR_REF)\n  );\n\n  cardsToToggle.forEach((c) => {\n    if (action.payload.value !== undefined) {\n      c.modifiers[action.payload.modifierId] = action.payload.value;\n    } else if (action.payload.delta !== undefined) {\n      if (c.modifiers[action.payload.modifierId] === undefined) {\n        c.modifiers[action.payload.modifierId] = 0;\n      }\n      c.modifiers[action.payload.modifierId] += action.payload.delta;\n    }\n  });\n};\n\nconst clearAllModifiersReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{\n    id?: string;\n  }>\n> = (state, action) => {\n  let cardsToToggle = state.cards.filter(\n    (c) =>\n      (!!action.payload.id && action.payload.id === c.id) ||\n      (c.selected && c.controlledBy === (action as any).ACTOR_REF)\n  );\n\n  cardsToToggle.forEach((c) => {\n    c.modifiers = {};\n    c.extraIcons = [];\n  });\n};\n\nconst addToPlayerHandReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{\n    playerNumber: number;\n  }>\n> = (state, action) => {\n  const playerIndex = action.payload.playerNumber - 1;\n  if (playerIndex < 0 || playerIndex >= state.playerHands.length) {\n    console.error(\n      `Got an invalid playerNumber: ${action.payload.playerNumber}. PlayerHands length is ${state.playerHands.length}`\n    );\n    return;\n  }\n\n  const playerHand = state.playerHands[playerIndex];\n\n  foreachSelectedAndControlledCard(state, (action as any).ACTOR_REF, (card) => {\n    state.playerHands[playerIndex].cards = card.cardStack.concat(\n      playerHand.cards\n    );\n  });\n\n  deleteCardStackReducer(state, {\n    ACTOR_REF: (action as any).ACTOR_REF,\n    payload: undefined,\n    type: deleteCardStack.type,\n  } as any);\n};\n\nconst reorderPlayerHandReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{\n    playerNumber: number;\n    sourceIndex: number;\n    destinationIndex: number;\n  }>\n> = (state, action) => {\n  if (state.playerHands.length >= action.payload.playerNumber) {\n    const hand = state.playerHands[action.payload.playerNumber - 1];\n    const result = Array.from(hand.cards);\n    const [removed] = result.splice(action.payload.sourceIndex, 1);\n    result.splice(action.payload.destinationIndex, 0, removed);\n\n    hand.cards = result;\n  }\n};\n\nconst removeFromPlayerHandReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{\n    playerNumber: number;\n    index: number;\n  }>\n> = (state, action) => {\n  if (state.playerHands.length >= action.payload.playerNumber) {\n    const hand = state.playerHands[action.payload.playerNumber - 1];\n    const result = Array.from(hand.cards);\n    result.splice(action.payload.index, 1);\n\n    hand.cards = result;\n  }\n};\n\nconst addToExistingCardStackReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<{\n    existingStackId: string;\n    cardJsonIds: string[];\n  }>\n> = (state, action) => {\n  let existingStack =\n    state.cards.filter((c) => c.id === action.payload.existingStackId)[0] ??\n    null;\n  if (existingStack) {\n    existingStack.cardStack = action.payload.cardJsonIds\n      .map((id) => ({ jsonId: id }))\n      .concat(existingStack.cardStack);\n  }\n\n  state.dropTargetCards[(action as any).ACTOR_REF] = null;\n};\n\nconst addExtraIconReducer: CaseReducer<ICardsState, PayloadAction<string>> = (\n  state,\n  action\n) => {\n  foreachSelectedAndControlledCard(state, (action as any).ACTOR_REF, (card) => {\n    if (!card.extraIcons.includes(action.payload)) {\n      card.extraIcons.push(action.payload);\n    }\n  });\n};\n\nconst removeExtraIconReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<string>\n> = (state, action) => {\n  foreachSelectedAndControlledCard(state, (action as any).ACTOR_REF, (card) => {\n    if (card.extraIcons.includes(action.payload)) {\n      card.extraIcons.splice(card.extraIcons.indexOf(action.payload), 1);\n    }\n  });\n};\n\nconst toggleExtraIconReducer: CaseReducer<\n  ICardsState,\n  PayloadAction<string>\n> = (state, action) => {\n  foreachSelectedAndControlledCard(state, (action as any).ACTOR_REF, (card) => {\n    if (card.extraIcons.includes(action.payload)) {\n      card.extraIcons.splice(card.extraIcons.indexOf(action.payload), 1);\n    } else {\n      card.extraIcons.push(action.payload);\n    }\n  });\n};\n// Selectors\n\n// slice\nconst cardsSlice = createSlice({\n  name: \"cards\",\n  initialState: initialState,\n  reducers: {\n    selectCard: selectCardReducer,\n    unselectCard: unselectCardReducer,\n    toggleSelectCard: toggleSelectCardReducer,\n    exhaustCard: exhaustCardReducer,\n    deleteCardStack: deleteCardStackReducer,\n    cardMove: cardMoveReducer,\n    endCardMove: endCardMoveReducer,\n    cardFromHandMove: cardFromHandMoveReducer,\n    selectMultipleCards: selectMultipleCardsReducer,\n    unselectAllCards: unselectAllCardsReducer,\n    togglePanMode: togglePanModeReducer,\n    toggleMultiselectMode: toggleMultiselectModeReducer,\n    flipCards: flipCardsReducer,\n    resetCards: resetCardsReducer,\n    toggleToken: toggleTokenReducer,\n    adjustCounterToken: adjustCounterTokenReducer,\n    adjustModifier: adjustModifierReducer,\n    clearAllModifiers: clearAllModifiersReducer,\n    clearCardTokens: clearCardTokensReducer,\n    reorderPlayerHand: reorderPlayerHandReducer,\n    removeFromPlayerHand: removeFromPlayerHandReducer,\n    addToPlayerHand: addToPlayerHandReducer,\n    addToExistingCardStack: addToExistingCardStackReducer,\n    addExtraIcon: addExtraIconReducer,\n    removeExtraIcon: removeExtraIconReducer,\n    toggleExtraIcon: toggleExtraIconReducer,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(receiveRemoteGameState, (state, action) => {\n      // TODO: find a way to keep this automatic\n      state.cards = action.payload.liveState.present.cards.cards;\n      state.ghostCards = action.payload.liveState.present.cards.ghostCards;\n    });\n\n    builder.addCase(verifyRemoteGameState, (state, action) => {\n      state.outOfSyncWithRemote = !(\n        isEqual(\n          original(state.cards)?.filter((c) => !c.dragging),\n          action.payload.liveState.present.cards.cards.filter(\n            (c) => !c.dragging\n          )\n        ) &&\n        isEqual(\n          original(state.ghostCards),\n          action.payload.liveState.present.cards.ghostCards\n        )\n      );\n\n      if (state.outOfSyncWithRemote) {\n        console.error(\n          \"CARDS state is out of synce with remote!!!\",\n          original(state),\n          action.payload.liveState.present.cards\n        );\n      } else {\n        console.log(\"CARDS state is in sync\");\n      }\n    });\n\n    builder.addCase(replaceCardStack, (state, action) => {\n      const cardToReplaceStack = state.cards.find(\n        (c) => c.id === action.payload.id\n      );\n      if (!!cardToReplaceStack) {\n        cardToReplaceStack.cardStack = action.payload.newStack;\n      }\n    });\n\n    builder.addCase(resetApp, (state) => {\n      state.cards = [];\n      state.playerHands = generateDefaultPlayerHands();\n      // state.previewCard = null;\n      state.dropTargetCards = {};\n      state.ghostCards = [];\n      state.panMode = true;\n    });\n\n    builder.addCase(addCardStackWithId, (state, action) => {\n      const newStack: ICardStack = {\n        controlledBy: \"\",\n        x: action.payload.position.x,\n        y: action.payload.position.y,\n        dragging: false,\n        shuffling: false,\n        exhausted: false,\n        faceup: true,\n        fill: \"red\",\n        id: action.payload.id,\n        cardStack: action.payload.cardJsonIds.map((jsonId) => ({\n          jsonId,\n        })),\n        selected: false,\n        statusTokens: {\n          stunned: false,\n          confused: false,\n          tough: false,\n        },\n        counterTokens: {\n          damage: 0,\n          threat: 0,\n          generic: 0,\n        },\n        modifiers: {},\n        extraIcons: [],\n      };\n\n      state.cards.push(newStack);\n    });\n\n    builder.addCase(pullCardOutOfCardStackWithId, (state, action) => {\n      const cardStackToUse = state.cards.find(\n        (c) => c.id === action.payload.cardStackId\n      );\n      if (!!cardStackToUse && cardStackToUse.cardStack.length > 1) {\n        const newCardStack: ICardDetails[] = [\n          { jsonId: action.payload.jsonId },\n        ];\n        const newCard = Object.assign({}, cardStackToUse, {\n          cardStack: newCardStack,\n        });\n        newCard.id = action.payload.id;\n        newCard.selected = true;\n        newCard.controlledBy = (action as any).ACTOR_REF;\n        newCard.x = newCard.x + cardConstants.CARD_WIDTH + 5;\n\n        // Find the first instance of the card with the json id. Note that because there\n        // might be multiple cards with the same json id, we can't just do a filter\n        const cardIndexToRemove = cardStackToUse.cardStack.findIndex(\n          (c) => c.jsonId === action.payload.jsonId\n        );\n\n        if (cardIndexToRemove !== -1) {\n          cardStackToUse.cardStack.splice(cardIndexToRemove, 1);\n        }\n\n        cardStackToUse.selected = false;\n        cardStackToUse.controlledBy = \"\";\n\n        state.cards.push(newCard);\n      }\n    });\n\n    builder.addCase(startCardMoveWithSplitStackId, (state, action) => {\n      // first, if the card moving isn't currently selected, clear all _our_ selected cards\n      const cardToStartMoving = getCardStackWithId(state, action.payload.id);\n      if (cardToStartMoving && !cardToStartMoving.selected) {\n        state.cards = state.cards.map((card) => {\n          if (\n            card.controlledBy === \"\" ||\n            card.controlledBy === (action as any).ACTOR_REF\n          ) {\n            card.selected = card.id === action.payload.id;\n            if (card.selected) {\n              card.controlledBy = (action as any).ACTOR_REF;\n            } else {\n              card.controlledBy = \"\";\n            }\n          }\n          return card;\n        });\n      }\n\n      // If we are splitting, make a new stack of cards\n      if (action.payload.splitTopCard) {\n        const cardToMove = state.cards.find((c) => c.id === action.payload.id);\n\n        if (!cardToMove) {\n          throw new Error(\"Expected to find card\");\n        }\n\n        cardToMove.selected = false;\n        cardToMove.controlledBy = \"\";\n\n        const topCard = cardToMove.cardStack.shift();\n        const newCard = Object.assign({}, cardToMove, {\n          selected: true,\n          controlledBy: (action as any).ACTOR_REF,\n          dragging: true,\n          cardStack: [topCard],\n        });\n\n        cardToMove.id = action.payload.splitCardId;\n\n        state.cards.push(newCard);\n      }\n\n      // Now all selected cards should be put into ghost cards, unless we are splitting the top card\n      state.ghostCards = [];\n\n      if (!action.payload.splitTopCard) {\n        foreachSelectedAndControlledCard(\n          state,\n          (action as any).ACTOR_REF,\n          (card) => {\n            card.dragging = true;\n            state.ghostCards.push(Object.assign({}, card));\n          }\n        );\n      }\n\n      //Finally, if we have a preview card, clear it\n      // state.previewCard = null;\n    });\n\n    builder.addCase(drawCardsOutOfCardStackWithIds, (state, action) => {\n      if (action.payload.numberToDraw !== action.payload.idsToUse.length) {\n        throw new Error(\"Did not receive the expected number of ids\");\n      }\n\n      // First, unselect everything else of ours\n      unselectAllCardsReducer(state, action as unknown as any);\n\n      // Get the cardstack in question\n      let cardStackToUse = state.cards.find(\n        (c) => c.id === action.payload.cardStackId\n      );\n\n      if (!cardStackToUse) {\n        throw new Error(\n          `Couldn't find card stack with id ${action.payload.cardStackId}`\n        );\n      }\n\n      const sourceCardStackId = cardStackToUse.id;\n\n      //Next, for each card we should draw, remove it from the stack and make a new stack, which should be selected\n      // In the case that we're told to draw it into our hand, we don't need to make\n      // any new stacks\n      for (let index = 0; index < action.payload.numberToDraw; index++) {\n        if (!!cardStackToUse) {\n          const topCardDetails = cardStackToUse.cardStack.shift();\n          if (!topCardDetails) {\n            throw new Error(\"Expected to find a top card, but didn't\");\n          }\n          if (action.payload.drawIntoHand) {\n            const playerIndex = action.payload.playerNumber - 1;\n            state.playerHands[playerIndex].cards.push({\n              jsonId: topCardDetails.jsonId,\n            });\n          } else {\n            const newCardStack: ICardDetails[] = [\n              { jsonId: topCardDetails.jsonId },\n            ];\n            const newCard = Object.assign({}, cardStackToUse, {\n              cardStack: newCardStack,\n            });\n            newCard.id = action.payload.idsToUse[index];\n            newCard.selected = true;\n            newCard.controlledBy = (action as any).ACTOR_REF;\n            newCard.faceup = !action.payload.facedown;\n            newCard.x =\n              newCard.x + (cardConstants.CARD_WIDTH + 5) * (index + 1);\n            newCard.y += cardConstants.CARD_HEIGHT;\n\n            state.cards.push(newCard);\n          }\n\n          if (cardStackToUse.cardStack.length === 0) {\n            // we went through all the cards, remove the original card\n            state.cards = state.cards.filter((c) => c.id !== sourceCardStackId);\n            cardStackToUse = undefined;\n          }\n        }\n      }\n    });\n\n    builder.addCase(setStackShuffling, (state, action) => {\n      // get the stack to update\n      const stackToUpdate = state.cards.find((c) => c.id === action.payload.id);\n\n      if (!!stackToUpdate) {\n        stackToUpdate.shuffling = action.payload.shuffling;\n      }\n    });\n\n    builder.addCase(createDeckFromTextFileWithIds, (state, action) =>\n      handleLoadDeck(state, action)\n    );\n\n    builder.addCase(fetchDecklistById.fulfilled, (state, action) =>\n      handleLoadDeck(state, action)\n    );\n\n    builder.addCase(startDraggingCardFromHand, (state, action) => {\n      // Clear all our selected cards\n      unselectAllCardsReducer(state, action as unknown as any);\n    });\n  },\n});\n\nconst handleLoadDeck = (\n  state: Draft<ICardsState>,\n  action: PayloadAction<CreateDeckPayload>\n) => {\n  console.log(\"got decklist\");\n  console.log(action);\n\n  const potentialHeroCard: ICardDetails[] = action.payload.data\n    .investigator_code\n    ? [{ jsonId: action.payload.data.investigator_code }]\n    : [];\n\n  const heroCardStack = [\n    ...potentialHeroCard,\n    ...action.payload.extraHeroCards,\n  ];\n\n  const heroCard: ICardStack = {\n    controlledBy: (action as any).ACTOR_REF,\n    selected: true,\n    x: action.payload.position.x,\n    y: action.payload.position.y,\n    dragging: false,\n    shuffling: false,\n    exhausted: false,\n    faceup: true,\n    fill: \"red\",\n    id: action.payload.heroId,\n    cardStack: heroCardStack,\n    statusTokens: {\n      stunned: false,\n      confused: false,\n      tough: false,\n    },\n    counterTokens: {\n      damage: 0,\n      threat: 0,\n      generic: 0,\n    },\n    modifiers: {},\n    extraIcons: [],\n  };\n\n  let mainDeckStack: ICardDetails[] = [];\n  Object.entries(action.payload.data.slots).forEach(([key, value]) => {\n    const cardDetails: ICardDetails[] = Array.from(Array(value).keys()).map(\n      (): ICardDetails => ({ jsonId: key })\n    );\n    mainDeckStack = mainDeckStack.concat(cardDetails);\n  });\n\n  const cardPadding = cardConstants.CARD_WIDTH + 10;\n\n  const newDeck: ICardStack = {\n    controlledBy: (action as any).ACTOR_REF,\n    selected: true,\n    x: action.payload.position.x + cardPadding,\n    y: action.payload.position.y,\n    dragging: false,\n    shuffling: false,\n    exhausted: false,\n    faceup: true,\n    fill: \"red\",\n    id: action.payload.dataId,\n    cardStack: mainDeckStack,\n    statusTokens: {\n      stunned: false,\n      confused: false,\n      tough: false,\n    },\n    counterTokens: {\n      damage: 0,\n      threat: 0,\n      generic: 0,\n    },\n    modifiers: {},\n    extraIcons: [],\n  };\n\n  const encounterDeck: ICardStack = {\n    controlledBy: (action as any).ACTOR_REF,\n    selected: true,\n    x: action.payload.position.x + cardPadding * 2,\n    y: action.payload.position.y,\n    dragging: false,\n    shuffling: false,\n    exhausted: false,\n    faceup: true,\n    fill: \"red\",\n    id: action.payload.encounterDeckId,\n    cardStack: action.payload.relatedEncounterDeck.map((jsonId) => ({\n      jsonId,\n    })),\n    statusTokens: {\n      stunned: false,\n      confused: false,\n      tough: false,\n    },\n    counterTokens: {\n      damage: 0,\n      threat: 0,\n      generic: 0,\n    },\n    modifiers: {},\n    extraIcons: [],\n  };\n\n  const obligationDeck: ICardStack = {\n    controlledBy: (action as any).ACTOR_REF,\n    selected: true,\n    x: action.payload.position.x + cardPadding * 3,\n    y: action.payload.position.y,\n    dragging: false,\n    shuffling: false,\n    exhausted: false,\n    faceup: true,\n    fill: \"red\",\n    id: action.payload.obligationDeckId,\n    cardStack: action.payload.relatedObligationDeck.map((jsonId) => ({\n      jsonId,\n    })),\n    statusTokens: {\n      stunned: false,\n      confused: false,\n      tough: false,\n    },\n    counterTokens: {\n      damage: 0,\n      threat: 0,\n      generic: 0,\n    },\n    modifiers: {},\n    extraIcons: [],\n  };\n\n  if (heroCard.cardStack.length > 0) {\n    state.cards.push(heroCard);\n  }\n\n  if (newDeck.cardStack.length > 0) {\n    state.cards.push(newDeck);\n  }\n\n  if (encounterDeck.cardStack.length > 0) {\n    state.cards.push(encounterDeck);\n  }\n\n  if (obligationDeck.cardStack.length > 0) {\n    state.cards.push(obligationDeck);\n  }\n};\n\nexport const {\n  selectCard,\n  unselectCard,\n  toggleSelectCard,\n  exhaustCard,\n  deleteCardStack,\n  cardMove,\n  endCardMove,\n  cardFromHandMove,\n  selectMultipleCards,\n  unselectAllCards,\n  togglePanMode,\n  toggleMultiselectMode,\n  flipCards,\n  resetCards,\n  toggleToken,\n  adjustCounterToken,\n  clearCardTokens,\n  adjustModifier,\n  clearAllModifiers,\n  reorderPlayerHand,\n  removeFromPlayerHand,\n  addToPlayerHand,\n  addToExistingCardStack,\n  addExtraIcon,\n  removeExtraIcon,\n  toggleExtraIcon,\n} = cardsSlice.actions;\n\nexport default cardsSlice.reducer;\n","import { createAction } from \"@reduxjs/toolkit\";\nimport { Vector2d } from \"konva/lib/types\";\n\nexport interface AddNewCounterWithIdPayload {\n  pos: Vector2d;\n  id: string;\n}\n\nexport const addNewCounterWithId = createAction<AddNewCounterWithIdPayload>(\n  \"addNewCounterWithId\"\n);\n","import { Vector2d } from \"konva/lib/types\";\nimport { PlayerColor } from \"../../constants/app-constants\";\nimport { loadState } from \"../../store/localStorage\";\nimport JSONCrush from \"jsoncrush\";\n\nexport interface ICountersState {\n  counters: ICounter[];\n  firstPlayerCounterPosition: Vector2d;\n}\n\nexport interface ICounter {\n  id: string;\n  position: Vector2d;\n  value: number;\n  color: PlayerColor;\n}\n\nconst queryParams = new URLSearchParams(window.location.search);\nconst queryParamsCountersString = queryParams.get(\"counters\");\nconst queryParamsCounters = !!queryParamsCountersString\n  ? JSON.parse(JSONCrush.uncrush(queryParamsCountersString))\n  : null;\n\nconst localStorageState: ICountersState =\n  queryParamsCounters || (loadState(\"liveState\")?.counters ?? {});\n\nconst defaultState: ICountersState = {\n  counters: [],\n  firstPlayerCounterPosition: { x: 0, y: 0 },\n};\nexport const initialState: ICountersState = {\n  ...defaultState,\n  ...localStorageState,\n};\n","import { CaseReducer, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { Vector2d } from \"konva/lib/types\";\nimport { PlayerColor } from \"../../constants/app-constants\";\nimport { receiveRemoteGameState, resetApp } from \"../../store/global.actions\";\nimport { addNewCounterWithId } from \"./counters.actions\";\nimport { ICountersState, initialState } from \"./initialState\";\n\n// Reducers\nconst updateCounterValueReducer: CaseReducer<\n  ICountersState,\n  PayloadAction<{ id: string; delta: number }>\n> = (state, action) => {\n  const counter = state.counters.find((c) => c.id === action.payload.id);\n  if (!!counter) {\n    counter.value += action.payload.delta;\n    if (counter.value < 0) {\n      counter.value = 0;\n    }\n  }\n};\n\nconst updateCounterColorReducer: CaseReducer<\n  ICountersState,\n  PayloadAction<{ id: string; newColor: PlayerColor }>\n> = (state, action) => {\n  const counter = state.counters.find((c) => c.id === action.payload.id);\n  if (!!counter) {\n    counter.color = action.payload.newColor;\n  }\n};\n\nconst removeCounterReducer: CaseReducer<ICountersState, PayloadAction<string>> =\n  (state, action) => {\n    state.counters = state.counters.filter((c) => c.id !== action.payload);\n  };\n\nconst moveCounterReducer: CaseReducer<\n  ICountersState,\n  PayloadAction<{ id: string; newPos: Vector2d }>\n> = (state, action) => {\n  const counter = state.counters.find((c) => c.id === action.payload.id);\n  if (!!counter) {\n    counter.position = {\n      x: action.payload.newPos.x,\n      y: action.payload.newPos.y,\n    };\n  }\n};\n\nconst moveFirstPlayerCounterReducer: CaseReducer<\n  ICountersState,\n  PayloadAction<Vector2d>\n> = (state, action) => {\n  state.firstPlayerCounterPosition = {\n    x: action.payload.x,\n    y: action.payload.y,\n  };\n};\n\n// slice\nconst countersSlice = createSlice({\n  name: \"counters\",\n  initialState: initialState,\n  reducers: {\n    updateCounterValue: updateCounterValueReducer,\n    removeCounter: removeCounterReducer,\n    moveCounter: moveCounterReducer,\n    moveFirstPlayerCounter: moveFirstPlayerCounterReducer,\n    updateCounterColor: updateCounterColorReducer,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(receiveRemoteGameState, (state, action) => {\n      state.counters = action.payload.liveState.present.counters.counters;\n      state.firstPlayerCounterPosition =\n        action.payload.liveState.present.counters.firstPlayerCounterPosition;\n    });\n\n    builder.addCase(resetApp, (state, action) => {\n      state.counters = [];\n      state.firstPlayerCounterPosition = { x: 0, y: 0 };\n    });\n\n    builder.addCase(addNewCounterWithId, (state, action) => {\n      state.counters.push({\n        id: action.payload.id,\n        position: action.payload.pos,\n        value: 0,\n        color: \"red\",\n      });\n    });\n  },\n});\n\nexport const {\n  updateCounterValue,\n  removeCounter,\n  moveCounter,\n  moveFirstPlayerCounter,\n  updateCounterColor,\n} = countersSlice.actions;\n\nexport default countersSlice.reducer;\n","import { combineReducers } from \"redux\";\nimport undoable, { excludeAction, groupByActionTypes } from \"redux-undo\";\nimport cardsData from \"../features/cards-data/cards-data.slice\";\nimport { startCardMoveWithSplitStackId } from \"../features/cards/cards.actions\";\nimport cards, { cardMove } from \"../features/cards/cards.slice\";\nimport game, {\n  clearPreviewCard,\n  setPreviewCardId,\n} from \"../features/game/game.slice\";\n\nimport counters, { moveCounter } from \"../features/counters/counters.slice\";\n\nconst undoableState = combineReducers({\n  counters,\n  cards,\n});\n\nconst rootReducer = combineReducers({\n  game,\n  cardsData,\n  liveState: undoable(undoableState, {\n    limit: 20,\n    groupBy: groupByActionTypes([moveCounter.type]),\n    filter: excludeAction([\n      startCardMoveWithSplitStackId.type,\n      cardMove.type,\n      setPreviewCardId.type,\n      clearPreviewCard.type,\n    ]),\n  }),\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\n\nexport default rootReducer;\n","import Peer from \"peerjs\";\nimport cloneDeep from \"lodash.clonedeep\";\nimport { myPeerRef } from \"../constants/app-constants\";\nimport { togglePanMode, cardFromHandMove } from \"../features/cards/cards.slice\";\nimport {\n  loadCardsData,\n  loadCardsDataForPack,\n  loadCardsForEncounterSet,\n} from \"../features/cards-data/cards-data.slice\";\nimport {\n  clearMenuPreviewCardJsonId,\n  clearPreviewCard,\n  connectToRemoteGame,\n  requestResync,\n  setMenuPreviewCardJsonId,\n  setPeerId,\n  setPlayerInfo,\n  setPreviewCardId,\n  stopDraggingCardFromHand,\n  updatePosition,\n  updateZoom,\n} from \"../features/game/game.slice\";\nimport {\n  receiveRemoteGameState,\n  startDraggingCardFromHand,\n  verifyRemoteGameState,\n} from \"./global.actions\";\nimport { RootState } from \"./rootReducer\";\n\nconst DEBUG = false;\n\n// These are the actions that we explicitly don't want\n// to send to any peers. These are actions that represent\n// updates we would only want to display visually on the\n// screen of the player initiating the action. Zooming is\n// a great example. One player adjusting their zoom shouldn't\n// affect any other player's zoom.\nconst blacklistRemoteActions = {\n  [connectToRemoteGame.type]: true,\n  [updatePosition.type]: true,\n  [updateZoom.type]: true,\n  [setPreviewCardId.type]: true,\n  [clearPreviewCard.type]: true,\n  [setMenuPreviewCardJsonId.type]: true,\n  [clearMenuPreviewCardJsonId.type]: true,\n  [togglePanMode.type]: true,\n  [receiveRemoteGameState.type]: true,\n  [requestResync.type]: true,\n  [loadCardsData.type]: true,\n  [loadCardsDataForPack.type]: true,\n  [loadCardsForEncounterSet.type]: true,\n  [startDraggingCardFromHand.type]: true,\n  [stopDraggingCardFromHand.type]: true,\n  [cardFromHandMove.type]: true,\n};\n\nconst log = (...args: any[]) => {\n  if (DEBUG) {\n    console.log(args[0], args[1]);\n  }\n};\n\nconst setupConnection = (conn: any, storeAPI: any) => {\n  conn.on(\"data\", (data: any) => {\n    if (!data.INITIAL_STATE_MSG) {\n      if (!!data.RESYNC) {\n        log(\"received request for resync\");\n        conn.send({\n          INITIAL_STATE_MSG: true,\n          state: storeAPI.getState(),\n        });\n      } else if (!!data.PING) {\n        // Check local state\n        data.REMOTE_ACTION = true;\n        storeAPI.dispatch(verifyRemoteGameState(data.state));\n      } else {\n        log(\"recieved remote action\", data);\n        data.REMOTE_ACTION = true;\n        log(\"dispatching remote action\", data);\n        storeAPI.dispatch(data);\n      }\n    } else {\n      console.log(\"going to replace (most of) state with\", data.state);\n      setTimeout(() => {\n        storeAPI.dispatch(receiveRemoteGameState(data.state));\n      }, 0);\n    }\n  });\n};\n\nexport const peerJSMiddleware = (storeAPI: any) => {\n  const cgpPeer = new Peer(undefined, {\n    host: \"peerjs.middle-earth.house\",\n    path: \"/cgp\",\n    secure: true,\n    debug: 0,\n    config: {\n      iceServers: [\n        { urls: \"stun:stun.l.google.com:19302\" },\n        {\n          urls: \"turn:numb.viagenie.ca\",\n          username: \"webrtc@live.com\",\n          credential: \"muazkh\",\n        },\n      ],\n    },\n  });\n  let activeCon: Peer.DataConnection;\n\n  cgpPeer.on(\"error\", (err) => {\n    console.error(\"*****************Server error\");\n    console.error(err);\n  });\n\n  cgpPeer.on(\"disconnected\", () => {\n    console.log(\"****Peer server connection disconnected\");\n  });\n\n  cgpPeer.on(\"open\", (id) => {\n    console.log(\"My peer ID is: \" + id);\n    storeAPI.dispatch(setPeerId(id));\n\n    //look for query param\n    const remoteParamArray = window.location.href.split(\"remote=\");\n    if (remoteParamArray.length > 1) {\n      const remoteId = remoteParamArray[1].split(\"&\")[0];\n      console.log(\"FOUND QUERY PARAM. Going to connect to peer \" + remoteId);\n      activeCon = cgpPeer.connect(remoteId, {\n        metadata: { ref: myPeerRef },\n      });\n      setupConnection(activeCon, storeAPI);\n    }\n  });\n\n  cgpPeer.on(\"connection\", (conn) => {\n    console.log(\"Connection received!\");\n    activeCon = conn;\n    setupConnection(activeCon, storeAPI);\n\n    activeCon.on(\"open\", () => {\n      console.log(\"connection ready for data\");\n      const stateToSend: RootState = cloneDeep(storeAPI.getState());\n      // @ts-ignore\n      delete stateToSend.cardsData;\n\n      log(\"going to send initial state\", stateToSend);\n\n      activeCon.send({\n        INITIAL_STATE_MSG: true,\n        state: stateToSend,\n      });\n      // TODO: more complicated logic to handle multiple connections. Right now\n      // this just changes the connecting client to blue\n      const setPlayerInfoAction = setPlayerInfo({\n        ref: activeCon.metadata.ref,\n        color: \"blue\",\n        playerNumber: 2,\n      });\n      activeCon.send(setPlayerInfoAction);\n      activeCon.send(\n        setPlayerInfo({\n          ref: myPeerRef,\n          color: \"red\",\n          playerNumber: 1,\n        })\n      );\n      storeAPI.dispatch(setPlayerInfoAction);\n\n      // Set up periodic state verification\n      setInterval(() => {\n        const currentState: RootState = cloneDeep(storeAPI.getState());\n        // @ts-ignore\n        delete currentState.cardsData;\n\n        activeCon.send({\n          PING: true,\n          state: currentState,\n        });\n      }, 5000);\n    });\n\n    activeCon.on(\"error\", (err) => {\n      console.error(\"****************Connection error:\", err);\n    });\n\n    activeCon.on(\"close\", () => {\n      console.log(\"******connection closed for ref \" + activeCon.metadata.ref);\n    });\n\n    activeCon.peerConnection.onconnectionstatechange = (ev: Event) => {\n      console.log(`connection state changed`);\n      console.log(ev);\n      console.log(activeCon.peerConnection.connectionState);\n      if (\n        activeCon.peerConnection.connectionState === \"closed\" ||\n        activeCon.peerConnection.connectionState === \"disconnected\"\n      ) {\n        console.log(\n          \"CLEARING CLIENT OWNED CARDS for \" + activeCon.metadata.ref\n        );\n      }\n    };\n  });\n  return (next: any) => (action: any) => {\n    log(\"received local action\", action);\n\n    // If this isn't a REMOTE action, add our ref onto it\n    if (!action.REMOTE_ACTION) {\n      action.ACTOR_REF = myPeerRef;\n    } else if (!action.ACTOR_REF) {\n      console.error(`Received a REMOTE action without an ACTOR_REF:`);\n      console.log(action);\n    }\n\n    if (action.type === connectToRemoteGame.type) {\n      console.log(\"going to connect to peer \" + action.payload);\n      activeCon = cgpPeer.connect(action.payload, {\n        metadata: { ref: myPeerRef },\n      });\n      setupConnection(activeCon, storeAPI);\n    } else if (action.type === requestResync.type) {\n      if (!!activeCon) {\n        activeCon.send({ RESYNC: true });\n      }\n    }\n\n    if (\n      !action.REMOTE_ACTION &&\n      !!activeCon &&\n      !blacklistRemoteActions[action.type]\n    ) {\n      log(\"going to send action to peer!\");\n      activeCon.send(action);\n    }\n\n    return next(action);\n  };\n};\n","import throttle from \"lodash.throttle\";\nimport {\n  configureStore as rtkConfigureStore,\n  getDefaultMiddleware,\n} from \"@reduxjs/toolkit\";\nimport rootReducer from \"./rootReducer\";\nimport { saveState } from \"./localStorage\";\nimport { peerJSMiddleware } from \"./peer-js-redux-middleware\";\n\nconst customizedMiddleware = getDefaultMiddleware({\n  thunk: true,\n  immutableCheck: false,\n  serializableCheck: false,\n}).concat(peerJSMiddleware);\n\nexport default function configureStore() {\n  console.log(\"configuring store. NODE_ENV is \" + process.env.NODE_ENV);\n  const store = rtkConfigureStore({\n    reducer: rootReducer,\n    middleware: customizedMiddleware,\n    devTools: process.env.NODE_ENV !== \"production\",\n  });\n\n  store.subscribe(\n    throttle(() => {\n      saveState(store.getState());\n    }, 1000)\n  );\n\n  return store;\n}\n","import React, { Component } from \"react\";\nimport {\n  DragDropContext,\n  Draggable,\n  DraggableStateSnapshot,\n  DraggingStyle,\n  Droppable,\n  DropResult,\n  NotDraggingStyle,\n  ResponderProvided,\n} from \"react-beautiful-dnd\";\nimport {\n  GameType,\n  myPeerRef,\n  playerHandElementId,\n  playerHandHeightPx,\n} from \"./constants/app-constants\";\nimport { ICardData } from \"./features/cards-data/initialState\";\nimport {\n  ICardDetails,\n  ICardStack,\n  IPlayerHand,\n} from \"./features/cards/initialState\";\nimport \"./PlayerHand.scss\";\nimport TopLayer from \"./TopLayer\";\nimport { getImgUrls } from \"./utilities/card-utils\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport { IconButton } from \"@material-ui/core\";\nimport ContextMenu from \"./ContextMenu\";\nimport { Vector2d } from \"konva/lib/types\";\n\nconst grid = 8;\n\nconst getItemStyle = (\n  snapshot: DraggableStateSnapshot,\n  draggableStyle: any\n): DraggingStyle | NotDraggingStyle | undefined => {\n  return snapshot.dropAnimation &&\n    snapshot.draggingOver === \"droppable-while-dragging\"\n    ? { ...draggableStyle, visibility: \"hidden\" }\n    : {\n        // some basic styles to make the items look a bit nicer\n        userSelect: \"none\",\n        margin: `0 ${grid}px 0 0`,\n\n        // change background colour if dragging\n        // background: snapshot.isDragging ? \"lightgreen\" : \"grey\",\n\n        // styles we need to apply on draggables\n        ...draggableStyle,\n      };\n};\n\nconst getListStyle = (isDraggingOver: boolean) =>\n  ({\n    background: isDraggingOver ? \"lightblue\" : \"lightgrey\",\n    display: \"flex\",\n    alignItems: \"flex-start\",\n    padding: grid,\n    overflowX: \"auto\",\n    overflowY: \"hidden\",\n    position: \"absolute\",\n    bottom: \"0px\",\n    width: \"100vw\",\n    height: `${playerHandHeightPx}px`,\n    zIndex: 99,\n    boxSizing: \"border-box\",\n  } as React.CSSProperties);\n\nconst getListStyle2 = (isDraggingOver: boolean, isDraggingAtAll: boolean) => {\n  return {\n    background: \"rgb(0,0,0,0)\",\n    display: isDraggingAtAll ? \"flex\" : \"none\",\n    padding: grid,\n    overflow: \"auto\",\n    position: \"absolute\",\n    top: \"0px\",\n    height: \"\",\n    width: \"100vw\",\n    boxSizing: \"border-box\",\n    zIndex: 100,\n  } as React.CSSProperties;\n};\n\nconst makeFakeCardStackFromJsonId = (jsonId: string): ICardStack => {\n  return {\n    controlledBy: myPeerRef,\n    dragging: false,\n    shuffling: false,\n    exhausted: false,\n    faceup: true,\n    fill: \"anything\",\n    id: \"fake-id\",\n    selected: false,\n    x: 0,\n    y: 0,\n    cardStack: [{ jsonId }],\n    statusTokens: {\n      stunned: false,\n      confused: false,\n      tough: false,\n    },\n    counterTokens: {\n      damage: 0,\n      threat: 0,\n      generic: 0,\n    },\n    modifiers: {},\n    extraIcons: [],\n  };\n};\n\ninterface IProps {\n  droppedOnTable: (id: string, pos?: Vector2d) => void;\n  droppedBackInHand: () => void;\n  reorderPlayerHand: (payload: {\n    playerNumber: number;\n    sourceIndex: number;\n    destinationIndex: number;\n  }) => void;\n  removeFromPlayerHand: (payload: {\n    playerNumber: number;\n    index: number;\n  }) => void;\n  setPreviewCardJsonId: (jsonId: string) => void;\n  clearPreviewCardJsonId: () => void;\n  startDraggingCardFromHand: () => void;\n  stopDraggingCardFromHand: () => void;\n  playerHandData: IPlayerHand | null;\n  cardData: ICardData;\n  playerNumber: number;\n  currentGameType: GameType | null;\n  dragging: boolean;\n}\ninterface IState {\n  modal: boolean;\n  imgUrlToStatusMap: { [key: string]: ImageLoadingStatus };\n  showMenu: boolean;\n  anchorEl: HTMLElement | undefined;\n}\n\nenum ImageLoadingStatus {\n  NotLoaded,\n  Loading,\n  LoadingFailed,\n  Loaded,\n}\n\nclass PlayerHand extends Component<IProps, IState> {\n  private tapped: NodeJS.Timeout | null = null;\n\n  constructor(props: IProps) {\n    super(props);\n    this.state = {\n      modal: false,\n      imgUrlToStatusMap: {},\n      showMenu: false,\n      anchorEl: undefined,\n    };\n    this.onDragEnd = this.onDragEnd.bind(this);\n    this.onDragStart = this.onDragStart.bind(this);\n  }\n\n  onDragStart() {\n    this.props.startDraggingCardFromHand();\n  }\n\n  onDragEnd(result: DropResult, provided: ResponderProvided) {\n    // dropped outside the list\n    if (!result.destination) {\n      this.props.stopDraggingCardFromHand();\n      return;\n    }\n\n    if (result.destination?.droppableId !== result.source.droppableId) {\n      this.props.removeFromPlayerHand({\n        playerNumber: this.props.playerNumber,\n        index: result.source.index,\n      });\n      const cardDroppedJson = (this.props.playerHandData?.cards ?? [])[\n        result.source.index\n      ];\n      this.props.droppedOnTable(cardDroppedJson.jsonId);\n    } else {\n      this.props.reorderPlayerHand({\n        playerNumber: this.props.playerNumber,\n        sourceIndex: result.source.index,\n        destinationIndex: result.destination.index,\n      });\n      this.props.droppedBackInHand();\n    }\n\n    this.props.stopDraggingCardFromHand();\n  }\n\n  // Normally you would want to split things out into separate components.\n  // But in this example everything is just done in one place for simplicity\n  render() {\n    const cards = this.props.playerHandData?.cards ?? [];\n    return (\n      <div>\n        {this.renderTopLayer()}\n        {this.state.showMenu && (\n          <ContextMenu\n            anchorEl={this.state.anchorEl}\n            items={[\n              {\n                label: \"Drop random card\",\n                action: (wasTouch) => {\n                  if (cards.length > 0) {\n                    const randIndex = Math.floor(Math.random() * cards.length);\n                    const cardDetails = cards[randIndex];\n                    this.props.removeFromPlayerHand({\n                      playerNumber: this.props.playerNumber,\n                      index: randIndex,\n                    });\n\n                    const dropPos = wasTouch ? { x: 100, y: 100 } : undefined;\n\n                    this.props.droppedOnTable(cardDetails.jsonId, dropPos);\n                  }\n                },\n              },\n            ]}\n            hideContextMenu={() => {\n              this.setState({ anchorEl: undefined, showMenu: false });\n            }}\n          ></ContextMenu>\n        )}\n        <DragDropContext\n          onDragEnd={this.onDragEnd}\n          onBeforeCapture={this.onDragStart}\n        >\n          <Droppable droppableId=\"droppable\" direction=\"horizontal\">\n            {(provided, snapshot) => (\n              <div\n                id={playerHandElementId}\n                onClick={this.props.clearPreviewCardJsonId}\n                ref={provided.innerRef}\n                style={getListStyle(snapshot.isDraggingOver)}\n                {...provided.droppableProps}\n              >\n                <IconButton\n                  onClick={(event) => {\n                    this.setState({\n                      showMenu: true,\n                      anchorEl: event.nativeEvent.target as HTMLElement,\n                    });\n                  }}\n                  className=\"options-menu-button\"\n                >\n                  <MoreVertIcon fontSize=\"large\" />\n                </IconButton>\n                {cards.map((card, index) => (\n                  <Draggable\n                    key={`player-hand-${this.props.playerNumber}-${index}`}\n                    draggableId={`player-hand-${this.props.playerNumber}-${index}`}\n                    index={index}\n                  >\n                    {(provided, snapshot) => (\n                      <div\n                        onPointerEnter={(event) => {\n                          if (event.pointerType === \"mouse\") {\n                            this.props.setPreviewCardJsonId(card.jsonId);\n                          }\n                        }}\n                        onPointerLeave={this.props.clearPreviewCardJsonId}\n                        onClick={(event) => {\n                          if (\n                            (event.nativeEvent as PointerEvent).pointerType ===\n                            \"touch\"\n                          ) {\n                            if (!this.tapped) {\n                              //if tap is not set, set up single tap\n                              this.tapped = setTimeout(() => {\n                                this.tapped = null;\n                              }, 200); //wait 200ms then run single click code\n                            } else {\n                              //tapped within 200ms of last tap. double tap\n                              clearTimeout(this.tapped); //stop single tap callback\n                              this.tapped = null;\n                              this.setState({ modal: true });\n                              this.props.setPreviewCardJsonId(card.jsonId);\n                            }\n                            event.preventDefault();\n                            event.stopPropagation();\n                          }\n                        }}\n                        className=\"player-hand-card\"\n                        ref={provided.innerRef}\n                        {...provided.draggableProps}\n                        {...provided.dragHandleProps}\n                        style={getItemStyle(\n                          snapshot,\n                          provided.draggableProps.style\n                        )}\n                      >\n                        {this.renderCardContents(card)}\n                      </div>\n                    )}\n                  </Draggable>\n                ))}\n                {provided.placeholder}\n              </div>\n            )}\n          </Droppable>\n          {this.renderDroppableIfDragging()}\n        </DragDropContext>\n      </div>\n    );\n  }\n\n  renderTopLayer() {\n    return this.state.modal ? (\n      <TopLayer\n        position={{ x: 0, y: 0 }}\n        completed={() => {\n          this.props.clearPreviewCardJsonId();\n          this.setState({\n            modal: false,\n          });\n        }}\n      ></TopLayer>\n    ) : null;\n  }\n\n  renderCardContents(card: ICardDetails) {\n    const imgs = getImgUrls(\n      makeFakeCardStackFromJsonId(card.jsonId),\n      this.props.cardData,\n      this.props.currentGameType ?? GameType.MarvelChampions\n    );\n\n    // Only want to show the first image if multiple are loaded\n    const imgsWithData = imgs.map((i) => ({\n      url: i,\n      status: this.state.imgUrlToStatusMap[i],\n    }));\n    const loadedImgs = imgsWithData.filter(\n      (iData) => iData.status === ImageLoadingStatus.Loaded\n    );\n    const firstLoadedImage = loadedImgs.length > 0 ? loadedImgs[0].url : null;\n\n    return imgs.map((i, index) => {\n      return (\n        <img\n          key={`card-${card.jsonId}-img-${index}`}\n          className={i !== firstLoadedImage ? \"hide-img\" : \"show-img\"}\n          onLoad={() => {\n            this.setState({\n              imgUrlToStatusMap: {\n                ...this.state.imgUrlToStatusMap,\n                [i]: ImageLoadingStatus.Loaded,\n              },\n            });\n          }}\n          onError={() => {\n            this.setState({\n              imgUrlToStatusMap: {\n                ...this.state.imgUrlToStatusMap,\n                [i]: ImageLoadingStatus.LoadingFailed,\n              },\n            });\n          }}\n          alt=\"card\"\n          src={i}\n        ></img>\n      );\n    });\n  }\n\n  renderDroppableIfDragging() {\n    return true ? (\n      <Droppable droppableId=\"droppable-while-dragging\" direction=\"horizontal\">\n        {(provided, snapshot) => (\n          <div\n            className=\"card-dropzone\"\n            ref={provided.innerRef}\n            style={getListStyle2(snapshot.isDraggingOver, this.props.dragging)}\n            {...provided.droppableProps}\n          >\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    ) : null;\n  }\n}\nexport default PlayerHand;\n","import { Component } from \"react\";\nimport * as React from \"react\";\nimport { ICardStack } from \"./features/cards/initialState\";\nimport { Rect, Text } from \"react-konva\";\nimport { cardConstants } from \"./constants/card-constants\";\nimport { GameType } from \"./constants/app-constants\";\nimport { GamePropertiesMap } from \"./constants/game-type-properties-mapping\";\ninterface IProps {\n  currentGameType: GameType;\n  x: number;\n  y: number;\n  card: ICardStack | undefined;\n}\n\ninterface IState {\n  imagesLoaded: {\n    damage: boolean;\n    threat: boolean;\n    generic: boolean;\n  };\n}\n\nconst desiredWidth = 47;\nconst desiredHeight = 47;\n\nclass CardTokens extends Component<IProps, IState> {\n  private damageImg: HTMLImageElement;\n  private threatImg: HTMLImageElement;\n  private genericImg: HTMLImageElement;\n  private unmounted: boolean;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.unmounted = true;\n\n    this.state = {\n      imagesLoaded: {\n        damage: false,\n        threat: false,\n        generic: false,\n      },\n    };\n\n    this.damageImg = new Image();\n    this.threatImg = new Image();\n    this.genericImg = new Image();\n\n    const tokenInfo = GamePropertiesMap[this.props.currentGameType].tokens;\n\n    // DAMAGE\n    this.damageImg.onload = () => {\n      if (!this.unmounted) {\n        this.setState({\n          imagesLoaded: {\n            damage: true,\n            threat: this.state.imagesLoaded.threat,\n            generic: this.state.imagesLoaded.generic,\n          },\n        });\n      }\n    };\n\n    if (!!this.props.card?.counterTokens.damage && !!tokenInfo.damage) {\n      this.damageImg.src = tokenInfo.damage.imagePath;\n    }\n\n    // THREAT\n    this.threatImg.onload = () => {\n      if (!this.unmounted) {\n        this.setState({\n          imagesLoaded: {\n            damage: this.state.imagesLoaded.damage,\n            threat: true,\n            generic: this.state.imagesLoaded.generic,\n          },\n        });\n      }\n    };\n\n    if (!!this.props.card?.counterTokens.threat && !!tokenInfo.threat) {\n      this.threatImg.src = tokenInfo.threat.imagePath;\n    }\n\n    // GENERIC\n    this.genericImg.onload = () => {\n      if (!this.unmounted) {\n        this.setState({\n          imagesLoaded: {\n            damage: this.state.imagesLoaded.damage,\n            threat: this.state.imagesLoaded.threat,\n            generic: true,\n          },\n        });\n      }\n    };\n\n    if (!!this.props.card?.counterTokens.generic && !!tokenInfo.generic) {\n      this.genericImg.src = tokenInfo.generic.imagePath;\n    }\n  }\n\n  public componentDidUpdate(prevProps: IProps, prevState: IState) {\n    const tokenInfo = GamePropertiesMap[this.props.currentGameType].tokens;\n\n    // DAMAGE\n    if (\n      !this.state.imagesLoaded.damage &&\n      !prevProps.card?.counterTokens.damage &&\n      !!this.props.card?.counterTokens.damage &&\n      !!tokenInfo.damage\n    ) {\n      this.damageImg.src = tokenInfo.damage.imagePath;\n    }\n\n    // THREAT\n    if (\n      !this.state.imagesLoaded.threat &&\n      !prevProps.card?.counterTokens.threat &&\n      !!this.props.card?.counterTokens.threat &&\n      !!tokenInfo.threat\n    ) {\n      this.threatImg.src = tokenInfo.threat.imagePath;\n    }\n\n    // GENERIC\n    if (\n      !this.state.imagesLoaded.generic &&\n      !prevProps.card?.counterTokens.generic &&\n      !!this.props.card?.counterTokens.generic &&\n      !!tokenInfo.generic\n    ) {\n      this.genericImg.src = tokenInfo.generic.imagePath;\n    }\n  }\n\n  public componentDidMount() {\n    this.unmounted = false;\n  }\n\n  public componentWillUnmount() {\n    this.unmounted = true;\n  }\n\n  render() {\n    if (!this.props.card) return null;\n\n    const damageX = this.props.x - desiredWidth / 2;\n    const damageY = this.props.y - cardConstants.CARD_HEIGHT / 2 + 20;\n    const showDamage =\n      this.state.imagesLoaded.damage && !!this.props.card.counterTokens.damage;\n\n    const damageToken = showDamage ? (\n      <Rect\n        key={`${this.props.card.id}-damageToken`}\n        x={damageX}\n        y={damageY}\n        scale={{\n          x: desiredWidth / this.damageImg.naturalWidth,\n          y: desiredHeight / this.damageImg.naturalHeight,\n        }}\n        width={this.damageImg.naturalWidth}\n        height={this.damageImg.naturalHeight}\n        fillPatternImage={this.damageImg}\n      ></Rect>\n    ) : null;\n\n    const damageText = showDamage ? (\n      <Text\n        key={`${this.props.card.id}-damageText`}\n        x={damageX}\n        y={damageY}\n        width={\n          this.damageImg.naturalWidth *\n          (desiredWidth / this.damageImg.naturalWidth)\n        }\n        height={\n          this.damageImg.naturalHeight *\n          (desiredHeight / this.damageImg.naturalHeight)\n        }\n        text={`${this.props.card.counterTokens.damage}`}\n        fill=\"white\"\n        align=\"center\"\n        verticalAlign=\"middle\"\n        fontSize={24}\n      ></Text>\n    ) : null;\n\n    const threatX = this.props.x - desiredWidth / 2;\n    const threatY = damageY + desiredHeight + 5;\n    const showThreat =\n      this.state.imagesLoaded.threat && !!this.props.card.counterTokens.threat;\n\n    const threatToken = showThreat ? (\n      <Rect\n        key={`${this.props.card.id}-threatToken`}\n        x={threatX}\n        y={threatY}\n        scale={{\n          x: desiredWidth / this.threatImg.naturalWidth,\n          y: desiredHeight / this.threatImg.naturalHeight,\n        }}\n        width={this.threatImg.naturalWidth}\n        height={this.threatImg.naturalHeight}\n        fillPatternImage={this.threatImg}\n      ></Rect>\n    ) : null;\n\n    const threatText = showThreat ? (\n      <Text\n        key={`${this.props.card.id}-threatText`}\n        x={threatX}\n        y={threatY}\n        width={\n          this.threatImg.naturalWidth *\n          (desiredWidth / this.threatImg.naturalWidth)\n        }\n        height={\n          this.threatImg.naturalHeight *\n          (desiredHeight / this.threatImg.naturalHeight)\n        }\n        text={`${this.props.card.counterTokens.threat}`}\n        fill=\"white\"\n        align=\"center\"\n        verticalAlign=\"middle\"\n        fontSize={24}\n      ></Text>\n    ) : null;\n\n    const genericX = this.props.x - desiredWidth / 2;\n    const genericY = threatY + desiredHeight + 5;\n    const showGeneric =\n      this.state.imagesLoaded.generic &&\n      !!this.props.card.counterTokens.generic;\n\n    const genericToken = showGeneric ? (\n      <Rect\n        key={`${this.props.card.id}-genericToken`}\n        x={genericX}\n        y={genericY}\n        scale={{\n          x: desiredWidth / this.genericImg.naturalWidth,\n          y: desiredHeight / this.genericImg.naturalHeight,\n        }}\n        width={this.genericImg.naturalWidth}\n        height={this.genericImg.naturalHeight}\n        fillPatternImage={this.genericImg}\n      ></Rect>\n    ) : null;\n\n    const genericText = showGeneric ? (\n      <Text\n        key={`${this.props.card.id}-genericText`}\n        x={genericX}\n        y={genericY}\n        width={\n          this.genericImg.naturalWidth *\n          (desiredWidth / this.genericImg.naturalWidth)\n        }\n        height={\n          this.genericImg.naturalHeight *\n          (desiredHeight / this.genericImg.naturalHeight)\n        }\n        text={`${this.props.card.counterTokens.generic}`}\n        fill=\"white\"\n        align=\"center\"\n        verticalAlign=\"middle\"\n        fontSize={24}\n      ></Text>\n    ) : null;\n\n    return [\n      damageToken,\n      damageText,\n      threatToken,\n      threatText,\n      genericToken,\n      genericText,\n    ];\n  }\n}\n\nexport default CardTokens;\n","import { connect } from \"react-redux\";\n\nimport { RootState } from \"./store/rootReducer\";\nimport CardTokens from \"./CardTokens\";\nimport { getCardMapById } from \"./features/cards/cards.selectors\";\n\nexport interface IProps {\n  id: string;\n}\n\nconst mapStateToProps = (state: RootState, props: IProps) => {\n  return {\n    card: getCardMapById(state)[props.id],\n  };\n};\n\nconst CardTokensContainer = connect(mapStateToProps, {})(CardTokens);\n\nexport default CardTokensContainer;\n","export const CARD_ALREADY_ROTATED_MAP: { [key: string]: boolean } = {\n  \"05026\": true,\n};\n\nexport const MISSING_CARD_IMAGE_MAP: { [key: string]: string } = {\n  \"02001a\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"8665869b-fae4-494e-91d1-1e8c308220c2\" +\n    \".jpg\",\n\n  \"02001b\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"8665869b-fae4-494e-91d1-1e8c308220c2\" +\n    \".b.jpg\",\n\n  \"02002a\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"cfd051be-4ade-4cf8-b575-4b673cfa9a92\" +\n    \".jpg\",\n\n  \"02002b\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"cfd051be-4ade-4cf8-b575-4b673cfa9a92\" +\n    \".b.jpg\",\n\n  \"02003a\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"b16187a4-3f29-4a4b-8b66-6e8c7524c402\" +\n    \".jpg\",\n\n  \"02003b\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"b16187a4-3f29-4a4b-8b66-6e8c7524c402\" +\n    \".b.jpg\",\n\n  \"02004\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"b35084d9-3a2b-418c-b1a4-e4929de16a2c\" +\n    \".jpg\",\n\n  \"02004_double_sided_back\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"b35084d9-3a2b-418c-b1a4-e4929de16a2c\" +\n    \".b.jpg\",\n\n  \"02005\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"1eae757a-25b2-4b29-a8e7-f43b12c531b0\" +\n    \".jpg\",\n\n  \"02005_double_sided_back\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"1eae757a-25b2-4b29-a8e7-f43b12c531b0\" +\n    \".b.jpg\",\n\n  \"02006a\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"0a59161d-7db6-4328-9eeb-1906ce8715a5\" +\n    \".jpg\",\n\n  \"02006b\":\n    process.env.PUBLIC_URL +\n    \"/images/cards/\" +\n    \"0a59161d-7db6-4328-9eeb-1906ce8715a5\" +\n    \".b.jpg\",\n\n  \"02017\": \"https://hallofheroeshome.files.wordpress.com/2019/12/mutagen4a.jpg\",\n  \"02017_double_sided_back\":\n    \"https://hallofheroeshome.files.wordpress.com/2019/12/mutagen4b.jpg\",\n\n  \"02018\": \"https://hallofheroeshome.files.wordpress.com/2019/12/mutagen5a.jpg\",\n  \"02018_double_sided_back\":\n    \"https://hallofheroeshome.files.wordpress.com/2019/12/mutagen5b.jpg\",\n\n  \"12020\": \"https://lcgcdn.s3.amazonaws.com/mc/MC13en_20.jpg\",\n\n  // Scarlet Witch Cards\n  \"15001a\": \"https://marvelcdb.com/bundles/cards/15001a.png\",\n  \"15001b\": \"https://marvelcdb.com/bundles/cards/15001b.png\",\n  \"15002\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s1.jpg?w=300\",\n  \"15003\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s2.jpg?w=300\",\n  \"15004\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s6.jpg?w=300\",\n  \"15005\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s7.jpg?w=300\",\n  \"15006\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s10.jpg?w=300\",\n  \"15007\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s11.jpg?w=300\",\n  \"15008\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s12.jpg?w=300\",\n  \"15009\": \"https://hallofheroeshome.files.wordpress.com/2021/03/s15.jpg?w=300\",\n  \"15010\": \"https://hallofheroeshome.files.wordpress.com/2021/03/w1.jpg?w=300\",\n  \"15011\": \"https://hallofheroeshome.files.wordpress.com/2021/03/w2.jpg?w=300\",\n  \"15012\": \"https://hallofheroeshome.files.wordpress.com/2021/03/w3.jpg?w=300\",\n  \"15013\": \"https://hallofheroeshome.files.wordpress.com/2021/03/w4.jpg?w=300\",\n  \"15014\": \"https://hallofheroeshome.files.wordpress.com/2021/03/w5.jpg?w=300\",\n  \"15015\": \"https://hallofheroeshome.files.wordpress.com/2021/03/w6.jpg?w=300\",\n  \"15019\": \"https://hallofheroeshome.files.wordpress.com/2021/03/w10.jpg?w=300\",\n  \"15023\": \"https://hallofheroeshome.files.wordpress.com/2021/03/n2.jpg?w=300\",\n  \"15024\": \"https://hallofheroeshome.files.wordpress.com/2021/03/n3.jpg?w=300\",\n  \"15025\": \"https://hallofheroeshome.files.wordpress.com/2021/03/n4.jpg?w=300\",\n  \"15026\": \"https://hallofheroeshome.files.wordpress.com/2021/03/n5.jpg?w=300\",\n  \"15027\": \"https://hallofheroeshome.files.wordpress.com/2021/03/n6.jpg?w=300\",\n  \"15028\": \"https://hallofheroeshome.files.wordpress.com/2021/03/z1.jpg?w=300\",\n  \"15029\": \"https://hallofheroeshome.files.wordpress.com/2021/03/z2.jpg?w=300\",\n  \"15030\": \"https://hallofheroeshome.files.wordpress.com/2021/03/z3.jpg?w=300\",\n  \"15031\": \"https://hallofheroeshome.files.wordpress.com/2021/03/z4.jpg?w=300\",\n\n  // Groot Cards\n  \"16001a\": \"https://marvelcdb.com/bundles/cards/16001a.png\",\n  \"16001b\": \"https://marvelcdb.com/bundles/cards/16001b.png\",\n  \"16002\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g1.jpg?w=300\",\n  \"16003\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g3.jpg?w=300\",\n  \"16004\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g5.jpg?w=300\",\n  \"16005\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g7.jpg?w=300\",\n  \"16006\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g10.jpg?w=300\",\n  \"16007\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g11.jpg?w=300\",\n  \"16008\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g12.jpg?w=300\",\n  \"16009\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g13.jpg?w=300\",\n  \"16010\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g14.jpg?w=300\",\n  \"16011\": \"https://hallofheroeshome.files.wordpress.com/2021/04/g15.jpg?w=300\",\n  \"16012\": \"https://hallofheroeshome.files.wordpress.com/2021/04/z1.jpg?w=300\",\n  \"16014\": \"https://hallofheroeshome.files.wordpress.com/2021/04/z3.jpg?w=300\",\n  \"16016\": \"https://hallofheroeshome.files.wordpress.com/2021/04/z5.jpg?w=300\",\n  \"16017\": \"https://hallofheroeshome.files.wordpress.com/2021/04/z6.jpg?w=300\",\n  \"16019\": \"https://hallofheroeshome.files.wordpress.com/2021/04/z8.jpg?w=300\",\n  \"16020\": \"https://hallofheroeshome.files.wordpress.com/2021/04/z9.jpg?w=300\",\n  \"16024\": \"https://hallofheroeshome.files.wordpress.com/2021/04/z13.jpg?w=300\",\n  \"16025\": \"https://hallofheroeshome.files.wordpress.com/2021/04/n1.jpg?w=300\",\n  \"16026\": \"https://hallofheroeshome.files.wordpress.com/2021/04/n2.jpg?w=300\",\n  \"16027\": \"https://hallofheroeshome.files.wordpress.com/2021/04/n3.jpg?w=300\",\n  \"16028\": \"https://hallofheroeshome.files.wordpress.com/2021/04/n4.jpg?w=300\",\n\n  // Rocket Cards\n  \"16029a\": \"https://marvelcdb.com/bundles/cards/16029a.png\",\n  \"16029b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/r0a.jpg?w=300\",\n  \"16030\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r1.jpg?w=300\",\n  \"16031\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r3.jpg?w=300\",\n  \"16032\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r5.jpg?w=300\",\n  \"16033\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r6.jpg?w=300\",\n  \"16034\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r8.jpg?w=300\",\n  \"16035\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r10.jpg?w=300\",\n  \"16036\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r11.jpg?w=300\",\n  \"16037\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r12.jpg?w=300\",\n  \"16038\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r13.jpg?w=300\",\n  \"16039\": \"https://hallofheroeshome.files.wordpress.com/2021/04/r15.jpg?w=300\",\n  \"16040\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/z1-1.jpg?w=300\",\n  \"16043\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/z4-1.jpg?w=300\",\n  \"16045\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/z6-1.jpg?w=300\",\n  \"16046\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/z7-1.jpg?w=300\",\n  \"16047\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/z8-1.jpg?w=300\",\n  \"16048\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/z9-1.jpg?w=300\",\n  \"16052\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/z13-1.jpg?w=300\",\n  \"16053\": \"https://hallofheroeshome.files.wordpress.com/2021/04/n0.jpg?w=300\",\n  \"16054\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/n1-1.jpg?w=300\",\n  \"16055\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/n2-1.jpg?w=300\",\n  \"16056\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/n3-1.jpg?w=300\",\n  \"16057\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/n4-1.jpg?w=300\",\n\n  // Brotherhood of Badoon\n  \"16058\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d1.jpg?w=300\",\n  \"16059\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d2.jpg?w=300\",\n  \"16060\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d3.jpg?w=300\",\n  \"16061\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d4a.jpg?w=300\",\n  \"16061a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/d4a.jpg?w=300\",\n  \"16061_double_sided_back\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/d4b.jpg?w=300\",\n  \"16061b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/d4b.jpg?w=300\",\n  \"16062\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d5a.jpg?w=300\",\n  \"16062a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/d5a.jpg?w=300\",\n  \"16062_double_sided_back\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/d5b.jpg?w=300\",\n  \"16062b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/04/d5b.jpg?w=300\",\n  \"16063\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d6.jpg?w=300\",\n  \"16064\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d7.jpg?w=300\",\n  \"16065\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d8.jpg?w=300\",\n  \"16066\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d10.jpg?w=300\",\n  \"16067\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d11.jpg?w=300\",\n  \"16068\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d12.jpg?w=300\",\n  \"16069\": \"https://hallofheroeshome.files.wordpress.com/2021/04/d13.jpg?w=300\",\n\n  // Band of Badoon\n  \"16117\": \"https://hallofheroeshome.files.wordpress.com/2021/04/bb1.jpg?w=300\",\n  \"16118\": \"https://hallofheroeshome.files.wordpress.com/2021/04/bb3.jpg?w=300\",\n  \"16119\": \"https://hallofheroeshome.files.wordpress.com/2021/04/bb6.jpg?w=300\",\n  \"16120\": \"https://hallofheroeshome.files.wordpress.com/2021/04/bb7.jpg?w=300\",\n  \"16121\": \"https://hallofheroeshome.files.wordpress.com/2021/04/bb9.jpg?w=300\",\n\n  // Ship Command\n  \"16142\": \"https://hallofheroeshome.files.wordpress.com/2021/04/sc1.jpg?w=300\",\n  \"16143\": \"https://hallofheroeshome.files.wordpress.com/2021/04/sc2.jpg?w=300\",\n  \"16144\": \"https://hallofheroeshome.files.wordpress.com/2021/04/sc3.jpg?w=300\",\n  \"16145\": \"https://hallofheroeshome.files.wordpress.com/2021/04/sc4.jpg?w=300\",\n  \"16146\": \"https://hallofheroeshome.files.wordpress.com/2021/04/sc5.jpg?w=300\",\n  \"16147\": \"https://hallofheroeshome.files.wordpress.com/2021/04/sc6.jpg?w=300\",\n  \"16148\": \"https://hallofheroeshome.files.wordpress.com/2021/04/sc7.jpg?w=300\",\n\n  // Star-Lord\n  \"17001a\": \"https://marvelcdb.com/bundles/cards/17001a.png\",\n  \"17001b\": \"https://marvelcdb.com/bundles/cards/17001b.png\",\n  \"17002\": \"https://hallofheroeshome.files.wordpress.com/2021/05/1-1.jpg?w=300\",\n  \"17003\": \"https://hallofheroeshome.files.wordpress.com/2021/05/2-1.jpg?w=300\",\n  \"17004\": \"https://hallofheroeshome.files.wordpress.com/2021/05/5.jpg?w=300\",\n  \"17005\": \"https://hallofheroeshome.files.wordpress.com/2021/05/7.jpg?w=300\",\n  \"17006\": \"https://hallofheroeshome.files.wordpress.com/2021/05/10.jpg?w=300\",\n  \"17007\": \"https://hallofheroeshome.files.wordpress.com/2021/05/11.jpg?w=300\",\n  \"17008\": \"https://hallofheroeshome.files.wordpress.com/2021/05/13.jpg?w=300\",\n  \"17009\": \"https://hallofheroeshome.files.wordpress.com/2021/05/14.jpg?w=300\",\n  \"17010\": \"https://hallofheroeshome.files.wordpress.com/2021/05/15.jpg?w=300\",\n  \"17011\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a1.jpg?w=300\",\n  \"17012\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a2.jpg?w=300\",\n  \"17013\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a3.jpg?w=300\",\n  \"17014\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a4.jpg?w=300\",\n  \"17015\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a5.jpg?w=300\",\n  \"17017\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a7.jpg?w=300\",\n  \"17019\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a9.jpg?w=300\",\n  \"17020\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a10.jpg?w=300\",\n  \"17021\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a11.jpg?w=300\",\n  \"17022\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a12.jpg?w=300\",\n  \"17023\": \"https://hallofheroeshome.files.wordpress.com/2021/05/a13.jpg?w=300\",\n  \"17024\": \"https://hallofheroeshome.files.wordpress.com/2021/05/o0.jpg?w=300\",\n  \"17025\": \"https://hallofheroeshome.files.wordpress.com/2021/05/o1.jpg?w=300\",\n  \"17026\": \"https://hallofheroeshome.files.wordpress.com/2021/05/o2.jpg?w=300\",\n  \"17027\": \"https://hallofheroeshome.files.wordpress.com/2021/05/o3.jpg?w=300\",\n  \"17028\": \"https://hallofheroeshome.files.wordpress.com/2021/05/bb1.jpg?w=300\",\n  \"17029\": \"https://hallofheroeshome.files.wordpress.com/2021/05/bb2.jpg?w=300\",\n  \"17030\": \"https://hallofheroeshome.files.wordpress.com/2021/05/bb3.jpg?w=300\",\n\n  // Gamora\n  \"18001a\": \"https://marvelcdb.com/bundles/cards/18001a.png\",\n  \"18001b\": \"https://marvelcdb.com/bundles/cards/18001b.png\",\n  \"18002\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g1-1.jpg?w=300\",\n  \"18003\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g2-1.jpg?w=300\",\n  \"18004\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g4-1.jpg?w=300\",\n  \"18005\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g6-1.jpg?w=300\",\n  \"18006\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g8-1.jpg?w=300\",\n  \"18007\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g10-1.jpg?w=300\",\n  \"18008\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g12-1.jpg?w=300\",\n  \"18009\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g13-1.jpg?w=300\",\n  \"18010\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/g15-1.jpg?w=300\",\n  \"18011\": \"https://hallofheroeshome.files.wordpress.com/2021/05/z0.png\",\n  \"18012\": \"https://hallofheroeshome.files.wordpress.com/2021/05/c1.jpg?w=300\",\n  \"18013\": \"https://hallofheroeshome.files.wordpress.com/2021/05/d1.jpg?w=300\",\n  \"18015\": \"https://hallofheroeshome.files.wordpress.com/2021/05/f1.jpg?w=300\",\n  \"18016\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/i111.jpg?w=300\",\n  \"18018\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/aaa1.jpg?w=300\",\n  \"18019\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/gamora-spoilers-41024_1.jpg?w=300\",\n  \"18020\": \"https://hallofheroeshome.files.wordpress.com/2021/05/h1.jpg?w=300\",\n  \"18024\": \"https://hallofheroeshome.files.wordpress.com/2021/05/n1.jpg?w=300\",\n  \"18025\": \"https://hallofheroeshome.files.wordpress.com/2021/05/s1.jpg?w=300\",\n  \"18026\": \"https://hallofheroeshome.files.wordpress.com/2021/05/n3.jpg?w=300\",\n  \"18027\": \"https://hallofheroeshome.files.wordpress.com/2021/05/n4.jpg?w=300\",\n  \"18028\": \"https://hallofheroeshome.files.wordpress.com/2021/05/n5.jpg?w=300\",\n  \"18029\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/zzz1.jpg?w=300\",\n  \"18030\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/zzz2.jpg?w=300\",\n  \"18031\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/05/zzz3.jpg?w=300\",\n\n  // Drax\n  \"19001a\": \"https://marvelcdb.com/bundles/cards/19001a.png\",\n  \"19001b\": \"https://marvelcdb.com/bundles/cards/19001b.png\",\n  \"19002\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d1.jpg?w=300\",\n  \"19003\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d2.jpg?w=300\",\n  \"19004\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d4.jpg?w=300\",\n  \"19005\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d6.jpg?w=300\",\n  \"19006\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d8.jpg?w=300\",\n  \"19007\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d10.jpg?w=300\",\n  \"19008\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d12.jpg?w=300\",\n  \"19009\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d13.jpg?w=300\",\n  \"19010\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d14.jpg?w=300\",\n  \"19011\": \"https://hallofheroeshome.files.wordpress.com/2021/06/d15.jpg?w=300\",\n  \"19012\": \"https://hallofheroeshome.files.wordpress.com/2021/06/z1.jpg?w=300\",\n  \"19013\": \"https://hallofheroeshome.files.wordpress.com/2021/06/z2.jpg?w=300\",\n  \"19015\": \"https://hallofheroeshome.files.wordpress.com/2021/06/z4.jpg?w=300\",\n  \"19016\": \"https://hallofheroeshome.files.wordpress.com/2021/06/z5.jpg?w=300\",\n  \"19017\": \"https://hallofheroeshome.files.wordpress.com/2021/06/z6.jpg?w=300\",\n  \"19018\": \"https://hallofheroeshome.files.wordpress.com/2021/06/z7.jpg?w=300\",\n  \"19020\": \"https://hallofheroeshome.files.wordpress.com/2021/06/z9.jpg?w=300\",\n  \"19025\": \"https://hallofheroeshome.files.wordpress.com/2021/06/n1.jpg?w=300\",\n  \"19026\": \"https://hallofheroeshome.files.wordpress.com/2021/06/n2.jpg?w=300\",\n  \"19027\": \"https://hallofheroeshome.files.wordpress.com/2021/06/n3.jpg?w=300\",\n  \"19028\": \"https://hallofheroeshome.files.wordpress.com/2021/06/n4.jpg?w=300\",\n  \"19029\": \"https://hallofheroeshome.files.wordpress.com/2021/06/n5.jpg?w=300\",\n  \"19030\": \"https://hallofheroeshome.files.wordpress.com/2021/06/zz1.jpg?w=300\",\n  \"19031\": \"https://hallofheroeshome.files.wordpress.com/2021/06/zz2.jpg?w=300\",\n  \"19032\": \"https://hallofheroeshome.files.wordpress.com/2021/06/zz3.jpg?w=300\",\n\n  // Venom\n  \"20001a\": \"https://marvelcdb.com/bundles/cards/20001a.png\",\n  \"20001b\": \"https://marvelcdb.com/bundles/cards/20001b.png\",\n  \"20002\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v1.jpg?w=300\",\n  \"20003\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v3.jpg?w=300\",\n  \"20004\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v5.jpg?w=300\",\n  \"20005\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v6.jpg?w=300\",\n  \"20006\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v9.jpg?w=300\",\n  \"20007\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v11.jpg?w=300\",\n  \"20008\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v12.jpg?w=300\",\n  \"20009\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v13.jpg?w=300\",\n  \"20010\": \"https://hallofheroeshome.files.wordpress.com/2021/07/v14.jpg?w=300\",\n  \"20011\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j1.jpg?w=300\",\n  \"20012\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j2.jpg?w=300\",\n  \"20013\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j3.jpg?w=300\",\n  \"20014\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j4.jpg?w=300\",\n  \"20015\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j5.jpg?w=300\",\n  \"20016\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j6.jpg?w=300\",\n  \"20017\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j7.jpg?w=300\",\n  \"20018\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j8.jpg?w=300\",\n  \"20019\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j9.jpg?w=300\",\n  \"20020\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j10.jpg?w=300\",\n  \"20021\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j11.jpg?w=300\",\n  \"20022\": \"https://hallofheroeshome.files.wordpress.com/2021/07/j12.jpg?w=300\",\n  \"20023\": \"https://hallofheroeshome.files.wordpress.com/2021/07/n0.jpg?w=300\",\n  \"20024\": \"https://hallofheroeshome.files.wordpress.com/2021/07/n1.jpg?w=300\",\n  \"20025\": \"https://hallofheroeshome.files.wordpress.com/2021/07/n2.jpg?w=300\",\n  \"20026\": \"https://hallofheroeshome.files.wordpress.com/2021/07/z1.jpg?w=300\",\n  \"20027\": \"https://hallofheroeshome.files.wordpress.com/2021/07/z2.jpg?w=300\",\n  \"20028\": \"https://hallofheroeshome.files.wordpress.com/2021/07/z3.jpg?w=300\",\n  \"20029\": \"https://hallofheroeshome.files.wordpress.com/2021/07/z4.jpg?w=300\",\n\n  // Spectrum\n  \"21001a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/m0b.jpg?w=300\",\n  \"21001b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/m0a.jpg?w=300\",\n  \"21002\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m1.jpg?w=300\",\n  \"21003\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m2.jpg?w=300\",\n  \"21004\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m3.jpg?w=300\",\n  \"21005\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m4.jpg?w=300\",\n  \"21006\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m5.jpg?w=300\",\n  \"21007\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m7.jpg?w=300\",\n  \"21008\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m10.jpg?w=300\",\n  \"21009\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m13.jpg?w=300\",\n  \"21010\": \"https://hallofheroeshome.files.wordpress.com/2021/08/m16.jpg?w=300\",\n  \"21011\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a1.jpg?w=300\",\n  \"21012\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a2.jpg?w=300\",\n  \"21013\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a3.jpg?w=300\",\n  \"21014\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a4.jpg?w=300\",\n  \"21015\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a5.jpg?w=300\",\n  \"21016\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a6.jpg?w=300\",\n  \"21017\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a7.jpg?w=300\",\n  \"21018\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a8.jpg?w=300\",\n  \"21019\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a9.jpg?w=300\",\n  \"21020\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a10.jpg?w=300\",\n  \"21021\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a11.jpg?w=300\",\n  \"21022\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a12.jpg?w=300\",\n  \"21023\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a13.jpg?w=300\",\n  \"21024\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a14.jpg?w=300\",\n  \"21025\": \"https://hallofheroeshome.files.wordpress.com/2021/08/a15.jpg?w=300\",\n  \"21026\": \"https://hallofheroeshome.files.wordpress.com/2021/08/n00.jpg?w=300\",\n  \"21027\": \"https://hallofheroeshome.files.wordpress.com/2021/08/n2.jpg?w=300\",\n  \"21028\": \"https://hallofheroeshome.files.wordpress.com/2021/08/n3.jpg?w=300\",\n  \"21029\": \"https://hallofheroeshome.files.wordpress.com/2021/08/n5.jpg?w=300\",\n  \"21030\": \"https://hallofheroeshome.files.wordpress.com/2021/08/n6.jpg?w=300\",\n\n  //Adam Warlock\n  \"21031a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a0b.jpg?w=300\",\n  \"21031b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a0a.jpg?w=300\",\n  \"21032\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a1-1.jpg?w=300\",\n  \"21033\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a2-1.jpg?w=300\",\n  \"21034\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a3-1.jpg?w=300\",\n  \"21035\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a4-1.jpg?w=300\",\n  \"21036\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a5-1.jpg?w=300\",\n  \"21037\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a7-1.jpg?w=300\",\n  \"21038\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a9-1.jpg?w=300\",\n  \"21039\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a12-1.jpg?w=300\",\n  \"21040\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a14-1.jpg?w=300\",\n  \"21041\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b1.jpg?w=300\",\n  \"21042\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b2.jpg?w=300\",\n  \"21043\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b3.jpg?w=300\",\n  \"21044\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b4.jpg?w=300\",\n  \"21045\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b5.jpg?w=300\",\n  \"21046\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b6.jpg?w=300\",\n  \"21047\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b7.jpg?w=300\",\n  \"21048\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b8.jpg?w=300\",\n  \"21049\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b9.jpg?w=300\",\n  \"21050\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b10.jpg?w=300\",\n  \"21051\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b11.jpg?w=300\",\n  \"21052\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b12.jpg?w=300\",\n  \"21053\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b13.jpg?w=300\",\n  \"21054\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b14.jpg?w=300\",\n  \"21055\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b15.jpg?w=300\",\n  \"21056\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b16.jpg?w=300\",\n  \"21057\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b17.jpg?w=300\",\n  \"21058\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b18.jpg?w=300\",\n  \"21059\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b19.jpg?w=300\",\n  \"21060\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b20.jpg?w=300\",\n  \"21061\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b21.jpg?w=300\",\n  \"21062\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b22.jpg?w=300\",\n  \"21063\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b23.jpg?w=300\",\n  \"21064\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b24.jpg?w=300\",\n  \"21065\": \"https://hallofheroeshome.files.wordpress.com/2021/08/b25.jpg?w=300\",\n  \"21066\": \"https://hallofheroeshome.files.wordpress.com/2021/08/n0.jpg?w=300\",\n  \"21067\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/n1-1.jpg?w=300\",\n  \"21068\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/n2-1.jpg?w=300\",\n  \"21069\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/n3-1.jpg?w=300\",\n  \"21070\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/n5-1.jpg?w=300\",\n\n  // Ebony Maw\n  \"21071\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e1.jpg?w=300\",\n  \"21072\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e2.jpg?w=300\",\n  \"21073\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e3.jpg?w=300\",\n  \"21074a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/e4a.jpg?w=300\",\n  \"21074b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/e4b.jpg?w=300\",\n  \"21075a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/e5a.jpg?w=300\",\n  \"21075b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/e5b.jpg?w=300\",\n  \"21076\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e6.jpg?w=300\",\n  \"21077\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e8.jpg?w=300\",\n  \"21078\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e10.jpg?w=300\",\n  \"21079\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e12.jpg?w=300\",\n  \"21080\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e14.jpg?w=300\",\n  \"21081\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e16.jpg?w=300\",\n  \"21082\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e19.jpg?w=300\",\n  \"21083\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e20.jpg?w=300\",\n  \"21084\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e21.jpg?w=300\",\n\n  // Black Order\n  \"21085\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/b1-1.jpg?w=300\",\n  \"21086\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/b2-1.jpg?w=300\",\n  \"21087\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/b3-1.jpg?w=300\",\n  \"21088\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/b4-1.jpg?w=300\",\n\n  // Armies of Titan\n  \"21089\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a1-2.jpg?w=300\",\n  \"21090\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a3-2.jpg?w=300\",\n  \"21091\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/a5-2.jpg?w=300\",\n\n  // Tower Defense\n  \"21092\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t1.jpg?w=300\",\n  \"21093\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t2.jpg?w=300\",\n  \"21094\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t3.jpg?w=300\",\n  \"21095\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t4.jpg?w=300\",\n  \"21096\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t5.jpg?w=300\",\n  \"21097\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t6.jpg?w=300\",\n  \"21098a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t7a.jpg?w=300\",\n  \"21098b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t7b.jpg?w=300\",\n  \"21099a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t8a.jpg?w=300\",\n  \"21099b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t8b.jpg?w=300\",\n  \"21100a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t9a.jpg?w=300\",\n  \"21100b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t9b.jpg?w=300\",\n  \"21101\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t10.jpg?w=300\",\n  \"21102\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t11.jpg?w=300\",\n  \"21103\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t15.jpg?w=300\",\n  \"21104\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t16.jpg?w=300\",\n  \"21105\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t17.jpg?w=300\",\n  \"21106\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t19.jpg?w=300\",\n  \"21107\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t21.jpg?w=300\",\n  \"21108\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t23.jpg?w=300\",\n  \"21109\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t24.jpg?w=300\",\n  \"21110\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t26.jpg?w=300\",\n\n  // Thanos\n  \"21111\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t1-1.jpg?w=300\",\n  \"21112\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t2-1.jpg?w=300\",\n  \"21113\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t3-1.jpg?w=300\",\n  \"21114a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t4a.jpg?w=300\",\n  \"21114b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t4b.jpg?w=300\",\n  \"21115a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t5a.jpg?w=300\",\n  \"21115b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t5b.jpg?w=300\",\n  \"21116\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t6-1.jpg?w=300\",\n  \"21117\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t7.jpg?w=300\",\n  \"21118\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t8.jpg?w=300\",\n  \"21119\": \"https://hallofheroeshome.files.wordpress.com/2021/08/t9.jpg?w=300\",\n  \"21120\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t11-1.jpg?w=300\",\n  \"21121\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t13-1.jpg?w=300\",\n  \"21122\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t15-1.jpg?w=300\",\n  \"21123\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t17-1.jpg?w=300\",\n  \"21124\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/t19-1.jpg?w=300\",\n\n  // Children of Thanos\n  \"21125\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c1.jpg?w=300\",\n  \"21126\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c2-1.jpg?w=300\",\n  \"21127\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c3.jpg?w=300\",\n  \"21128\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c4-1.jpg?w=300\",\n\n  // Infinity Guantlet\n  \"21129\": \"https://hallofheroeshome.files.wordpress.com/2021/08/i1.jpg?w=300\",\n  \"21130\": \"https://hallofheroeshome.files.wordpress.com/2021/08/i2.jpg?w=300\",\n  \"21131\": \"https://hallofheroeshome.files.wordpress.com/2021/08/i3.jpg?w=300\",\n  \"21132\": \"https://hallofheroeshome.files.wordpress.com/2021/08/i4.jpg?w=300\",\n  \"21133\": \"https://hallofheroeshome.files.wordpress.com/2021/08/i5.jpg?w=300\",\n  \"21134\": \"https://hallofheroeshome.files.wordpress.com/2021/08/i6.jpg?w=300\",\n  \"21135\": \"https://hallofheroeshome.files.wordpress.com/2021/08/i7.jpg?w=300\",\n\n  // Hela\n  \"21136a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h1a.jpg?w=300\",\n  \"21136b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h1b.jpg?w=300\",\n  \"21137a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h2a.jpg?w=300\",\n  \"21137b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h2b.jpg?w=300\",\n  \"21138a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h3a.jpg?w=300\",\n  \"21138b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h3b.jpg?w=300\",\n  \"21139a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h4a.jpg?w=300\",\n  \"21139b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/h4b.jpg?w=300\",\n  \"21140\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h5.jpg?w=300\",\n  \"21141\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h6.jpg?w=300\",\n  \"21142\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h7.jpg?w=300\",\n  \"21143\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h8.jpg?w=300\",\n  \"21144\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h9.jpg?w=300\",\n  \"21145\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h10.jpg?w=300\",\n  \"21146\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h11.jpg?w=300\",\n  \"21147\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h12.jpg?w=300\",\n  \"21148\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h13.jpg?w=300\",\n  \"21149\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h14.jpg?w=300\",\n  \"21150\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h16.jpg?w=300\",\n  \"21151\": \"https://hallofheroeshome.files.wordpress.com/2021/08/h18.jpg?w=300\",\n\n  // Legions of Hel\n  \"21152\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/l1-1.jpg?w=300\",\n  \"21153\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/l3-1.jpg?w=300\",\n  \"21154\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/l5-1.jpg?w=300\",\n  \"21155\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l6.jpg?w=300\",\n\n  // Frost Giants\n  \"21156\": \"https://hallofheroeshome.files.wordpress.com/2021/08/f1.jpg?w=300\",\n  \"21157\": \"https://hallofheroeshome.files.wordpress.com/2021/08/f2.jpg?w=300\",\n  \"21158\": \"https://hallofheroeshome.files.wordpress.com/2021/08/f4.jpg?w=300\",\n  \"21159\": \"https://hallofheroeshome.files.wordpress.com/2021/08/f6.jpg?w=300\",\n\n  // Loki\n  \"21160\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l1.jpg?w=300\",\n  \"21161\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l2.jpg?w=300\",\n  \"21162\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l3.jpg?w=300\",\n  \"21163\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l4.jpg?w=300\",\n  \"21164\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l5.jpg?w=300\",\n  \"21165a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/l6a.jpg?w=300\",\n  \"21165b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/l6b.jpg?w=300\",\n  \"21166\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l7.jpg?w=300\",\n  \"21167\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l8.jpg?w=300\",\n  \"21168\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l9.jpg?w=300\",\n  \"21169\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l10.jpg?w=300\",\n  \"21170\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l11.jpg?w=300\",\n  \"21171\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l12.jpg?w=300\",\n  \"21172\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l13.jpg?w=300\",\n  \"21173\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l14.jpg?w=300\",\n  \"21174\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l15.jpg?w=300\",\n  \"21175\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l17.jpg?w=300\",\n  \"21176\": \"https://hallofheroeshome.files.wordpress.com/2021/08/l19.jpg?w=300\",\n\n  // Enchantress\n  \"21177\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/e1-1.jpg?w=300\",\n  \"21178\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/e2-1.jpg?w=300\",\n  \"21179\": \"https://hallofheroeshome.files.wordpress.com/2021/08/e4.jpg?w=300\",\n\n  // MTS Campaign\n  \"21180a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c1a.jpg?w=300\",\n  \"21180b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c1b.jpg?w=300\",\n  \"21181\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c2.jpg?w=300\",\n  \"21182a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c3a.jpg?w=300\",\n  \"21182b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c3b.jpg?w=300\",\n  \"21183\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c4.jpg?w=300\",\n  \"21184a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c8a.jpg?w=300\",\n  \"21184b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c8b.jpg?w=300\",\n  \"21185\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c9.jpg?w=300\",\n  \"21186a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c13a.jpg?w=300\",\n  \"21186b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c13b.jpg?w=300\",\n  \"21187a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c14a.jpg?w=300\",\n  \"21187b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c14b.jpg?w=300\",\n  \"21188\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c18.jpg?w=300\",\n  \"21189a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c19a.jpg?w=300\",\n  \"21189b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/08/c19b.jpg?w=300\",\n  \"21190\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c20.jpg?w=300\",\n  \"21191\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c21.jpg?w=300\",\n  \"21192\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c22.jpg?w=300\",\n  \"21193\": \"https://hallofheroeshome.files.wordpress.com/2021/08/c23.jpg?w=300\",\n\n  // Nebula Hero\n  \"22001a\": \"https://marvelcdb.com/bundles/cards/22001a.png\",\n  \"22001b\": \"https://marvelcdb.com/bundles/cards/22001b.png\",\n  \"22002\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n1.jpg?w=300\",\n  \"22003\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n2.jpg?w=300\",\n  \"22004\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n3.jpg?w=300\",\n  \"22005\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n5.jpg?w=300\",\n  \"22006\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n6.jpg?w=300\",\n  \"22007\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n7.jpg?w=300\",\n  \"22008\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n9.jpg?w=300\",\n  \"22009\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n11.jpg?w=300\",\n  \"22010\": \"https://hallofheroeshome.files.wordpress.com/2021/09/n13.jpg?w=300\",\n  \"22011\": \"https://hallofheroeshome.files.wordpress.com/2021/09/a1.jpg?w=300\",\n  \"22012\": \"https://hallofheroeshome.files.wordpress.com/2021/09/a2.jpg?w=300\",\n  \"22013\": \"https://hallofheroeshome.files.wordpress.com/2021/09/a3.jpg?w=300\",\n  \"22014\": \"https://hallofheroeshome.files.wordpress.com/2021/09/a4.jpg?w=300\",\n  \"22015\": \"https://hallofheroeshome.files.wordpress.com/2021/09/a5.jpg?w=300\",\n  \"22018\": \"https://hallofheroeshome.files.wordpress.com/2021/09/a8.jpg?w=300\",\n  \"22022\": \"https://hallofheroeshome.files.wordpress.com/2021/09/a12.jpg?w=300\",\n  \"22027\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e1.jpg?w=300\",\n  \"22028\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e2.jpg?w=300\",\n  \"22029\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e3.jpg?w=300\",\n  \"22030\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e4.jpg?w=300\",\n  \"22031\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e5.jpg?w=300\",\n  \"22032\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e7.jpg?w=300\",\n  \"22033\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e8.jpg?w=300\",\n  \"22034\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e9.jpg?w=300\",\n  \"22035\": \"https://hallofheroeshome.files.wordpress.com/2021/09/e10.jpg?w=300\",\n\n  // war machine\n  \"23001a\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/11/1-1.jpg?w=300\",\n  \"23001b\":\n    \"https://hallofheroeshome.files.wordpress.com/2021/11/2-1.jpg?w=300\",\n  \"23002\": \"https://hallofheroeshome.files.wordpress.com/2021/11/3.jpg?w=300\",\n  \"23003\": \"https://hallofheroeshome.files.wordpress.com/2021/11/4.jpg?w=300\",\n  \"23004\": \"https://hallofheroeshome.files.wordpress.com/2021/11/5.jpg?w=300\",\n  \"23005\": \"https://hallofheroeshome.files.wordpress.com/2021/11/6.jpg?w=300\",\n  \"23006\": \"https://hallofheroeshome.files.wordpress.com/2021/11/7.jpg?w=300\",\n  \"23007\": \"https://hallofheroeshome.files.wordpress.com/2021/11/8.jpg?w=300\",\n  \"23008\": \"https://hallofheroeshome.files.wordpress.com/2021/11/9.jpg?w=300\",\n  \"23009\": \"https://hallofheroeshome.files.wordpress.com/2021/11/10.jpg?w=300\",\n  \"23010\": \"https://hallofheroeshome.files.wordpress.com/2021/11/11.jpg?w=300\",\n  \"23011\": \"https://hallofheroeshome.files.wordpress.com/2021/11/12.jpg?w=300\",\n  \"23012\": \"https://hallofheroeshome.files.wordpress.com/2021/11/13.jpg?w=300\",\n  \"23013\": \"https://hallofheroeshome.files.wordpress.com/2021/11/14.jpg?w=300\",\n  \"23016\": \"https://hallofheroeshome.files.wordpress.com/2021/11/17.jpg?w=300\",\n  \"23017\": \"https://hallofheroeshome.files.wordpress.com/2021/11/18.jpg?w=300\",\n  \"23018\": \"https://hallofheroeshome.files.wordpress.com/2021/11/19.jpg?w=300\",\n  \"23019\": \"https://hallofheroeshome.files.wordpress.com/2021/11/20.jpg?w=300\",\n  \"23024\": \"https://hallofheroeshome.files.wordpress.com/2021/11/25.jpg?w=300\",\n  \"23028\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a1.jpg?w=300\",\n  \"23029\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a2.jpg?w=300\",\n  \"23030\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a3.jpg?w=300\",\n  \"23031\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a4.jpg?w=300\",\n  \"23032\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a5.jpg?w=300\",\n  \"23033\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a6.jpg?w=300\",\n  \"23034\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a7.jpg?w=300\",\n  \"23035\": \"https://hallofheroeshome.files.wordpress.com/2021/11/a8.jpg?w=300\",\n};\n","import { Component } from \"react\";\nimport * as React from \"react\";\nimport { ICardStack } from \"./features/cards/initialState\";\nimport { Group, Rect, Text } from \"react-konva\";\nimport { cardConstants } from \"./constants/card-constants\";\nimport { GameType } from \"./constants/app-constants\";\nimport { GamePropertiesMap } from \"./constants/game-type-properties-mapping\";\nimport cloneDeep from \"lodash.clonedeep\";\n\ninterface IProps {\n  currentGameType: GameType;\n  x: number;\n  y: number;\n  card: ICardStack | undefined;\n  cardHeight: number | undefined;\n  cardWidth: number | undefined;\n  isPreview: boolean;\n}\n\ninterface IState {\n  imagesLoaded: {\n    [K: string]: boolean;\n  };\n}\n\nconst desiredWidth = 36;\nconst desiredHeight = 36;\n\nconst textWidth = 40;\n\nclass CardModifiers extends Component<IProps, IState> {\n  private imgs: { [K: string]: HTMLImageElement };\n  private unmounted: boolean;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.unmounted = true;\n\n    this.imgs = {};\n\n    const modifiersInfo =\n      GamePropertiesMap[this.props.currentGameType].modifiers;\n\n    const additionalIcons =\n      GamePropertiesMap[this.props.currentGameType].possibleIcons;\n\n    const newImagesLoaded: {\n      [K: string]: boolean;\n    } = {};\n\n    modifiersInfo.forEach((m) => {\n      this.imgs[m.attributeId] = new Image();\n      newImagesLoaded[m.attributeId] = false;\n    });\n\n    additionalIcons.forEach((a) => {\n      this.imgs[a.iconId] = new Image();\n      newImagesLoaded[a.iconId] = false;\n    });\n\n    this.state = {\n      imagesLoaded: newImagesLoaded,\n    };\n\n    // set up onload\n    modifiersInfo.forEach((m) => {\n      this.imgs[m.attributeId].onload = () => {\n        if (!this.unmounted) {\n          const updatedImagesLoaded = cloneDeep(this.state.imagesLoaded);\n          updatedImagesLoaded[m.attributeId] = true;\n          this.setState({\n            imagesLoaded: updatedImagesLoaded,\n          });\n        }\n      };\n    });\n\n    additionalIcons.forEach((a) => {\n      this.imgs[a.iconId].onload = () => {\n        if (!this.unmounted) {\n          const updatedImagesLoaded = cloneDeep(this.state.imagesLoaded);\n          updatedImagesLoaded[a.iconId] = true;\n          this.setState({\n            imagesLoaded: updatedImagesLoaded,\n          });\n        }\n      };\n    });\n\n    // set up the img src values\n    modifiersInfo.forEach((m) => {\n      if (!!this.props.card?.modifiers[m.attributeId]) {\n        this.imgs[m.attributeId].src = m.icon;\n      }\n    });\n\n    additionalIcons.forEach((a) => {\n      if (!!this.props.card?.extraIcons.includes(a.iconId)) {\n        this.imgs[a.iconId].src = a.iconImageUrl;\n      }\n    });\n  }\n\n  public componentDidUpdate(prevProps: IProps, prevState: IState) {\n    const modifiersInfo =\n      GamePropertiesMap[this.props.currentGameType].modifiers;\n\n    const additionalIcons =\n      GamePropertiesMap[this.props.currentGameType].possibleIcons;\n\n    // handle change\n    modifiersInfo.forEach((m) => {\n      if (\n        !this.state.imagesLoaded[m.attributeId] &&\n        !prevProps.card?.modifiers[m.attributeId] &&\n        !!this.props.card?.modifiers[m.attributeId]\n      ) {\n        this.imgs[m.attributeId].src = m.icon;\n      }\n    });\n\n    additionalIcons.forEach((a) => {\n      if (\n        !this.state.imagesLoaded[a.iconId] &&\n        !prevProps.card?.extraIcons.includes(a.iconId) &&\n        !!this.props.card?.extraIcons.includes(a.iconId)\n      ) {\n        this.imgs[a.iconId].src = a.iconImageUrl;\n      }\n    });\n  }\n\n  public componentDidMount() {\n    this.unmounted = false;\n  }\n\n  public componentWillUnmount() {\n    this.unmounted = true;\n  }\n\n  render() {\n    if (!this.props.card) return null;\n    if (!this.props.card?.modifiers) return null;\n\n    const modifiersInfo =\n      GamePropertiesMap[this.props.currentGameType].modifiers;\n\n    const additionalIcons =\n      GamePropertiesMap[this.props.currentGameType].possibleIcons;\n\n    const nodesToRender: JSX.Element[] = [];\n\n    modifiersInfo.forEach((m) => {\n      const modifierX = this.props.isPreview\n        ? this.props.x +\n          (this.props.cardWidth || 0) / 2 -\n          desiredWidth -\n          textWidth\n        : this.props.x + cardConstants.CARD_WIDTH / 2 - desiredWidth / 2;\n      const modifierTextX = modifierX + desiredWidth - 2;\n      const modifierY =\n        this.props.y -\n        cardConstants.CARD_HEIGHT / 2 +\n        10 * (m.slot - 1) +\n        desiredHeight * (m.slot - 1);\n      const showModifier =\n        this.state.imagesLoaded[m.attributeId] &&\n        !!this.props.card?.modifiers[m.attributeId];\n\n      const img = this.imgs[m.attributeId];\n\n      const modifierValue = this.props.card?.modifiers[m.attributeId];\n\n      const modifierToken = showModifier ? (\n        <Rect\n          key={`${this.props.card?.id}-${m.attributeId}-modifier-token`}\n          x={modifierX}\n          y={modifierY}\n          scale={{\n            x: desiredWidth / img.naturalWidth,\n            y: desiredHeight / img.naturalHeight,\n          }}\n          width={img.naturalWidth}\n          height={img.naturalHeight}\n          fillPatternImage={img}\n        ></Rect>\n      ) : null;\n\n      const modifierText = showModifier ? (\n        <Group\n          key={`${this.props.card?.id}-${m.attributeId}-modifier-text`}\n          x={modifierTextX}\n          y={modifierY}\n          width={textWidth}\n          height={desiredHeight}\n        >\n          <Rect width={textWidth} height={desiredHeight} fill=\"white\"></Rect>\n          <Text\n            width={textWidth}\n            height={desiredHeight}\n            text={`${modifierValue && modifierValue > 0 ? \"+\" : \"\"}${\n              modifierValue ?? \"?\"\n            }`}\n            fill=\"black\"\n            background=\"white\"\n            align=\"center\"\n            verticalAlign=\"middle\"\n            fontSize={24}\n          ></Text>\n        </Group>\n      ) : null;\n\n      if (!!modifierToken) {\n        nodesToRender.push(modifierToken);\n      }\n      if (!!modifierText) {\n        nodesToRender.push(modifierText);\n      }\n    });\n\n    additionalIcons.forEach((a, index) => {\n      const iconX = this.props.isPreview\n        ? this.props.x - (this.props.cardWidth || 0) / 2 + desiredWidth\n        : this.props.x - cardConstants.CARD_WIDTH / 2 - desiredWidth / 2;\n\n      const iconY =\n        this.props.y -\n        cardConstants.CARD_HEIGHT / 2 +\n        10 * index +\n        desiredHeight * index;\n\n      const img = this.imgs[a.iconId];\n\n      const showIcon =\n        this.state.imagesLoaded[a.iconId] &&\n        !!this.props.card?.extraIcons.includes(a.iconId);\n\n      const icon = showIcon ? (\n        <Rect\n          key={`${this.props.card?.id}-${a.iconId}-icon`}\n          x={iconX}\n          y={iconY}\n          scale={{\n            x: desiredWidth / img.naturalWidth,\n            y: desiredHeight / img.naturalHeight,\n          }}\n          width={img.naturalWidth}\n          height={img.naturalHeight}\n          fillPatternImage={img}\n        ></Rect>\n      ) : null;\n\n      if (!!icon) {\n        nodesToRender.push(icon);\n      }\n    });\n\n    return nodesToRender;\n  }\n}\n\nexport default CardModifiers;\n","import { connect } from \"react-redux\";\n\nimport { RootState } from \"./store/rootReducer\";\nimport { getCardMapById } from \"./features/cards/cards.selectors\";\nimport CardModifiers from \"./CardModifiers\";\n\nexport interface IProps {\n  id: string;\n}\n\nconst mapStateToProps = (state: RootState, props: IProps) => {\n  return {\n    card: getCardMapById(state)[props.id],\n  };\n};\n\nconst CardModifiersContainer = connect(mapStateToProps, {})(CardModifiers);\n\nexport default CardModifiersContainer;\n","// tslint:disable:no-console\nimport { KonvaEventObject } from \"konva/lib/Node\";\nimport { Rect as RectRef } from \"konva/lib/shapes/Rect\";\nimport { Vector2d } from \"konva/lib/types\";\nimport * as React from \"react\";\nimport { Component } from \"react\";\nimport { Rect, Text } from \"react-konva\";\nimport { animated, Spring } from \"@react-spring/konva\";\nimport CardTokensContainer from \"./CardTokensContainer\";\nimport { GameType, myPeerRef, PlayerColor } from \"./constants/app-constants\";\nimport { cardConstants } from \"./constants/card-constants\";\nimport { CARD_ALREADY_ROTATED_MAP } from \"./constants/card-missing-image-map\";\nimport { GamePropertiesMap } from \"./constants/game-type-properties-mapping\";\nimport CardModifiersContainer from \"./CardModifiersContainer\";\n\n// There is a bug somewhere in react-konva or react-spring/konva, where, if you use the generic\n// `animated` WithAnimations type, you get the following typescript error in typescript ~4.5:\n//\n// Type instantiation is excessively deep and possibly infinite\n//\n// We are explicitly casting to an any for now just until this bug is (hopefully) fixed\nconst AnimatedAny = animated as any;\n\nexport const HORIZONTAL_TYPE_CODES = [\n  \"main_scheme\",\n  \"side_scheme\",\n  \"quest\",\n  \"player_side_quest\",\n];\n\nexport interface CardTokens {\n  damage: number;\n  threat: number;\n  generic: number;\n}\n\nexport interface CardUIState {\n  stunned: boolean;\n  confused: boolean;\n  tough: boolean;\n  tokens: CardTokens;\n}\n\ninterface IProps {\n  currentGameType: GameType;\n  name: string;\n  code: string;\n  selectedColor: PlayerColor;\n  controlledBy: string;\n  dragging: boolean;\n  shuffling: boolean;\n  exhausted: boolean;\n  cardState?: CardUIState;\n  fill: string;\n  handleClick?: (\n    id: string,\n    event: KonvaEventObject<MouseEvent> | KonvaEventObject<TouchEvent>,\n    wasTouch: boolean\n  ) => void;\n  handleDoubleClick?: (id: string, event: KonvaEventObject<MouseEvent>) => void;\n  handleDoubleTap?: (id: string, event: KonvaEventObject<TouchEvent>) => void;\n  handleDragStart?: (id: string, event: KonvaEventObject<DragEvent>) => void;\n  handleDragMove?: (info: { id: string; dx: number; dy: number }) => void;\n  handleDragEnd?: (id: string, event: KonvaEventObject<DragEvent>) => void;\n  handleHover?: (id: string) => void;\n  handleHoverLeave?: (id: string) => void;\n  id: string;\n  selected: boolean;\n  dropTargetColor?: string;\n  x: number;\n  y: number;\n  width?: number;\n  height?: number;\n  imgUrls: string[];\n  isGhost?: boolean;\n  isPreview?: boolean;\n  numCardsInStack?: number;\n  typeCode?: string;\n  faceup: boolean;\n  handleContextMenu?: (\n    id: string,\n    event: KonvaEventObject<PointerEvent>\n  ) => void;\n}\n\ninterface IState {\n  imageLoaded: boolean;\n  imageLoadFailed: number;\n  prevImgUrls: string[];\n  tokenImagesLoaded: {\n    stunned: boolean;\n    confused: boolean;\n    tough: boolean;\n  };\n}\n\nconst stringArraysEqual = (array1: string[], array2: string[]) => {\n  return (\n    array1.length === array2.length &&\n    array1.every((value, index) => {\n      return value === array2[index];\n    })\n  );\n};\n\nclass Card extends Component<IProps, IState> {\n  // tslint:disable-next-line:member-access\n  static getDerivedStateFromProps(props: IProps, state: IState): IState | null {\n    if (!stringArraysEqual(props.imgUrls, state.prevImgUrls ?? [])) {\n      return {\n        imageLoaded: false,\n        imageLoadFailed: 0,\n        prevImgUrls: props.imgUrls,\n        tokenImagesLoaded: {\n          stunned: state.tokenImagesLoaded.stunned,\n          confused: state.tokenImagesLoaded.confused,\n          tough: state.tokenImagesLoaded.tough,\n        },\n      };\n    }\n    // No state update necessary\n    return null;\n  }\n\n  private imgs: HTMLImageElement[] = [];\n  private stunnedImg: HTMLImageElement;\n  private confusedImg: HTMLImageElement;\n  private toughImg: HTMLImageElement;\n  private unmounted: boolean;\n  private touchTimer: any = null;\n  private rect: RectRef | null = null;\n  private shuffleToggle = false;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.unmounted = true;\n\n    this.state = {\n      imageLoaded: false,\n      imageLoadFailed: 0,\n      prevImgUrls: this.props.imgUrls,\n      tokenImagesLoaded: {\n        stunned: false,\n        confused: false,\n        tough: false,\n      },\n    };\n\n    this.initCardImages(props);\n\n    this.stunnedImg = new Image();\n    this.confusedImg = new Image();\n    this.toughImg = new Image();\n\n    // STUNNED\n    this.stunnedImg.onload = () => {\n      if (!this.unmounted) {\n        this.setState({\n          tokenImagesLoaded: {\n            stunned: true,\n            confused: this.state.tokenImagesLoaded.confused,\n            tough: this.state.tokenImagesLoaded.tough,\n          },\n        });\n      }\n    };\n\n    const tokenInfo = GamePropertiesMap[props.currentGameType].tokens;\n\n    if (!!props.cardState?.stunned && !!tokenInfo.stunned) {\n      this.stunnedImg.src = tokenInfo.stunned.imagePath;\n    }\n\n    // CONFUSED\n    this.confusedImg.onload = () => {\n      if (!this.unmounted) {\n        this.setState({\n          tokenImagesLoaded: {\n            stunned: this.state.tokenImagesLoaded.stunned,\n            confused: true,\n            tough: this.state.tokenImagesLoaded.tough,\n          },\n        });\n      }\n    };\n\n    if (!!props.cardState?.confused && !!tokenInfo.confused) {\n      this.confusedImg.src = tokenInfo.confused.imagePath;\n    }\n\n    // TOUGH\n    this.toughImg.onload = () => {\n      if (!this.unmounted) {\n        this.setState({\n          tokenImagesLoaded: {\n            stunned: this.state.tokenImagesLoaded.stunned,\n            confused: this.state.tokenImagesLoaded.confused,\n            tough: true,\n          },\n        });\n      }\n    };\n\n    if (!!props.cardState?.tough && !!tokenInfo.tough) {\n      this.toughImg.src = tokenInfo.tough.imagePath;\n    }\n  }\n\n  public componentDidUpdate(prevProps: IProps, prevState: IState) {\n    // if we just went from not shuffling -> shuffling, animate\n    if (!prevProps.shuffling && this.props.shuffling) {\n      if (!!this.rect) {\n        this.shuffleToggle = !this.shuffleToggle;\n        this.rect.to({\n          rotation: this.currentRotation + (this.shuffleToggle ? 360 : -360),\n          duration: 0.2,\n        });\n      }\n    }\n\n    if (\n      !this.state.imageLoaded &&\n      !stringArraysEqual(prevProps.imgUrls, this.props.imgUrls)\n    ) {\n      this.setState({\n        imageLoaded: false,\n        imageLoadFailed: 0,\n      });\n      this.initCardImages(this.props);\n    }\n\n    const tokenInfo = GamePropertiesMap[this.props.currentGameType].tokens;\n\n    // STUNNED\n    if (\n      !this.state.tokenImagesLoaded.stunned &&\n      !prevProps.cardState?.stunned &&\n      !!this.props.cardState?.stunned &&\n      !!tokenInfo.stunned\n    ) {\n      this.stunnedImg.src = tokenInfo.stunned.imagePath;\n    }\n\n    // CONFUSED\n    if (\n      !this.state.tokenImagesLoaded.confused &&\n      !prevProps.cardState?.confused &&\n      !!this.props.cardState?.confused &&\n      !!tokenInfo.confused\n    ) {\n      this.confusedImg.src = tokenInfo.confused.imagePath;\n    }\n\n    // TOUGH\n    if (\n      !this.state.tokenImagesLoaded.tough &&\n      !prevProps.cardState?.tough &&\n      !!this.props.cardState?.tough &&\n      !!tokenInfo.tough\n    ) {\n      this.toughImg.src = tokenInfo.tough.imagePath;\n    }\n  }\n\n  private initCardImages = (props: IProps) => {\n    this.imgs = props.imgUrls.map(() => new Image());\n\n    // When the image loads, set a flag in the state\n    this.imgs.forEach(\n      (img) =>\n        (img.onload = () => {\n          if (!this.unmounted) {\n            this.setState({\n              imageLoaded: true,\n            });\n          }\n        })\n    );\n\n    this.imgs.forEach(\n      (img) =>\n        (img.onerror = () => {\n          if (!this.unmounted) {\n            this.setState({\n              imageLoadFailed: this.state.imageLoadFailed + 1,\n            });\n          }\n        })\n    );\n\n    props.imgUrls.forEach((imgUrl, index) => (this.imgs[index].src = imgUrl));\n  };\n\n  public componentDidMount() {\n    this.unmounted = false;\n  }\n\n  public componentWillUnmount() {\n    this.unmounted = true;\n  }\n\n  public render() {\n    return this.renderCard(this.state.imageLoaded);\n  }\n\n  private renderCard(imageLoaded: boolean) {\n    const heightToUse = this.props.height || cardConstants.CARD_HEIGHT;\n    const widthToUse = this.props.width || cardConstants.CARD_WIDTH;\n\n    return this.renderUnanimatedCard(heightToUse, widthToUse, imageLoaded);\n  }\n\n  // Unfortunately, if you try to use shadow / blur to indicate selection\n  // (which I did at first and looks better, imo) the performance in horrible,\n  // even with some reccommended settings (shadowForStrokeEnabled = false and\n  // hitStrokeWidth = 0). So we'll just use stroke / border for everything\n  private getStrokeColor = () => {\n    if (!!this.props.dropTargetColor) {\n      return this.props.dropTargetColor;\n    }\n\n    if (this.props.selected) {\n      return this.props.selectedColor;\n    }\n\n    return \"\";\n  };\n\n  private renderUnanimatedCard = (\n    heightToUse: number,\n    widthToUse: number,\n    imageLoaded: boolean\n  ) => {\n    const imgToUse = imageLoaded\n      ? this.imgs.find((i) => i.complete && i.naturalHeight !== 0)\n      : undefined;\n\n    const scale = this.getScale(imgToUse, widthToUse, heightToUse);\n    const offset = {\n      x: widthToUse / 2,\n      y: heightToUse / 2,\n    };\n\n    const card = (\n      <Spring\n        key={`${this.props.id}-card`}\n        to={{\n          rotation: this.props.exhausted ? 90 : 0,\n        }}\n      >\n        {(animatedProps: any) => (\n          <AnimatedAny.Rect\n            {...animatedProps}\n            ref={(node: any) => {\n              if (!!node) {\n                this.rect = node;\n              }\n            }}\n            cornerRadius={9}\n            x={this.props.x}\n            y={this.props.y}\n            width={widthToUse}\n            height={heightToUse}\n            offset={offset}\n            stroke={this.getStrokeColor()}\n            strokeWidth={!!this.getStrokeColor() ? 4 : 0}\n            fillPatternRotation={\n              !imageLoaded ||\n              this.shouldRenderImageHorizontal(\n                this.props.code,\n                this.props.typeCode || \"\",\n                HORIZONTAL_TYPE_CODES\n              )\n                ? 270\n                : 0\n            }\n            fillPatternImage={imgToUse}\n            fillPatternScaleX={scale.width}\n            fillPatternScaleY={scale.height}\n            fill={imageLoaded ? undefined : \"gray\"}\n            shadowForStrokeEnabled={false}\n            hitStrokeWidth={0}\n            opacity={this.props.isGhost ? 0.5 : 1}\n            draggable={\n              this.props.controlledBy === \"\" ||\n              this.props.controlledBy === myPeerRef\n            }\n            onDragStart={this.handleDragStart}\n            onDragMove={this.handleDragMove}\n            onDragEnd={this.handleDragEnd}\n            onDblClick={this.handleDoubleClick}\n            onDblTap={this.handleDoubleTap}\n            onClick={this.handleClick}\n            onTap={this.handleTap}\n            onMouseDown={this.handleMouseDown}\n            onTouchStart={this.handleTouchStart}\n            onTouchMove={this.handleTouchMove}\n            onTouchEnd={this.handleTouchEnd}\n            onMouseOver={this.handleMouseOver}\n            onMouseOut={this.handleMouseOut}\n            onContextMenu={this.handleContextMenu}\n          />\n        )}\n      </Spring>\n    );\n\n    const cardStackOffset = {\n      x: offset.x + 4,\n      y: offset.y - 4,\n    };\n\n    const cardStack =\n      (this.props.numCardsInStack || 1) > 1 ? (\n        <Spring\n          key={`${this.props.id}-cardStack`}\n          to={{\n            rotation: this.props.exhausted ? 90 : 0,\n          }}\n        >\n          {(animatedProps: any) => (\n            <AnimatedAny.Rect\n              {...animatedProps}\n              cornerRadius={[9, 9, 9, 9]}\n              x={this.props.x}\n              y={this.props.y}\n              width={widthToUse}\n              height={heightToUse}\n              offset={cardStackOffset}\n              opacity={this.props.isGhost ? 0.5 : 1}\n              fill={\"gray\"}\n              shadowForStrokeEnabled={false}\n              hitStrokeWidth={0}\n            />\n          )}\n        </Spring>\n      ) : null;\n\n    const shouldRenderStunned =\n      !!this.props.cardState?.stunned && this.state.tokenImagesLoaded.stunned;\n\n    const stunnedToken = this.getTokenInSlot(\n      shouldRenderStunned,\n      this.stunnedImg,\n      offset,\n      0\n    );\n    const confusedToken = this.getTokenInSlot(\n      !!this.props.cardState?.confused && this.state.tokenImagesLoaded.confused,\n      this.confusedImg,\n      offset,\n      1\n    );\n    const toughToken = this.getTokenInSlot(\n      !!this.props.cardState?.tough && this.state.tokenImagesLoaded.tough,\n      this.toughImg,\n      offset,\n      2\n    );\n\n    const cardTokens =\n      this.props.dragging || this.props.isGhost ? null : (\n        <CardTokensContainer\n          currentGameType={this.props.currentGameType}\n          key={`${this.props.id}-cardTokens`}\n          id={this.props.id}\n          x={this.props.x}\n          y={this.props.y}\n        ></CardTokensContainer>\n      );\n\n    const cardModifiers =\n      this.props.dragging || this.props.isGhost ? null : (\n        <CardModifiersContainer\n          currentGameType={this.props.currentGameType}\n          key={`${this.props.id}-cardModifiers`}\n          id={this.props.id}\n          x={this.props.x}\n          y={this.props.y}\n          cardHeight={this.props.height}\n          cardWidth={this.props.width}\n          isPreview={!!this.props.isPreview}\n        ></CardModifiersContainer>\n      );\n\n    const noImageCardNameText = this.renderCardName(\n      offset,\n      widthToUse,\n      heightToUse\n    );\n\n    return [\n      cardStack,\n      card,\n      noImageCardNameText,\n      stunnedToken,\n      confusedToken,\n      toughToken,\n      cardTokens,\n      cardModifiers,\n    ];\n  };\n\n  private renderCardName(\n    offset: Vector2d,\n    cardWidth: number,\n    cardHeight: number\n  ) {\n    const textOffset = { x: offset.x - 10, y: offset.y - 20 };\n    const textItem =\n      this.state.imageLoadFailed === this.props.imgUrls.length &&\n      this.state.imageLoadFailed !== 0 ? (\n        <Text\n          key={`${this.props.id}-cardnametext`}\n          offset={textOffset}\n          x={this.props.x}\n          y={this.props.y}\n          width={cardWidth - 10}\n          height={cardHeight - 20}\n          fontSize={24}\n          text={`${this.props.name} ${this.props.code}`}\n          draggable={\n            this.props.controlledBy === \"\" ||\n            this.props.controlledBy === myPeerRef\n          }\n          onDragStart={this.handleDragStart}\n          onDragMove={this.handleDragMove}\n          onDragEnd={this.handleDragEnd}\n          onDblClick={this.handleDoubleClick}\n          onDblTap={this.handleDoubleClick}\n          onClick={this.handleClick}\n          onTap={this.handleClick}\n          onMouseDown={this.handleMouseDown}\n          onTouchStart={this.handleMouseDown}\n          onMouseOver={this.handleMouseOver}\n          onMouseOut={this.handleMouseOut}\n          onContextMenu={this.handleContextMenu}\n        ></Text>\n      ) : null;\n\n    return textItem;\n  }\n\n  private getTokenInSlot(\n    shouldRender: boolean,\n    img: HTMLImageElement,\n    offset: { x: number; y: number },\n    slot: 0 | 1 | 2\n  ) {\n    const dimensions = {\n      width: img.naturalWidth / 2,\n      height: img.naturalHeight / 2,\n    };\n\n    const stunnedOffset = {\n      x: offset.x - cardConstants.CARD_WIDTH + dimensions.width / 2,\n      y: offset.y - dimensions.height * slot - 5 * (slot + 1) - 10,\n    };\n\n    return shouldRender ? (\n      <Rect\n        key={`${this.props.id}-status${slot}`}\n        native={true}\n        cornerRadius={8}\n        x={this.props.x}\n        y={this.props.y}\n        width={dimensions.width}\n        height={dimensions.height}\n        fillPatternScaleX={0.5}\n        fillPatternScaleY={0.5}\n        offset={stunnedOffset}\n        fillPatternImage={img}\n      />\n    ) : null;\n  }\n\n  private shouldRenderImageHorizontal(\n    code: string,\n    type: string,\n    typeCodes: string[]\n  ): boolean {\n    const shouldRotateByType =\n      typeCodes.includes(type.toLocaleLowerCase()) && !this.plainCardBack;\n    return shouldRotateByType && !CARD_ALREADY_ROTATED_MAP[code];\n  }\n\n  private get plainCardBack() {\n    return (\n      this.props.imgUrls.some((i) => i.includes(\"standard\")) &&\n      this.props.imgUrls.some((i) => i.includes(\"_back\"))\n    );\n  }\n\n  private get currentRotation() {\n    return this.props.exhausted ? 90 : 0;\n  }\n\n  private getScale(\n    img: HTMLImageElement | undefined,\n    widthToUse: number,\n    heightToUse: number\n  ) {\n    const width = !!img ? widthToUse / img.naturalWidth : widthToUse;\n\n    const widthHorizontal = !!img ? heightToUse / img.naturalWidth : widthToUse;\n\n    const height = !!img ? heightToUse / img.naturalHeight : heightToUse;\n\n    const heightHorizontal = !!img\n      ? widthToUse / img.naturalHeight\n      : heightToUse;\n\n    return this.shouldRenderImageHorizontal(\n      this.props.code,\n      this.props.typeCode || \"\",\n      HORIZONTAL_TYPE_CODES\n    )\n      ? { width: widthHorizontal, height: heightHorizontal }\n      : { width, height };\n  }\n\n  private handleContextMenu = (event: KonvaEventObject<PointerEvent>): void => {\n    if (!!this.props.handleContextMenu) {\n      this.props.handleContextMenu(this.props.id, event);\n    }\n  };\n\n  private handleDoubleClick = (event: KonvaEventObject<MouseEvent>) => {\n    if (this.props.handleDoubleClick) {\n      this.props.handleDoubleClick(this.props.id, event);\n    }\n  };\n\n  private handleDoubleTap = (event: KonvaEventObject<TouchEvent>) => {\n    if (this.props.handleDoubleTap) {\n      this.props.handleDoubleTap(this.props.id, event);\n    }\n  };\n\n  private handleDragStart = (event: KonvaEventObject<DragEvent>) => {\n    if (this.props.handleDragStart) {\n      this.props.handleDragStart(this.props.id, event);\n    }\n  };\n\n  private handleDragMove = (event: any) => {\n    if (this.props.handleDragMove) {\n      this.props.handleDragMove({\n        id: this.props.id,\n        dx: event.target.x() - this.props.x,\n        dy: event.target.y() - this.props.y,\n      });\n    }\n  };\n\n  private handleDragEnd = (event: KonvaEventObject<DragEvent>) => {\n    if (this.props.handleDragEnd && this.props.dragging) {\n      this.props.handleDragEnd(this.props.id, event);\n    }\n  };\n\n  private handleTap = (event: KonvaEventObject<TouchEvent>) => {\n    this.handleTapOrClick(event, true);\n  };\n\n  private handleClick = (event: KonvaEventObject<MouseEvent>) => {\n    this.handleTapOrClick(event, false);\n  };\n\n  private handleTapOrClick = (\n    event: KonvaEventObject<MouseEvent> | KonvaEventObject<TouchEvent>,\n    wasTouch: boolean\n  ) => {\n    if (this.props.handleClick) {\n      this.props.handleClick(this.props.id, event, wasTouch);\n      event.cancelBubble = true;\n    }\n  };\n\n  private handleMouseDown = (event: any) => {\n    event.cancelBubble = true;\n  };\n\n  private handleTouchStart = (event: KonvaEventObject<TouchEvent>) => {\n    event.cancelBubble = true;\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n\n    this.touchTimer = setTimeout(() => {\n      this.handleContextMenu(\n        event as unknown as KonvaEventObject<PointerEvent>\n      );\n    }, 750);\n  };\n\n  private handleTouchMove = (event: KonvaEventObject<TouchEvent>) => {\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n  };\n\n  private handleTouchEnd = (event: KonvaEventObject<TouchEvent>) => {\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n  };\n\n  private handleMouseOver = () => {\n    if (this.props.handleHover) {\n      this.props.handleHover(this.props.id);\n    }\n  };\n\n  private handleMouseOut = () => {\n    if (this.props.handleHoverLeave) {\n      this.props.handleHoverLeave(this.props.id);\n    }\n  };\n}\n\nexport default Card;\n","import { Component } from \"react\";\nimport Select from \"@material-ui/core/Select\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport * as React from \"react\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { CardData } from \"./external-api/common-card-data\";\nimport { ICardData } from \"./features/cards-data/initialState\";\nimport { ICardStack } from \"./features/cards/initialState\";\nimport { AutocompleteHighlightChangeReason } from \"@material-ui/lab/useAutocomplete\";\nimport InfoOutlinedIcon from \"@material-ui/icons/InfoOutlined\";\nimport \"./CardStackCardSelector.scss\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\n\ninterface IProps {\n  cardsDataEntities: ICardData;\n  card: ICardStack;\n  cardSelected: (jsonId: string) => void;\n  preview: (jsonId: string) => void;\n  clearPreview: () => void;\n  touchBased: boolean;\n}\n\nclass CardStackCardSelector extends Component<IProps> {\n  private cardsDataInStack: CardData[] = [];\n\n  constructor(props: IProps) {\n    super(props);\n    this.cardsDataInStack = props.card.cardStack.map((c) => {\n      return this.props.cardsDataEntities[c.jsonId];\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.clearPreview();\n  }\n\n  render() {\n    return (\n      <div onClick={this.cancelBubble} onKeyPress={this.cancelBubble}>\n        {this.props.touchBased\n          ? this.renderTouchList()\n          : this.renderAutocomplete()}\n      </div>\n    );\n  }\n\n  private renderTouchList = () => {\n    return (\n      <div className=\"card-picker-select\">\n        <FormControl className=\"select\">\n          <InputLabel id=\"game-picker-label\">Select Card...</InputLabel>\n          <Select\n            id=\"touch-cardstack-list\"\n            onChange={(e) => {\n              if (!!e.target.value) {\n                const val: string = (e.target.value as string) || \"\";\n                this.handleSelected(e, this.props.cardsDataEntities[val]);\n              }\n            }}\n            variant=\"outlined\"\n          >\n            {this.cardsDataInStack.map((cd, index) => {\n              return (\n                <MenuItem\n                  key={`select-item-card-${cd.code}-${index}`}\n                  value={cd.code}\n                >\n                  <div className=\"card-picker-row\">\n                    <div>{cd.name}</div>\n                    <div\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        e.preventDefault();\n                        this.props.preview(cd.code);\n                      }}\n                      className=\"mobile-only\"\n                    >\n                      <InfoOutlinedIcon />\n                    </div>\n                  </div>\n                </MenuItem>\n              );\n            })}\n          </Select>\n        </FormControl>\n      </div>\n    );\n  };\n\n  private renderAutocomplete = () => {\n    return (\n      <Autocomplete\n        id=\"cardstack-card-selector-combobox\"\n        options={this.cardsDataInStack}\n        getOptionLabel={(option) => option.name || \"Unknown Card Name\"}\n        style={{ width: 300 }}\n        onChange={this.handleSelected}\n        onHighlightChange={this.handleHighlightChange}\n        renderInput={(params) => (\n          <TextField {...params} label=\"Find Card...\" variant=\"outlined\" />\n        )}\n      />\n    );\n  };\n\n  private handleHighlightChange = (\n    _event: any,\n    option: CardData | null,\n    reason: AutocompleteHighlightChangeReason\n  ) => {\n    if (!option) {\n      this.props.clearPreview();\n    } else {\n      this.props.preview(option.code);\n    }\n  };\n\n  private handleSelected = (_event: any, value: CardData | null) => {\n    this.props.clearPreview();\n    if (!!value && !!this.props.cardSelected) {\n      this.props.cardSelected(value.code);\n    }\n  };\n\n  private cancelBubble = (event: React.SyntheticEvent) => {\n    event.stopPropagation();\n  };\n}\n\nexport default CardStackCardSelector;\n","import { connect } from \"react-redux\";\nimport CardStackCardSelector from \"./CardStackCardSelector\";\nimport { getCardsDataEntities } from \"./features/cards-data/cards-data.selectors\";\nimport {\n  clearMenuPreviewCardJsonId,\n  setMenuPreviewCardJsonId,\n} from \"./features/game/game.slice\";\n\nimport { RootState } from \"./store/rootReducer\";\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    cardsDataEntities: getCardsDataEntities(state),\n  };\n};\n\nconst CardStackCardSelectorContainer = connect(mapStateToProps, {\n  preview: setMenuPreviewCardJsonId,\n  clearPreview: clearMenuPreviewCardJsonId,\n})(CardStackCardSelector);\n\nexport default CardStackCardSelectorContainer;\n","import MenuItem from \"@material-ui/core/MenuItem\";\nimport React from \"react\";\n\ninterface IProps {\n  label: string;\n  key?: string;\n  handleFile: (file: File) => void;\n}\n\nconst FileUploader = (props: IProps) => {\n  // Create a reference to the hidden file input element\n  const hiddenFileInput = React.useRef<HTMLInputElement>(null);\n\n  // Programatically click the hidden file input element\n  // when the Button component is clicked\n  const handleClick = (event: React.MouseEvent) => {\n    if (!!hiddenFileInput?.current) {\n      var evt = document.createEvent(\"MouseEvents\");\n      evt.initEvent(\"click\", true, false);\n      hiddenFileInput.current.dispatchEvent(evt);\n    }\n    event.stopPropagation();\n  };\n  // Call a function (passed as a prop from the parent component)\n  // to handle the user-selected file\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (!!event.target.files && event.target.files.length > 0) {\n      const fileUploaded = event.target.files[0];\n      props.handleFile(fileUploaded);\n    }\n  };\n  return (\n    <>\n      <MenuItem onClick={handleClick}>{props.label}</MenuItem>\n      <input\n        type=\"file\"\n        ref={hiddenFileInput}\n        onChange={handleChange}\n        style={{ display: \"none\" }}\n      />\n    </>\n  );\n};\n\nexport default FileUploader;\n","import { Vector2d } from \"konva/lib/types\";\nimport * as React from \"react\";\nimport { Component } from \"react\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport NestedMenuItem from \"material-ui-nested-menu-item\";\nimport FileUploader from \"./FileUploader\";\n\nexport interface ContextMenuItem {\n  label: string;\n  action?: (fromTouch?: boolean) => void;\n  fileLoadedAction?: (fileContents: string) => void;\n  children?: ContextMenuItem[];\n  fileUploader?: boolean;\n}\n\ninterface IProps {\n  position?: Vector2d;\n  anchorEl?: HTMLElement;\n  items: ContextMenuItem[];\n  contextItemClicked?: (item: ContextMenuItem) => void;\n  hideContextMenu: () => void;\n}\n\ninterface IState {\n  menuOpen: boolean;\n}\n\nconst isTargetFileInput = (target: EventTarget) => {\n  const targetAsInput = target as HTMLInputElement;\n  return !!targetAsInput?.files;\n};\n\nclass ContextMenu extends Component<IProps, IState> {\n  private nestedRef: any;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      menuOpen: true,\n    };\n  }\n\n  render() {\n    return (\n      <div\n        id=\"context-menu-layer\"\n        onContextMenu={this.preventDefault}\n        onClick={(event) => {\n          if (!isTargetFileInput(event.target)) {\n            this.props.hideContextMenu();\n          }\n        }}\n      >\n        <Menu\n          keepMounted\n          open={this.state.menuOpen}\n          onClose={this.handleMenuClosed}\n          anchorReference={\n            !!this.props.anchorEl ? \"anchorEl\" : \"anchorPosition\"\n          }\n          anchorEl={this.props.anchorEl}\n          anchorPosition={\n            !!this.props.position\n              ? {\n                  top: this.props.position.y + 8,\n                  left: this.props.position.x + 8,\n                }\n              : undefined\n          }\n        >\n          {this.props.items.map((i, index) => this.renderMenuItem(i, index))}\n        </Menu>\n      </div>\n    );\n  }\n\n  private renderMenuItem = (i: ContextMenuItem, index: number) => {\n    if (!!i.children) {\n      return (\n        <NestedMenuItem\n          ref={(val) => {\n            this.nestedRef = val;\n          }}\n          key={`contextMenu-item-${index}`}\n          parentMenuOpen={this.state.menuOpen}\n          label={i.label}\n          onClick={(event) => {\n            if (!!this.nestedRef) {\n              event.stopPropagation();\n              // This is a hack to force the nested menu to open on touch devices.\n              // the `NestedMenuItem` library doesn't correctly support touch events, only hover\n              this.nestedRef.parentElement.focus();\n            }\n          }}\n        >\n          {i.children.map((nestedI, nestedIndex) => {\n            return this.renderMenuItem(nestedI, index * 1000 + nestedIndex);\n          })}\n        </NestedMenuItem>\n      );\n    } else if (!!i.fileUploader) {\n      return (\n        <FileUploader\n          label={i.label}\n          key={`contextMenu-item-${index}`}\n          handleFile={(file) => {\n            // setting up the reader\n            const reader = new FileReader();\n            reader.readAsText(file, \"UTF-8\");\n\n            // here we tell the reader what to do when it's done reading...\n            reader.onload = (readerEvent) => {\n              const content: string = readerEvent.target?.result as string; // this is the content!\n              if (!!i.fileLoadedAction) {\n                i.fileLoadedAction(content);\n              }\n              this.props.hideContextMenu();\n            };\n          }}\n        ></FileUploader>\n      );\n    } else {\n      return (\n        <MenuItem\n          key={`contextMenu-item-${index}`}\n          onClick={this.handleContextItemClicked(i)}\n        >\n          {i.label}\n        </MenuItem>\n      );\n    }\n  };\n\n  private handleMenuClosed = () => {\n    this.setState({\n      menuOpen: false,\n    });\n    this.props.hideContextMenu();\n  };\n  private preventDefault = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    event.preventDefault();\n  };\n\n  private handleContextItemClicked =\n    (item: ContextMenuItem) => (event: any) => {\n      if (!!item.action) {\n        item.action(event?.nativeEvent?.pointerType === \"touch\");\n      }\n      if (!!this.props.contextItemClicked) {\n        this.props.contextItemClicked(this.props.items[0]);\n      }\n      if (!!item.action) {\n        if (!!this.nestedRef) {\n          this.nestedRef.blur();\n        }\n        this.props.hideContextMenu();\n      }\n    };\n}\n\nexport default ContextMenu;\n","import { Component } from \"react\";\nimport * as React from \"react\";\nimport { Vector2d } from \"konva/lib/types\";\nimport { Group, Rect, Text } from \"react-konva\";\nimport { KonvaEventObject } from \"konva/lib/Node\";\nimport { PlayerColor } from \"./constants/app-constants\";\n\ninterface IProps {\n  id: string;\n  pos: Vector2d;\n  value: number;\n  color: PlayerColor;\n  updateCounterValueBy: (amount: number) => void;\n  handleContextMenu: (event: KonvaEventObject<PointerEvent>) => void;\n  onDragEnd: (event: KonvaEventObject<DragEvent>) => void;\n}\n\nclass Counter extends Component<IProps> {\n  private touchTimer: any = null;\n\n  render() {\n    return (\n      <Group\n        x={this.props.pos.x}\n        y={this.props.pos.y}\n        draggable={true}\n        onClick={this.cancelBubble}\n        onContextMenu={this.props.handleContextMenu}\n        onDragEnd={this.props.onDragEnd}\n        onTouchStart={this.handleTouchStart}\n        onMouseDown={this.cancelBubble}\n        onTouchMove={this.handleTouchMove}\n        onTouchEnd={this.handleTouchEnd}\n      >\n        <Rect\n          cornerRadius={30}\n          width={200}\n          height={100}\n          fill={this.props.color}\n        ></Rect>\n        <Text\n          width={200}\n          height={100}\n          fontSize={36}\n          text={`${this.props.value}`}\n          align={\"center\"}\n          verticalAlign={\"middle\"}\n        ></Text>\n        <Text\n          x={10}\n          y={25}\n          width={50}\n          height={50}\n          fontSize={36}\n          text={`-`}\n          align={\"center\"}\n          verticalAlign={\"middle\"}\n          onClick={this.handleDecrement}\n          onTap={this.handleDecrement}\n        ></Text>\n        <Text\n          x={140}\n          y={25}\n          width={50}\n          height={50}\n          fontSize={36}\n          text={`+`}\n          align={\"center\"}\n          verticalAlign={\"middle\"}\n          onClick={this.handleIncrement}\n          onTap={this.handleIncrement}\n        ></Text>\n      </Group>\n    );\n  }\n\n  private cancelBubble = (event: KonvaEventObject<MouseEvent>) => {\n    event.cancelBubble = true;\n  };\n\n  private handleDecrement = () => {\n    this.props.updateCounterValueBy(-1);\n  };\n\n  private handleIncrement = () => {\n    this.props.updateCounterValueBy(1);\n  };\n\n  private handleTouchStart = (event: KonvaEventObject<TouchEvent>) => {\n    event.cancelBubble = true;\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n\n    this.touchTimer = setTimeout(() => {\n      this.props.handleContextMenu(\n        event as unknown as KonvaEventObject<PointerEvent>\n      );\n    }, 750);\n  };\n\n  private handleTouchMove = (event: KonvaEventObject<TouchEvent>) => {\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n  };\n\n  private handleTouchEnd = (event: KonvaEventObject<TouchEvent>) => {\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n  };\n}\n\nexport default Counter;\n","import { Component } from \"react\";\nimport * as React from \"react\";\nimport TextField from \"@material-ui/core/TextField\";\n\ninterface IProps {\n  loadDeckId: (id: number) => void;\n}\n\nclass DeckLoader extends Component<IProps> {\n  inputValue: string = \"\";\n\n  private focusInputField = (input: any) => {\n    if (input) {\n      setTimeout(() => {\n        input.querySelector(\"input\").focus();\n      }, 100);\n    }\n  };\n\n  render() {\n    return (\n      <div\n        onClick={this.cancelBubble}\n        onKeyPress={this.cancelBubble}\n        className=\"token-field-row\"\n      >\n        <TextField\n          ref={this.focusInputField}\n          onKeyPress={this.handleKeyPress}\n          onClick={this.cancelBubble}\n          onChange={(event) => {\n            this.inputValue = event.target.value;\n          }}\n          type=\"number\"\n          variant=\"outlined\"\n        ></TextField>{\" \"}\n      </div>\n    );\n  }\n\n  private cancelBubble = (event: React.SyntheticEvent) => {\n    event.stopPropagation();\n  };\n\n  private handleKeyPress = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key.toLocaleLowerCase() === \"enter\") {\n      this.props.loadDeckId(+this.inputValue);\n    }\n  };\n}\n\nexport default DeckLoader;\n","import { Component } from \"react\";\nimport * as React from \"react\";\nimport { IEncounterEntity } from \"./features/cards-data/cards-data.selectors\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { GamePropertiesMap } from \"./constants/game-type-properties-mapping\";\nimport { GameType } from \"./constants/app-constants\";\ninterface IProps {\n  currentGameType: GameType;\n  encounterData: IEncounterEntity[];\n  loadCards: (cards: string[][]) => void;\n}\n\nclass EncounterLoader extends Component<IProps> {\n  render() {\n    return (\n      <div onClick={this.cancelBubble} onKeyPress={this.cancelBubble}>\n        <Autocomplete\n          id=\"encounter-loader-combobox\"\n          groupBy={(option) => option.setData.setTypeCode}\n          options={this.props.encounterData || []}\n          getOptionLabel={(option) => option.setData.name}\n          style={{ width: 300 }}\n          onChange={this.handleSelected}\n          renderInput={(params) => (\n            <TextField\n              {...params}\n              label={\n                GamePropertiesMap[this.props.currentGameType].encounterUiName\n              }\n              variant=\"outlined\"\n            />\n          )}\n        />\n      </div>\n    );\n  }\n\n  private handleSelected = (_event: any, value: IEncounterEntity | null) => {\n    if (!!value) {\n      let questCards: string[] = [];\n      let encounterCards: string[] = [];\n      const filteredCards = value.cards\n        // We don't want cards that show up as another card's 'back_link' to be loaded as separate cards\n        .filter((c) => !value.cards.some((oc) => oc.backLink === c.code));\n\n      filteredCards\n        .filter((c) => c.typeCode.toLocaleLowerCase() === \"quest\")\n        .forEach((c) => {\n          questCards = questCards.concat(\n            Array.from({ length: c.quantity }).map((_i) => c.code)\n          );\n        });\n\n      filteredCards\n        .filter((c) => c.typeCode.toLocaleLowerCase() !== \"quest\")\n        .forEach((c) => {\n          encounterCards = encounterCards.concat(\n            Array.from({ length: c.quantity }).map((_i) => c.code)\n          );\n        });\n      let totalCards = [encounterCards];\n      if (questCards.length > 0) {\n        totalCards = [questCards].concat(totalCards);\n      }\n\n      this.props.loadCards(totalCards);\n    }\n  };\n\n  private cancelBubble = (event: React.SyntheticEvent) => {\n    event.stopPropagation();\n  };\n}\n\nexport default EncounterLoader;\n","import { connect } from \"react-redux\";\nimport { GameType } from \"./constants/app-constants\";\nimport EncounterLoader from \"./EncounterLoader\";\nimport {\n  getCardsDataEncounterEntitiesBySetCode,\n  getCardsDataSetDataAsEncounterEntities,\n} from \"./features/cards-data/cards-data.selectors\";\n\nimport { RootState } from \"./store/rootReducer\";\n\ninterface IProps {\n  currentGameType: GameType;\n}\n\nconst mapStateToProps = (state: RootState, ownProps: IProps) => {\n  return {\n    encounterData:\n      ownProps.currentGameType === GameType.LordOfTheRingsLivingCardGame\n        ? getCardsDataSetDataAsEncounterEntities(state)\n        : getCardsDataEncounterEntitiesBySetCode(state),\n  };\n};\n\nconst EncounterLoaderContainer = connect(mapStateToProps, {})(EncounterLoader);\n\nexport default EncounterLoaderContainer;\n","import { Component } from \"react\";\nimport * as React from \"react\";\nimport { Rect } from \"react-konva\";\nimport { Vector2d } from \"konva/lib/types\";\nimport { KonvaEventObject } from \"konva/lib/Node\";\nimport { GameType } from \"./constants/app-constants\";\n\ninterface IProps {\n  currentGameType: GameType;\n  pos: Vector2d;\n  updatePos: (newPos: Vector2d) => void;\n}\n\ninterface IState {\n  img: HTMLImageElement | null;\n}\n\nclass FirstPlayerToken extends Component<IProps, IState> {\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      img: null,\n    };\n  }\n\n  public componentDidMount() {\n    const image = new Image();\n    image.onload = () => {\n      this.setState({\n        img: image,\n      });\n    };\n    image.src =\n      process.env.PUBLIC_URL +\n      \"/images/table/first_player_token_\" +\n      this.props.currentGameType +\n      \".png\";\n  }\n\n  render() {\n    return (\n      <Rect\n        x={this.props.pos.x}\n        y={this.props.pos.y}\n        draggable={true}\n        onTouchStart={this.cancelBubble}\n        onMouseDown={this.cancelBubble}\n        onDragEnd={this.handleDragEnd}\n        scale={{\n          x: 160 / (this.state.img?.naturalWidth ?? 1),\n          y: 160 / (this.state.img?.naturalWidth ?? 1),\n        }}\n        width={this.state.img?.naturalWidth ?? 0}\n        height={this.state.img?.naturalHeight ?? 0}\n        fillPatternImage={this.state.img ?? undefined}\n      ></Rect>\n    );\n  }\n\n  private cancelBubble = (\n    e: KonvaEventObject<MouseEvent> | KonvaEventObject<TouchEvent>\n  ) => {\n    e.cancelBubble = true;\n  };\n\n  private handleDragEnd = (event: KonvaEventObject<DragEvent>) => {\n    this.props.updatePos({\n      x: event.target.x(),\n      y: event.target.y(),\n    });\n  };\n}\n\nexport default FirstPlayerToken;\n","import { createSelector } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../../store/rootReducer\";\n\nexport const getCounters = (state: RootState) =>\n  state.liveState.present.counters;\n\nexport const getCurrentCounters = createSelector(getCounters, (counters) => {\n  return counters.counters;\n});\n\nexport const getFirstPlayerTokenPos = createSelector(\n  getCounters,\n  (counters) => counters.firstPlayerCounterPosition\n);\n","import { connect } from \"react-redux\";\nimport FirstPlayerToken from \"./FirstPlayerToken\";\nimport { moveFirstPlayerCounter } from \"./features/counters/counters.slice\";\nimport { RootState } from \"./store/rootReducer\";\nimport { getFirstPlayerTokenPos } from \"./features/counters/counters.selectors\";\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    pos: getFirstPlayerTokenPos(state),\n  };\n};\n\nconst FirstPlayerTokenContainer = connect(mapStateToProps, {\n  updatePos: moveFirstPlayerCounter,\n})(FirstPlayerToken);\n\nexport default FirstPlayerTokenContainer;\n","import { Component } from \"react\";\nimport * as React from \"react\";\ninterface IProps {\n  connect: (peerId: string) => void;\n}\n\nclass PeerConnector extends Component<IProps> {\n  public inputRef: HTMLInputElement | null = null;\n\n  render() {\n    return (\n      <div onClick={this.cancelBubble} onKeyPress={this.cancelBubble}>\n        <input\n          ref={(ref) => {\n            if (!ref) return;\n            this.inputRef = ref;\n          }}\n        ></input>\n        <button onClick={this.connect}>Connect</button>\n      </div>\n    );\n  }\n\n  private connect = (_event: any) => {\n    console.log(\"connecting with peer id \" + this.inputRef?.value);\n\n    this.props.connect(this.inputRef?.value || \"\");\n  };\n\n  private cancelBubble = (event: React.SyntheticEvent) => {\n    event.stopPropagation();\n  };\n}\n\nexport default PeerConnector;\n","import { Vector2d } from \"konva/lib/types\";\nimport * as React from \"react\";\nimport { Component } from \"react\";\nimport \"./TopLayer.scss\";\n\ninterface IProps {\n  trasparentBackground?: boolean;\n  offsetContent?: boolean;\n  position: Vector2d;\n  completed: () => void;\n}\n\nclass TopLayer extends Component<IProps> {\n  render() {\n    const offset = this.props.offsetContent ? 8 : 0;\n    const containerStyle: React.CSSProperties = {\n      top: `${this.props.position.y + offset}px`,\n      left: `${this.props.position.x + offset}px`,\n    };\n\n    if (!this.props.trasparentBackground) {\n      containerStyle.backgroundColor = \"white\";\n    }\n\n    return (\n      <div\n        id=\"top-layer\"\n        onClick={this.props.completed}\n        onContextMenu={this.preventDefault}\n      >\n        <div\n          className=\"top-layer-content-wrapper\"\n          style={containerStyle}\n          onContextMenu={this.preventDefault}\n          onClick={this.handleClick}\n        >\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n\n  private handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.stopPropagation();\n    this.props.completed();\n  };\n\n  private preventDefault = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    event.preventDefault();\n  };\n}\n\nexport default TopLayer;\n","import { GameType, myPeerRef } from \"../constants/app-constants\";\nimport { StatusTokenType } from \"../constants/card-constants\";\nimport { MISSING_CARD_IMAGE_MAP } from \"../constants/card-missing-image-map\";\nimport { CARD_PACK_REMAPPING } from \"../constants/card-pack-mapping\";\nimport { CardData } from \"../external-api/common-card-data\";\nimport { ICardData } from \"../features/cards-data/initialState\";\nimport { ICardStack } from \"../features/cards/initialState\";\n\nexport const anyCardStackHasStatus = (\n  status: StatusTokenType,\n  stacks: ICardStack[]\n) => {\n  return stacks.length > 0 && stacks.some((s) => s.statusTokens[status]);\n};\n\nexport const getMySelectedCards = (stacks: ICardStack[]) => {\n  return stacks.filter((c) => c.selected && c.controlledBy === myPeerRef);\n};\n\nconst checkMissingImageMap = (code: string): string | null => {\n  return MISSING_CARD_IMAGE_MAP[code] ?? null;\n};\n\nconst generateLCGCDNImageUrl = (card: CardData, faceup: boolean): string => {\n  if (!card) {\n    return `https://lcgcdn.s3.amazonaws.com/mc/NOPE.jpg`;\n  }\n\n  // get the first two digits\n  let codeToUse = card.code;\n\n  if (!faceup && !!card.backLink) {\n    codeToUse = card.backLink;\n  }\n\n  const groupCode =\n    CARD_PACK_REMAPPING[card.extraInfo.packCode ?? \"\"] ??\n    codeToUse.substring(0, 2);\n  let cardCode = codeToUse.substring(2);\n\n  //trim leading \"0\" chars\n  while (cardCode[0] === \"0\") {\n    cardCode = cardCode.substring(1);\n  }\n\n  cardCode = cardCode.toLocaleUpperCase();\n\n  let cardSuffix = \"\";\n\n  if (!!card.doubleSided) {\n    cardSuffix = faceup ? \"A\" : \"B\";\n  }\n\n  return `https://lcgcdn.s3.amazonaws.com/mc/MC${groupCode}en_${cardCode}${cardSuffix}.jpg`;\n};\n\nexport const getImgUrls = (\n  card: ICardStack,\n  cardsData: ICardData,\n  currentGameType: GameType\n): string[] => {\n  if (Object.keys(cardsData).length === 0) return [];\n\n  let urls: string[] = [];\n\n  const topCardData = cardsData[card.cardStack[0].jsonId];\n\n  if (!topCardData) {\n    return [];\n  }\n\n  let cardData: CardData | null = topCardData;\n\n  if (!!cardData.images) {\n    if (!card.faceup) {\n      if (!cardData.images.back) {\n        return [\n          topCardData.extraInfo.factionCode === \"encounter\" ||\n          topCardData.typeCode === \"side_scheme\"\n            ? process.env.PUBLIC_URL +\n              \"/images/standard/encounter_card_back_\" +\n              currentGameType +\n              \".png\"\n            : process.env.PUBLIC_URL +\n              \"/images/standard/card_back_\" +\n              currentGameType +\n              \".png\",\n        ];\n      } else {\n        return [cardData.images.back];\n      }\n    } else {\n      return [cardData.images.front];\n    }\n  }\n\n  if (!card.faceup) {\n    if (!!topCardData.backLink || !!topCardData.doubleSided) {\n      urls = [\n        generateLCGCDNImageUrl(topCardData, card.faceup),\n        // `https://marvelcdb.com/bundles/cards/${bottomCardData.back_link}.png`,\n        // `https://marvelcdb.com/bundles/cards/${bottomCardData.back_link}.jpg`,\n        // process.env.PUBLIC_URL +\n        //   \"/images/cards/\" +\n        //   bottomCardData.octgn_id +\n        //   \".b.jpg\",\n      ];\n    } else {\n      cardData = null;\n      urls = [\n        topCardData.extraInfo.factionCode === \"encounter\" ||\n        topCardData.typeCode === \"side_scheme\"\n          ? process.env.PUBLIC_URL +\n            \"/images/standard/encounter_card_back_\" +\n            currentGameType +\n            \".png\"\n          : process.env.PUBLIC_URL +\n            \"/images/standard/card_back_\" +\n            currentGameType +\n            \".png\",\n      ];\n    }\n  } else {\n    urls = [\n      generateLCGCDNImageUrl(topCardData, card.faceup),\n      // `https://marvelcdb.com/bundles/cards/${topCardData.code}.png`,\n      // `https://marvelcdb.com/bundles/cards/${topCardData.code}.jpg`,\n      // process.env.PUBLIC_URL +\n      //   \"/images/cards/\" +\n      //   topCardData.octgn_id +\n      //   \".jpg\",\n    ];\n  }\n\n  let codeForMissingCheck = \"\";\n\n  if (!!cardData) {\n    if (card.faceup) {\n      codeForMissingCheck = cardData.code;\n    } else {\n      if (!!cardData.backLink) {\n        codeForMissingCheck = cardData.backLink;\n      } else if (cardData.doubleSided) {\n        codeForMissingCheck = `${cardData.code}_double_sided_back`;\n      }\n    }\n  }\n\n  const missingImageOverride = !!cardData\n    ? checkMissingImageMap(codeForMissingCheck)\n    : null;\n\n  if (!!missingImageOverride) {\n    urls.unshift(missingImageOverride);\n  }\n\n  return urls;\n};\n","import { Vector2d } from \"konva/lib/types\";\nimport React, { useState } from \"react\";\nimport TopLayer from \"./TopLayer\";\nimport { GameType } from \"./constants/app-constants\";\nimport {\n  GamePropertiesMap,\n  NumericTokenInfo,\n  TokenInfo,\n} from \"./constants/game-type-properties-mapping\";\nimport { CounterTokenType, StatusTokenType } from \"./constants/card-constants\";\nimport { DrawCardsOutOfCardStackPayload } from \"./features/cards/cards.thunks\";\nimport { ICardStack } from \"./features/cards/initialState\";\nimport { anyCardStackHasStatus } from \"./utilities/card-utils\";\nconst reactPieMenu = require(\"react-pie-menu\");\nconst PieMenu = reactPieMenu.default;\nconst { Slice } = reactPieMenu;\n\nenum MenuType {\n  TopLevelActions = \"toplevelactions\",\n  StatusTokenActions = \"statustokenactions\",\n  CounterTokenActions = \"countertokenactions\",\n  ModifierActions = \"modifieractions\",\n  DrawActions = \"drawactions\",\n  DrawNumber = \"drawnumber\",\n  ModifierNumber = \"modifiernumber\",\n  ModifierExtraIcons = \"modifierextraicons\",\n}\n\nenum DrawMode {\n  FaceUp = \"faceup\",\n  FaceDown = \"facedown\",\n}\n\ninterface IProps {\n  showCardSelector: (cardStack: ICardStack, isSelect: boolean) => void;\n  selectedCardStacks: ICardStack[];\n  currentGameType: GameType | null;\n  playerNumber: number;\n  position: Vector2d | null;\n  hideRadialMenu: () => void;\n  flipCards: () => void;\n  exhaustCard: (id?: string) => void;\n  deleteCardStack: (id?: string) => void;\n  shuffleStack: (id?: string) => void;\n  toggleToken: (payload: {\n    id?: string;\n    tokenType: StatusTokenType;\n    value?: boolean;\n  }) => void;\n  adjustCounterToken: (payload: {\n    id?: string;\n    tokenType: CounterTokenType;\n    delta?: number;\n    value?: number;\n  }) => void;\n  clearCardTokens: (id?: string) => void;\n  drawCardsOutOfCardStack: (payload: DrawCardsOutOfCardStackPayload) => void;\n  adjustModifier: (payload: {\n    id?: string;\n    modifierId: string;\n    delta?: number;\n    value?: number;\n  }) => void;\n  addToPlayerHand: (payload: { playerNumber: number }) => void;\n  drawCardsIntoHand: boolean;\n  toggleExtraIcon: (icon: string) => void;\n}\nconst RadialMenu = (props: IProps) => {\n  const [visibleMenu, setVisibleMenu] = useState(MenuType.TopLevelActions);\n  const [currentDrawMode, setCurrentDrawMode] = useState(DrawMode.FaceDown);\n  const [currentModifier, setCurrentModifier] = useState(\"\");\n\n  if (!props.position && visibleMenu !== MenuType.TopLevelActions) {\n    setVisibleMenu(MenuType.TopLevelActions);\n  }\n\n  return !!props.position ? (\n    <TopLayer\n      trasparentBackground={true}\n      offsetContent={false}\n      position={{\n        x: Math.max(props.position.x - 128, 0),\n        y: Math.max(props.position.y - 128, 0),\n      }}\n      completed={() => {\n        props.hideRadialMenu();\n      }}\n    >\n      <div\n        onClick={(event) => {\n          event.stopPropagation();\n          event.preventDefault();\n        }}\n      >\n        <PieMenu radius=\"156px\" centerRadius=\"30px\">\n          {renderMenuSlices(\n            visibleMenu,\n            setVisibleMenu,\n            currentDrawMode,\n            setCurrentDrawMode,\n            currentModifier,\n            setCurrentModifier,\n            props\n          )}\n        </PieMenu>\n      </div>\n    </TopLayer>\n  ) : null;\n};\n\nconst renderMenuSlices = (\n  visibleMenu: MenuType,\n  setVisibleMenu: (type: MenuType) => void,\n  currentDrawMode: DrawMode,\n  setCurrentDrawMode: (mode: DrawMode) => void,\n  currentModifier: string,\n  setCurrentModifer: (mod: string) => void,\n  props: IProps\n) => {\n  let slices: JSX.Element[] | null = null;\n  let backMenu: MenuType | null = null;\n\n  switch (visibleMenu) {\n    case MenuType.StatusTokenActions:\n      slices = renderStatusTokensMenu(props);\n      backMenu = MenuType.TopLevelActions;\n      break;\n    case MenuType.CounterTokenActions:\n      slices = renderCounterTokensMenu(props);\n      backMenu = MenuType.TopLevelActions;\n      break;\n    case MenuType.DrawActions:\n      slices = renderDrawMenu(props, setVisibleMenu, setCurrentDrawMode);\n      backMenu = MenuType.TopLevelActions;\n      break;\n    case MenuType.DrawNumber:\n      slices = renderDrawNumberMenu(props, currentDrawMode);\n      backMenu = MenuType.DrawActions;\n      break;\n    case MenuType.ModifierActions:\n      slices = renderModifierMenu(props, setVisibleMenu, setCurrentModifer);\n      backMenu = MenuType.TopLevelActions;\n      break;\n    case MenuType.ModifierNumber:\n      slices = renderModifierNumberMenu(props, currentModifier);\n      backMenu = MenuType.ModifierActions;\n      break;\n    case MenuType.ModifierExtraIcons:\n      slices = renderModifierExtraIconsMenu(props);\n      backMenu = MenuType.ModifierActions;\n      break;\n    case MenuType.TopLevelActions:\n    default:\n      slices = renderTopLevelMenu(props, setVisibleMenu);\n  }\n  if (!!backMenu) {\n    slices = renderMenuWithBackButton(slices, backMenu, setVisibleMenu);\n  }\n\n  return slices;\n};\n\nconst renderMenuWithBackButton = (\n  slices: JSX.Element[] | null,\n  backMenu: MenuType,\n  setVisibleMenu: (type: MenuType) => void\n): JSX.Element[] | null => {\n  if (!slices) return null;\n\n  const back = (\n    <Slice\n      key={\"back-slice\"}\n      onSelect={() => {\n        setVisibleMenu(backMenu);\n      }}\n    >\n      Back\n    </Slice>\n  );\n\n  return [back].concat(slices);\n};\n\nconst renderTopLevelMenu = (\n  props: IProps,\n  setVisibleMenu: (type: MenuType) => void\n) => {\n  if (!props.currentGameType) return null;\n\n  const modifiers = GamePropertiesMap[props.currentGameType].modifiers;\n\n  const slices = [\n    <Slice\n      key={\"flip-slice\"}\n      onSelect={() => {\n        props.flipCards();\n      }}\n    >\n      <div>\n        {/* <FlipIcon /> */}\n        <div>Flip</div>\n      </div>\n    </Slice>,\n    <Slice\n      key={\"delete-slice\"}\n      onSelect={() => {\n        props.deleteCardStack();\n      }}\n    >\n      <div>\n        <div>Delete</div>\n      </div>\n    </Slice>,\n    <Slice\n      key={\"exhaust-slice\"}\n      onSelect={() => {\n        props.exhaustCard();\n      }}\n    >\n      <div>\n        {/* <AutorenewIcon /> */}\n        <div>Exhaust</div>\n      </div>\n    </Slice>,\n    <Slice\n      key={\"shuffle-slice\"}\n      onSelect={() => {\n        props.shuffleStack();\n      }}\n    >\n      <div>\n        {/* <ShuffleIcon /> */}\n        <div>Shuffle</div>\n      </div>\n    </Slice>,\n    <Slice\n      key={\"statuses-slice\"}\n      onSelect={() => {\n        setVisibleMenu(MenuType.StatusTokenActions);\n      }}\n    >\n      <div>Statuses</div>\n    </Slice>,\n    <Slice\n      key={\"tokens-slice\"}\n      onSelect={() => {\n        setVisibleMenu(MenuType.CounterTokenActions);\n      }}\n    >\n      <div>Tokens</div>\n    </Slice>,\n    <Slice\n      key={\"clear-slice\"}\n      onSelect={() => {\n        props.clearCardTokens();\n      }}\n    >\n      <div>Clear</div>\n    </Slice>,\n    <Slice\n      key={\"draw-menu-slice\"}\n      onSelect={() => {\n        setVisibleMenu(MenuType.DrawActions);\n      }}\n    >\n      <div>Draw</div>\n    </Slice>,\n  ];\n\n  if (modifiers.length > 0) {\n    slices.push(\n      <Slice\n        key={\"modifiers-menu-slice\"}\n        onSelect={() => {\n          setVisibleMenu(MenuType.ModifierActions);\n        }}\n      >\n        <div>Modifiers</div>\n      </Slice>\n    );\n  }\n\n  return slices;\n};\n\nconst renderStatusTokensMenu = (props: IProps) => {\n  if (!props.currentGameType) {\n    return [<Slice></Slice>, <Slice></Slice>, <Slice></Slice>];\n  }\n\n  let slices = Object.values(GamePropertiesMap[props.currentGameType].tokens)\n    .filter(\n      (tokenInfo): tokenInfo is TokenInfo =>\n        !!tokenInfo && !(tokenInfo as NumericTokenInfo).isNumeric\n    )\n    .map((tokenInfo) => {\n      const action = () => {\n        props.toggleToken({\n          tokenType: tokenInfo.tokenType,\n          value: !anyCardStackHasStatus(\n            tokenInfo.tokenType,\n            props.selectedCardStacks\n          ),\n        });\n      };\n\n      let key = `touch-menu-slice-${tokenInfo.menuText\n        .replace(/\\s/g, \"\")\n        .toLocaleLowerCase()}`;\n\n      // key =\n      //   key + (tokenInfo.touchMenuLetter?.indexOf(\"+\") !== -1 ? \"-plus\" : \"\");\n      return (\n        <Slice key={key} onSelect={action}>\n          <div>\n            {!!tokenInfo.touchMenuIcon ? tokenInfo.touchMenuIcon : null}\n            <div>{tokenInfo.menuText}</div>\n          </div>\n        </Slice>\n      );\n    });\n\n  while (slices.length < 3) {\n    slices = slices.concat([\n      <Slice key={`extra-slice-${Math.random()}`}></Slice>,\n    ]);\n  }\n\n  return slices;\n};\n\nconst renderCounterTokensMenu = (props: IProps) => {\n  if (!props.currentGameType) {\n    return [<Slice></Slice>, <Slice></Slice>, <Slice></Slice>];\n  }\n  let slices = Object.values(GamePropertiesMap[props.currentGameType].tokens)\n    .filter(\n      (tokenInfo): tokenInfo is NumericTokenInfo =>\n        !!tokenInfo && (tokenInfo as NumericTokenInfo).isNumeric\n    )\n    .flatMap((tokenInfo) => {\n      const addTokenInfo = {\n        ...tokenInfo,\n        touchMenuLetter: `${tokenInfo.touchMenuLetter} +`,\n      };\n      const removeTokenInfo = {\n        ...tokenInfo,\n        touchMenuLetter: `${tokenInfo.touchMenuLetter} -`,\n      };\n      return [addTokenInfo, removeTokenInfo];\n    })\n    .map((tokenInfo) => {\n      const action = () => {\n        props.adjustCounterToken({\n          tokenType: tokenInfo.counterTokenType,\n          delta: tokenInfo.touchMenuLetter?.indexOf(\"+\") !== -1 ? 1 : -1,\n        });\n      };\n\n      let key = `touch-menu-slice-${tokenInfo.menuText\n        .replace(/\\s/g, \"\")\n        .toLocaleLowerCase()}`;\n\n      key =\n        key + (tokenInfo.touchMenuLetter?.indexOf(\"+\") !== -1 ? \"-plus\" : \"\");\n      return (\n        <Slice key={key} onSelect={action}>\n          <div>\n            {!!tokenInfo.touchMenuIcon ? tokenInfo.touchMenuIcon : null}\n            <div>{tokenInfo.touchMenuLetter}</div>\n          </div>\n        </Slice>\n      );\n    });\n\n  while (slices.length < 3) {\n    slices = slices.concat([\n      <Slice key={`extra-slice-${Math.random()}`}></Slice>,\n    ]);\n  }\n\n  return slices;\n};\n\nconst renderDrawMenu = (\n  props: IProps,\n  setVisibleMenu: (type: MenuType) => void,\n  setCurrentDrawMode: (mode: DrawMode) => void\n) => {\n  const drawMenu = [\n    <Slice\n      key={\"find-card-slice\"}\n      onSelect={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.showCardSelector(props.selectedCardStacks[0], false);\n          props.hideRadialMenu();\n        }\n      }}\n    >\n      Find Card\n    </Slice>,\n    <Slice\n      key={\"Select-cards-slice\"}\n      onSelect={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.showCardSelector(props.selectedCardStacks[0], true);\n          props.hideRadialMenu();\n        }\n      }}\n    >\n      Select Card\n    </Slice>,\n    <Slice\n      key={\"draw-one-faceup-slice\"}\n      onSelect={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.drawCardsOutOfCardStack({\n            cardStackId: props.selectedCardStacks[0].id,\n            numberToDraw: 1,\n            facedown: false,\n          });\n        }\n      }}\n    >\n      1 faceup\n    </Slice>,\n    <Slice\n      key={\"draw-one-facedown-slice\"}\n      onSelect={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.drawCardsOutOfCardStack({\n            cardStackId: props.selectedCardStacks[0].id,\n            numberToDraw: 1,\n            facedown: true,\n          });\n        }\n      }}\n    >\n      1 facedown\n    </Slice>,\n    <Slice\n      key={\"draw-x-faceup-slice\"}\n      onSelect={() => {\n        setCurrentDrawMode(DrawMode.FaceUp);\n        setVisibleMenu(MenuType.DrawNumber);\n      }}\n    >\n      X faceup\n    </Slice>,\n    <Slice\n      key={\"draw-x-facedown-slice\"}\n      onSelect={() => {\n        setCurrentDrawMode(DrawMode.FaceDown);\n        setVisibleMenu(MenuType.DrawNumber);\n      }}\n    >\n      X facedown\n    </Slice>,\n    <Slice\n      key={\"add-to-hand-slice\"}\n      onSelect={() => {\n        props.addToPlayerHand({\n          playerNumber: props.playerNumber,\n        });\n      }}\n    >\n      All to hand\n    </Slice>,\n  ];\n\n  return drawMenu.filter((mi) => {\n    if (\n      !!mi.key &&\n      mi.key.toString().includes(\"facedown\") &&\n      props.drawCardsIntoHand\n    ) {\n      return false;\n    } else {\n      return true;\n    }\n  });\n};\n\nconst renderDrawNumberMenu = (props: IProps, currentDrawMode: DrawMode) => {\n  return Array.from({ length: 10 }, (_, i) => i + 1).map((num) => {\n    return (\n      <Slice\n        key={`draw-${num}-cards-slice`}\n        onSelect={() => {\n          if (props.selectedCardStacks.length === 1) {\n            props.drawCardsOutOfCardStack({\n              cardStackId: props.selectedCardStacks[0].id,\n              numberToDraw: num,\n              facedown: currentDrawMode === DrawMode.FaceDown,\n            });\n          }\n        }}\n      >\n        {num}\n      </Slice>\n    );\n  });\n};\n\nconst renderModifierMenu = (\n  props: IProps,\n  setVisibleMenu: (type: MenuType) => void,\n  setCurrentModifier: (mod: string) => void\n) => {\n  if (!props.currentGameType) return null;\n\n  const possibleIcons = GamePropertiesMap[props.currentGameType].possibleIcons;\n\n  return GamePropertiesMap[props.currentGameType].modifiers\n    .map((m) => {\n      return (\n        <Slice\n          key={\"modifier-slice\"}\n          onSelect={() => {\n            setCurrentModifier(m.attributeId);\n            setVisibleMenu(MenuType.ModifierNumber);\n          }}\n        >\n          {m.attributeName}\n        </Slice>\n      );\n    })\n    .concat(\n      possibleIcons.length > 0\n        ? [\n            <Slice\n              key={\"extra-icons-slice\"}\n              onSelect={() => {\n                setVisibleMenu(MenuType.ModifierExtraIcons);\n              }}\n            >\n              Extra Icons\n            </Slice>,\n          ]\n        : []\n    );\n};\n\nconst renderModifierNumberMenu = (props: IProps, currentModifier: string) => {\n  const basicNums = [\n    <Slice\n      key={`modifier-plus-one-slice`}\n      onSelect={() => {\n        props.adjustModifier({ modifierId: currentModifier, delta: 1 });\n      }}\n    >\n      Add 1\n    </Slice>,\n    <Slice\n      key={`modifier-minus-one-slice`}\n      onSelect={() => {\n        props.adjustModifier({ modifierId: currentModifier, delta: -1 });\n      }}\n    >\n      Remove 1\n    </Slice>,\n    <Slice\n      key={`modifier-zero-slice`}\n      onSelect={() => {\n        props.adjustModifier({ modifierId: currentModifier, value: 0 });\n      }}\n    >\n      0\n    </Slice>,\n  ];\n\n  const allNums = basicNums\n    .concat(\n      Array.from({ length: 3 }, (_, i) => i + 1).map((num) => {\n        return (\n          <Slice\n            key={`modifier-pos-${num}-cards-slice`}\n            onSelect={() => {\n              props.adjustModifier({ modifierId: currentModifier, value: num });\n            }}\n          >\n            {num}\n          </Slice>\n        );\n      })\n    )\n    .concat(\n      Array.from({ length: 3 }, (_, i) => i + 1).map((num) => {\n        return (\n          <Slice\n            key={`modifier-neg-${num}-cards-slice`}\n            onSelect={() => {\n              props.adjustModifier({\n                modifierId: currentModifier,\n                value: num * -1,\n              });\n            }}\n          >\n            {num * -1}\n          </Slice>\n        );\n      })\n    );\n\n  return allNums;\n};\n\nconst renderModifierExtraIconsMenu = (props: IProps) => {\n  if (!props.currentGameType) return null;\n\n  const allIcons = GamePropertiesMap[props.currentGameType].possibleIcons.map(\n    (icon) => (\n      <Slice\n        key={`modifier-extra-icon-${icon.iconId}`}\n        onSelect={() => {\n          props.toggleExtraIcon(icon.iconId);\n        }}\n      >\n        {icon.iconName}\n      </Slice>\n    )\n  );\n  return allIcons;\n};\n\nexport default RadialMenu;\n","import { connect } from \"react-redux\";\nimport {\n  reorderPlayerHand,\n  removeFromPlayerHand,\n} from \"./features/cards/cards.slice\";\nimport { getPlayerCardsForPlayerNumber } from \"./features/cards/cards.selectors\";\nimport PlayerHand from \"./PlayerHand\";\nimport { RootState } from \"./store/rootReducer\";\nimport { getCardsDataEntities } from \"./features/cards-data/cards-data.selectors\";\nimport { getGame } from \"./features/game/game.selectors\";\nimport {\n  setMenuPreviewCardJsonId,\n  clearMenuPreviewCardJsonId,\n  stopDraggingCardFromHand,\n} from \"./features/game/game.slice\";\nimport { startDraggingCardFromHand } from \"./store/global.actions\";\ninterface IProps {\n  playerNumber: number;\n}\n\nconst mapStateToProps = (state: RootState, ownProps: IProps) => {\n  return {\n    playerHandData: getPlayerCardsForPlayerNumber(ownProps.playerNumber)(state),\n    cardData: getCardsDataEntities(state),\n    currentGameType: getGame(state).activeGameType,\n    dragging: getGame(state).draggingCardFromHand,\n    ...ownProps,\n  };\n};\n\nconst PlayerHandContainer = connect(mapStateToProps, {\n  reorderPlayerHand,\n  removeFromPlayerHand,\n  setPreviewCardJsonId: setMenuPreviewCardJsonId,\n  clearPreviewCardJsonId: clearMenuPreviewCardJsonId,\n  startDraggingCardFromHand,\n  stopDraggingCardFromHand,\n})(PlayerHand);\n\nexport default PlayerHandContainer;\n","import * as React from \"react\";\nimport { Vector2d } from \"konva/lib/types\";\nimport cloneDeep from \"lodash.clonedeep\";\n\nexport interface MenuDataItem {\n  rot: number;\n  renderType: RenderType;\n  // orbit: number;\n}\nexport interface MenuData {\n  [key: string]: MenuDataItem;\n}\n\nexport enum RenderType {\n  Normal = \"normal\",\n  LeftFan = \"leftfan\",\n  RightFan = \"rightfan\",\n  TopFan = \"topfan\",\n  BottomFan = \"bottomfan\",\n  LowerRightFan = \"lowerrightfan\",\n  LowerLeftFan = \"lowerleftfan\",\n  UpperRightFan = \"upperrightfan\",\n  UpperLeftFan = \"upperleftfan\",\n}\n\nexport const minScreenOffset = 128;\nexport const maxScreenOffset = 190;\n\nconst secondaryThreshold = 200;\n\nexport const getRenderTypeByPosition = (pos: Vector2d | null): RenderType => {\n  if (!pos) return RenderType.Normal;\n\n  // If the screen is \"landscape, prefer left/right fans, if the screen is widescreen, prefer top/bottom fans\n  let primaryCoord: number;\n  let primaryMax: number;\n  let secondaryCoord: number;\n  let secondaryMax: number;\n  let lowerHalfFanType: RenderType;\n  let upperHalfFanType: RenderType;\n  let secondaryLowerHalfFanType: RenderType;\n  let secondaryUpperHalfFanType: RenderType;\n  let corner1FanType: RenderType;\n  let corner2FanType: RenderType;\n\n  if (window.visualViewport.height <= window.visualViewport.width) {\n    primaryCoord = pos.y;\n    primaryMax = window.visualViewport.height;\n    secondaryCoord = pos.x;\n    secondaryMax = window.visualViewport.width;\n    lowerHalfFanType = RenderType.BottomFan;\n    upperHalfFanType = RenderType.TopFan;\n    secondaryLowerHalfFanType = RenderType.RightFan;\n    secondaryUpperHalfFanType = RenderType.LeftFan;\n    corner1FanType = RenderType.UpperRightFan;\n    corner2FanType = RenderType.LowerLeftFan;\n  } else {\n    primaryCoord = pos.x;\n    primaryMax = window.visualViewport.width;\n    secondaryCoord = pos.y;\n    secondaryMax = window.visualViewport.height;\n    lowerHalfFanType = RenderType.RightFan;\n    upperHalfFanType = RenderType.LeftFan;\n    secondaryLowerHalfFanType = RenderType.BottomFan;\n    secondaryUpperHalfFanType = RenderType.TopFan;\n    corner1FanType = RenderType.LowerLeftFan;\n    corner2FanType = RenderType.UpperRightFan;\n  }\n\n  let renderType = RenderType.Normal;\n\n  // first, if we're close enough to both extremes (in a corner) do that fan\n  if (\n    secondaryCoord < secondaryThreshold &&\n    primaryCoord < secondaryThreshold\n  ) {\n    renderType = RenderType.LowerRightFan;\n  } else if (\n    secondaryCoord > secondaryMax - secondaryThreshold &&\n    primaryCoord > primaryMax - secondaryThreshold\n  ) {\n    renderType = RenderType.UpperLeftFan;\n  } else if (\n    secondaryCoord < secondaryThreshold &&\n    primaryCoord > primaryMax - secondaryThreshold\n  ) {\n    renderType = corner1FanType;\n  } else if (\n    secondaryCoord > secondaryMax - secondaryThreshold &&\n    primaryCoord < secondaryThreshold\n  ) {\n    renderType = corner2FanType;\n  }\n\n  // next, if we're withing some threshold of the secondary axis extremes, and close enough\n  // to the middle of the primary axis, then use the secondary fan types\n  else if (\n    secondaryCoord < secondaryThreshold &&\n    primaryCoord >= secondaryThreshold &&\n    primaryCoord <= primaryMax - secondaryThreshold\n  ) {\n    renderType = secondaryLowerHalfFanType;\n  } else if (\n    secondaryCoord > secondaryMax - secondaryThreshold &&\n    primaryCoord >= secondaryThreshold &&\n    primaryCoord <= primaryMax - secondaryThreshold\n  ) {\n    renderType = secondaryUpperHalfFanType;\n  } else if (primaryCoord < primaryMax / 2) {\n    renderType = lowerHalfFanType;\n  } else {\n    renderType = upperHalfFanType;\n  }\n  return renderType;\n};\n\nexport const getRotFromRenderType = (renderType: RenderType): number => {\n  let rot = 0;\n  switch (renderType) {\n    case RenderType.RightFan:\n      rot = 0;\n      break;\n    case RenderType.LowerRightFan:\n      rot = 30;\n      break;\n    case RenderType.BottomFan:\n      rot = 90;\n      break;\n    case RenderType.LowerLeftFan:\n      rot = 110;\n      break;\n    case RenderType.LeftFan:\n      rot = 180;\n      break;\n    case RenderType.UpperLeftFan:\n      rot = 205;\n      break;\n    case RenderType.TopFan:\n      rot = 270;\n      break;\n    case RenderType.UpperRightFan:\n      rot = 300;\n      break;\n  }\n\n  return rot;\n};\n\nexport const convertItemsToFanType = (\n  items: JSX.Element[],\n  renderType: RenderType\n) => {\n  const extraNodes =\n    renderType === RenderType.LowerLeftFan ||\n    renderType === RenderType.LowerRightFan ||\n    renderType === RenderType.UpperLeftFan ||\n    renderType === RenderType.UpperRightFan\n      ? 4\n      : 0;\n\n  items = Array(items.length)\n    .map(() => {\n      return <div></div>;\n    })\n    .concat(\n      Array(extraNodes).map(() => {\n        return <div></div>;\n      })\n    )\n    .concat(items);\n  return items;\n};\n\nexport const updateMenuDataForEvent = (\n  evt: React.MouseEvent<HTMLDivElement>,\n  key: string,\n  menuData: MenuData,\n  setMenuData: (d: MenuData) => void\n) => {\n  const clonedMenuData = cloneDeep(menuData);\n  const rT = getRenderTypeByPosition({\n    x: evt.clientX,\n    y: evt.clientY,\n  });\n  const rot = getRotFromRenderType(rT);\n  clonedMenuData[key] = {\n    renderType: rT,\n    rot,\n  };\n  setMenuData(clonedMenuData);\n};\n","import { Vector2d } from \"konva/lib/types\";\nimport React, { useState } from \"react\";\nimport TopLayer from \"./TopLayer\";\nimport { GameType } from \"./constants/app-constants\";\nimport {\n  GamePropertiesMap,\n  NumericTokenInfo,\n  TokenInfo,\n} from \"./constants/game-type-properties-mapping\";\nimport { CounterTokenType, StatusTokenType } from \"./constants/card-constants\";\nimport { DrawCardsOutOfCardStackPayload } from \"./features/cards/cards.thunks\";\nimport { ICardStack } from \"./features/cards/initialState\";\nimport { anyCardStackHasStatus } from \"./utilities/card-utils\";\nimport { Planet } from \"react-planet\";\nimport \"./PlanetMenu.scss\";\nimport {\n  convertItemsToFanType,\n  getRenderTypeByPosition,\n  getRotFromRenderType,\n  MenuData,\n  RenderType,\n  updateMenuDataForEvent,\n} from \"./PlanetMenuUtils\";\n\nenum DrawMode {\n  FaceUp = \"faceup\",\n  FaceDown = \"facedown\",\n}\n\ninterface IProps {\n  showCardSelector: (cardStack: ICardStack, isSelect: boolean) => void;\n  selectedCardStacks: ICardStack[];\n  currentGameType: GameType | null;\n  position: Vector2d | null;\n  hideRadialMenu: () => void;\n  flipCards: () => void;\n  exhaustCard: (id?: string) => void;\n  deleteCardStack: (id?: string) => void;\n  shuffleStack: (id?: string) => void;\n  toggleToken: (payload: {\n    id?: string;\n    tokenType: StatusTokenType;\n    value?: boolean;\n  }) => void;\n  adjustCounterToken: (payload: {\n    id?: string;\n    tokenType: CounterTokenType;\n    delta?: number;\n    value?: number;\n  }) => void;\n  clearCardTokens: (id?: string) => void;\n  drawCardsOutOfCardStack: (payload: DrawCardsOutOfCardStackPayload) => void;\n  adjustModifier: (payload: {\n    id?: string;\n    modifierId: string;\n    delta?: number;\n    value?: number;\n  }) => void;\n}\n\nconst PlanetMenu = (props: IProps) => {\n  const [menuData, setMenuData] = useState({} as MenuData);\n\n  const initialPosition = props.position\n    ? {\n        x: props.position.x - 32,\n        y: props.position.y - 32,\n      }\n    : { x: 0, y: 0 };\n\n  const renderType: RenderType = getRenderTypeByPosition(props.position);\n  const rot = getRotFromRenderType(renderType);\n\n  let orbitRadius: number | undefined = 190;\n  if (renderType === RenderType.Normal) {\n    orbitRadius = undefined;\n  }\n\n  return !!props.position ? (\n    <TopLayer\n      trasparentBackground={true}\n      offsetContent={false}\n      position={initialPosition}\n      completed={() => {\n        props.hideRadialMenu();\n      }}\n    >\n      <div\n        onClick={(event) => {\n          event.stopPropagation();\n          event.preventDefault();\n        }}\n      >\n        <Planet\n          centerContent={\n            <div\n              style={{\n                display: \"none\",\n              }}\n            />\n          }\n          open\n          hideOrbit\n          orbitRadius={orbitRadius}\n          rotation={rot}\n        >\n          {renderTopLevelMenu(props, menuData, setMenuData)}\n        </Planet>\n      </div>\n    </TopLayer>\n  ) : null;\n};\n\nconst setParentPlanetZIndex = (\n  evt: React.MouseEvent<HTMLDivElement, MouseEvent>\n) => {\n  const parent = getParentPlanet(evt);\n  if (parent) parent.style.zIndex = \"3\";\n};\n\nconst clearParentPlanetZIndex = (\n  evt: React.MouseEvent<HTMLDivElement | HTMLDocument, MouseEvent>\n) => {\n  const parent = getParentPlanet(evt);\n  if (parent) parent.style.zIndex = \"\";\n};\n\nconst getParentPlanet = (\n  evt: React.MouseEvent<HTMLDivElement | HTMLDocument, MouseEvent>\n): HTMLElement | undefined => {\n  let parent = (evt.target as any).closest(\".makeStyles-root-3\");\n  if (!parent) {\n    parent = (evt.target as any)\n      .closest(\"div[class*=jss]\")\n      .parentNode?.parentNode?.closest(\"div[class*=jss]\");\n  }\n  return parent;\n};\n\nconst renderTopLevelMenu = (\n  props: IProps,\n  menuData: MenuData,\n  setMenuData: (d: MenuData) => void\n) => {\n  if (!props.currentGameType) return null;\n\n  const modifiers = GamePropertiesMap[props.currentGameType].modifiers;\n\n  let topLevelPlanets = [\n    <Planet\n      key={\"flip-slice\"}\n      onClick={() => {\n        props.flipCards();\n      }}\n      centerContent={<div className=\"menu-orbit-item\">Flip</div>}\n    ></Planet>,\n    <Planet\n      key={\"draw-menu-slice\"}\n      centerContent={\n        <div\n          onClick={(evt) => {\n            setParentPlanetZIndex(evt);\n            updateMenuDataForEvent(evt, \"draw\", menuData, setMenuData);\n          }}\n          className=\"menu-orbit-item\"\n        >\n          Draw\n        </div>\n      }\n      hideOrbit\n      autoClose\n      onClose={clearParentPlanetZIndex}\n      rotation={menuData[\"draw\"]?.rot ?? 0}\n      orbitRadius={150}\n    >\n      {convertItemsToFanType(\n        renderDrawMenu(props),\n        menuData[\"draw\"]?.renderType ?? RenderType.Normal\n      )}\n    </Planet>,\n    <Planet\n      key={\"shuffle-slice\"}\n      onClick={() => {\n        props.shuffleStack();\n      }}\n      centerContent={<div className=\"menu-orbit-item\">Shuffle</div>}\n    ></Planet>,\n    <Planet\n      key={\"clear-slice\"}\n      onClick={() => {\n        props.clearCardTokens();\n      }}\n      centerContent={<div className=\"menu-orbit-item\">Clear</div>}\n    ></Planet>,\n    <Planet\n      key={\"tokens-slice\"}\n      centerContent={\n        <div\n          onClick={(evt) => {\n            setParentPlanetZIndex(evt);\n            updateMenuDataForEvent(evt, \"tokens\", menuData, setMenuData);\n          }}\n          className=\"menu-orbit-item\"\n        >\n          Tokens\n        </div>\n      }\n      hideOrbit\n      autoClose\n      onClose={clearParentPlanetZIndex}\n      rotation={menuData[\"tokens\"]?.rot ?? 0}\n      orbitRadius={150}\n    >\n      {convertItemsToFanType(\n        renderCounterTokensMenu(props),\n        menuData[\"tokens\"]?.renderType ?? RenderType.Normal\n      )}\n    </Planet>,\n    <Planet\n      key={\"statuses-slice\"}\n      centerContent={\n        <div\n          onClick={(evt) => {\n            setParentPlanetZIndex(evt);\n            updateMenuDataForEvent(evt, \"statuses\", menuData, setMenuData);\n          }}\n          className=\"menu-orbit-item\"\n        >\n          Statuses\n        </div>\n      }\n      hideOrbit\n      autoClose\n      onClose={clearParentPlanetZIndex}\n      rotation={menuData[\"statuses\"]?.rot ?? 0}\n      orbitRadius={150}\n    >\n      {convertItemsToFanType(\n        renderStatusTokensMenu(props),\n        menuData[\"statuses\"]?.renderType ?? RenderType.Normal\n      )}\n    </Planet>,\n    <Planet\n      key={\"exhaust-slice\"}\n      onClick={() => {\n        props.exhaustCard();\n      }}\n      centerContent={<div className=\"menu-orbit-item\">Exhaust</div>}\n    ></Planet>,\n    <Planet\n      key={\"delete-slice\"}\n      onClick={() => {\n        props.deleteCardStack();\n      }}\n      centerContent={<div className=\"menu-orbit-item\">Delete</div>}\n    ></Planet>,\n  ];\n\n  if (modifiers.length > 0) {\n    topLevelPlanets.push(\n      <Planet\n        key={\"modifiers-menu-slice\"}\n        centerContent={\n          <div\n            onClick={(evt) => {\n              setParentPlanetZIndex(evt);\n              updateMenuDataForEvent(evt, \"modifiers\", menuData, setMenuData);\n            }}\n            className=\"menu-orbit-item\"\n          >\n            Modifiers\n          </div>\n        }\n        hideOrbit\n        autoClose\n        onClose={clearParentPlanetZIndex}\n        rotation={menuData[\"modifiers\"]?.rot ?? 0}\n        orbitRadius={150}\n      >\n        {convertItemsToFanType(\n          renderModifierMenu(props) ?? [],\n          menuData[\"modifiers\"]?.renderType ?? RenderType.Normal\n        )}\n      </Planet>\n    );\n  }\n  return convertItemsToFanType(\n    topLevelPlanets,\n    menuData[\"modifiers\"]?.renderType ?? RenderType.Normal\n  );\n};\n\nconst renderStatusTokensMenu = (props: IProps) => {\n  if (!props.currentGameType) {\n    return [];\n  }\n\n  let slices = Object.values(GamePropertiesMap[props.currentGameType].tokens)\n    .filter(\n      (tokenInfo): tokenInfo is TokenInfo =>\n        !!tokenInfo && !(tokenInfo as NumericTokenInfo).isNumeric\n    )\n    .map((tokenInfo) => {\n      const action = () => {\n        props.toggleToken({\n          tokenType: tokenInfo.tokenType,\n          value: !anyCardStackHasStatus(\n            tokenInfo.tokenType,\n            props.selectedCardStacks\n          ),\n        });\n      };\n\n      let key = `touch-menu-slice-${tokenInfo.menuText\n        .replace(/\\s/g, \"\")\n        .toLocaleLowerCase()}`;\n\n      // key =\n      //   key + (tokenInfo.touchMenuLetter?.indexOf(\"+\") !== -1 ? \"-plus\" : \"\");\n      return (\n        <div\n          className=\"menu-orbit-item nested-menu-item\"\n          key={key}\n          onClick={action}\n        >\n          <div>{tokenInfo.menuText}</div>\n        </div>\n      );\n    });\n\n  return slices;\n};\n\nconst renderCounterTokensMenu = (props: IProps) => {\n  if (!props.currentGameType) {\n    return [];\n  }\n  let slices = Object.values(GamePropertiesMap[props.currentGameType].tokens)\n    .filter(\n      (tokenInfo): tokenInfo is NumericTokenInfo =>\n        !!tokenInfo && (tokenInfo as NumericTokenInfo).isNumeric\n    )\n    .flatMap((tokenInfo) => {\n      const addTokenInfo = {\n        ...tokenInfo,\n        touchMenuLetter: `${tokenInfo.touchMenuLetter} +`,\n      };\n      const removeTokenInfo = {\n        ...tokenInfo,\n        touchMenuLetter: `${tokenInfo.touchMenuLetter} -`,\n      };\n      return [addTokenInfo, removeTokenInfo];\n    })\n    .map((tokenInfo) => {\n      const action = () => {\n        props.adjustCounterToken({\n          tokenType: tokenInfo.counterTokenType,\n          delta: tokenInfo.touchMenuLetter?.indexOf(\"+\") !== -1 ? 1 : -1,\n        });\n      };\n\n      let key = `touch-menu-slice-${tokenInfo.menuText\n        .replace(/\\s/g, \"\")\n        .toLocaleLowerCase()}`;\n\n      key =\n        key + (tokenInfo.touchMenuLetter?.indexOf(\"+\") !== -1 ? \"-plus\" : \"\");\n      return (\n        <div\n          className=\"menu-orbit-item nested-menu-item\"\n          key={key}\n          onClick={action}\n        >\n          <div>{tokenInfo.touchMenuLetter}</div>\n        </div>\n      );\n    });\n\n  return slices;\n};\n\nconst renderDrawMenu = (props: IProps) => {\n  return [\n    <Planet\n      key={\"find-card-slice\"}\n      centerContent={\n        <div className=\"menu-orbit-item nested-menu-item\">Find Card</div>\n      }\n      onClick={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.showCardSelector(props.selectedCardStacks[0], false);\n          props.hideRadialMenu();\n        }\n      }}\n    />,\n    <Planet\n      key={\"select-card-slice\"}\n      centerContent={\n        <div className=\"menu-orbit-item nested-menu-item\">Select Card</div>\n      }\n      onClick={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.showCardSelector(props.selectedCardStacks[0], true);\n          props.hideRadialMenu();\n        }\n      }}\n    />,\n    <Planet\n      key={\"draw-one-faceup-slice\"}\n      centerContent={\n        <div className=\"menu-orbit-item nested-menu-item\">1 faceup</div>\n      }\n      onClick={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.drawCardsOutOfCardStack({\n            cardStackId: props.selectedCardStacks[0].id,\n            numberToDraw: 1,\n            facedown: false,\n          });\n        }\n      }}\n    />,\n    <Planet\n      key={\"draw-one-facedown-slice\"}\n      centerContent={\n        <div className=\"menu-orbit-item nested-menu-item\">1 facedown</div>\n      }\n      onClick={() => {\n        if (props.selectedCardStacks.length === 1) {\n          props.drawCardsOutOfCardStack({\n            cardStackId: props.selectedCardStacks[0].id,\n            numberToDraw: 1,\n            facedown: true,\n          });\n        }\n      }}\n    />,\n    <Planet\n      key={\"draw-x-faceup-slice\"}\n      centerContent={\n        <div\n          onClick={setParentPlanetZIndex}\n          className=\"menu-orbit-item nested-menu-item\"\n        >\n          X faceup\n        </div>\n      }\n      onClose={clearParentPlanetZIndex}\n      autoClose\n      hideOrbit\n    >\n      {renderDrawNumberMenu(props, DrawMode.FaceUp)}\n    </Planet>,\n    <Planet\n      key={\"draw-x-faceup-slice\"}\n      centerContent={\n        <div\n          onClick={setParentPlanetZIndex}\n          className=\"menu-orbit-item nested-menu-item\"\n        >\n          X facedown\n        </div>\n      }\n      onClose={clearParentPlanetZIndex}\n      autoClose\n      hideOrbit\n    >\n      {renderDrawNumberMenu(props, DrawMode.FaceDown)}\n    </Planet>,\n  ];\n};\n\nconst renderDrawNumberMenu = (props: IProps, currentDrawMode: DrawMode) => {\n  return Array.from({ length: 10 }, (_, i) => i + 1).map((num) => {\n    return (\n      <div\n        key={`draw-${num}-cards-slice`}\n        className=\"menu-orbit-item double-nested-menu-item\"\n        onClick={() => {\n          if (props.selectedCardStacks.length === 1) {\n            props.drawCardsOutOfCardStack({\n              cardStackId: props.selectedCardStacks[0].id,\n              numberToDraw: num,\n              facedown: currentDrawMode === DrawMode.FaceDown,\n            });\n          }\n        }}\n      >\n        {num}\n      </div>\n    );\n  });\n};\n\nconst renderModifierMenu = (props: IProps) => {\n  if (!props.currentGameType) return null;\n  return GamePropertiesMap[props.currentGameType].modifiers.map((m) => {\n    return (\n      <Planet\n        key={\"modifier-slice\"}\n        centerContent={\n          <div\n            onClick={setParentPlanetZIndex}\n            className=\"menu-orbit-item nested-menu-item\"\n          >\n            {m.attributeName}\n          </div>\n        }\n        onClose={clearParentPlanetZIndex}\n        autoClose\n        hideOrbit\n      >\n        {renderModifierNumberMenu(props, m.attributeId)}\n      </Planet>\n    );\n  });\n};\n\nconst renderModifierNumberMenu = (props: IProps, currentModifier: string) => {\n  const basicNums = [\n    <div\n      key={`modifier-plus-one-slice`}\n      className=\"menu-orbit-item double-nested-menu-item\"\n      onClick={() => {\n        props.adjustModifier({ modifierId: currentModifier, delta: 1 });\n      }}\n    >\n      Add 1\n    </div>,\n    <div\n      key={`modifier-minus-one-slice`}\n      className=\"menu-orbit-item double-nested-menu-item\"\n      onClick={() => {\n        props.adjustModifier({ modifierId: currentModifier, delta: -1 });\n      }}\n    >\n      Remove 1\n    </div>,\n    <div\n      key={`modifier-zero-slice`}\n      className=\"menu-orbit-item double-nested-menu-item\"\n      onClick={() => {\n        props.adjustModifier({ modifierId: currentModifier, value: 0 });\n      }}\n    >\n      0\n    </div>,\n  ];\n\n  const allNums = basicNums\n    .concat(\n      Array.from({ length: 3 }, (_, i) => i + 1).map((num) => {\n        return (\n          <div\n            key={`modifier-pos-${num}-cards-slice`}\n            className=\"menu-orbit-item double-nested-menu-item\"\n            onClick={() => {\n              props.adjustModifier({ modifierId: currentModifier, value: num });\n            }}\n          >\n            {num}\n          </div>\n        );\n      })\n    )\n    .concat(\n      Array.from({ length: 3 }, (_, i) => i + 1).map((num) => {\n        return (\n          <div\n            key={`modifier-neg-${num}-cards-slice`}\n            className=\"menu-orbit-item double-nested-menu-item\"\n            onClick={() => {\n              props.adjustModifier({\n                modifierId: currentModifier,\n                value: num * -1,\n              });\n            }}\n          >\n            {num * -1}\n          </div>\n        );\n      })\n    );\n\n  return allNums;\n};\n\nexport default PlanetMenu;\n","import { connect } from \"react-redux\";\nimport { myPeerRef } from \"./constants/app-constants\";\nimport { cardsSelectedWithPeerRef } from \"./features/cards/cards.selectors\";\nimport {\n  exhaustCard,\n  deleteCardStack,\n  flipCards,\n  toggleToken,\n  adjustCounterToken,\n  clearCardTokens,\n  adjustModifier,\n  addToPlayerHand,\n  toggleExtraIcon,\n} from \"./features/cards/cards.slice\";\nimport {\n  shuffleStack,\n  drawCardsOutOfCardStack,\n} from \"./features/cards/cards.thunks\";\nimport { getGame, getRadialMenuPosition } from \"./features/game/game.selectors\";\nimport { hideRadialMenu } from \"./features/game/game.slice\";\nimport RadialMenu from \"./RadialMenu\";\nimport PlanetMenu from \"./PlanetMenu\";\nimport { RootState } from \"./store/rootReducer\";\n\nconst usePlanetMenu = false;\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    selectedCardStacks: cardsSelectedWithPeerRef(myPeerRef)(state),\n    currentGameType: getGame(state).activeGameType,\n    position: getRadialMenuPosition(state),\n    playerNumber: getGame(state).playerNumbers[myPeerRef],\n    drawCardsIntoHand: getGame(state).drawCardsIntoHand,\n  };\n};\n\nconst RadialMenuContainer = connect(mapStateToProps, {\n  flipCards,\n  exhaustCard,\n  deleteCardStack,\n  toggleToken,\n  shuffleStack,\n  adjustCounterToken,\n  hideRadialMenu,\n  clearCardTokens,\n  drawCardsOutOfCardStack,\n  adjustModifier,\n  addToPlayerHand,\n  toggleExtraIcon,\n})(usePlanetMenu ? PlanetMenu : RadialMenu);\n\nexport default RadialMenuContainer;\n","import { TextField } from \"@material-ui/core\";\nimport {\n  Autocomplete,\n  AutocompleteHighlightChangeReason,\n} from \"@material-ui/lab\";\nimport { Vector2d } from \"konva/lib/types\";\nimport * as React from \"react\";\nimport { CardData } from \"./external-api/common-card-data\";\nimport TopLayer from \"./TopLayer\";\n\ninterface IProps {\n  position: Vector2d | null;\n  heroData: CardData[];\n  hideSpecificCardLoader: () => void;\n  // cardSelected: (jsonId: string) => void;\n  preview: (jsonId: string) => void;\n  clearPreview: () => void;\n}\n\nconst SpecificCardLoader = (props: IProps) => {\n  return !!props.position ? (\n    <TopLayer\n      trasparentBackground={false}\n      offsetContent={false}\n      position={props.position}\n      completed={() => {\n        props.hideSpecificCardLoader();\n      }}\n    >\n      <div\n        onClick={(event) => {\n          event.stopPropagation();\n          event.preventDefault();\n        }}\n      >\n        <Autocomplete\n          id=\"specific-card-loader-combobox\"\n          options={props.heroData}\n          getOptionLabel={(cd) => cd.name}\n          style={{ width: 300 }}\n          onChange={handleSelected(props)}\n          onHighlightChange={handleHighlightChange(props)}\n          renderInput={(params) => (\n            <TextField\n              {...params}\n              label={\"Find Specific Card\"}\n              variant=\"outlined\"\n            />\n          )}\n        />\n      </div>\n    </TopLayer>\n  ) : null;\n};\n\nconst handleHighlightChange =\n  (props: IProps) =>\n  (\n    _event: any,\n    option: CardData | null,\n    reason: AutocompleteHighlightChangeReason\n  ) => {\n    if (!option) {\n      props.clearPreview();\n    } else {\n      props.preview(option.code);\n    }\n  };\n\nconst handleSelected =\n  (props: IProps) => (_event: any, value: CardData | null) => {\n    props.clearPreview();\n    // if (!!value && !!props.cardSelected) {\n    //   props.cardSelected(value.code);\n    // }\n  };\n\nexport default SpecificCardLoader;\n","import { connect } from \"react-redux\";\nimport { getCardsDataHeroEntitiesArrayWithoutDuplicates } from \"./features/cards-data/cards-data.selectors\";\nimport { getSpecificCardLoaderPosition } from \"./features/game/game.selectors\";\nimport {\n  hideSpecificCardLoader,\n  clearMenuPreviewCardJsonId,\n  setMenuPreviewCardJsonId,\n} from \"./features/game/game.slice\";\nimport SpecificCardLoader from \"./SpecificCardLoader\";\nimport { RootState } from \"./store/rootReducer\";\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    position: getSpecificCardLoaderPosition(state),\n    heroData: getCardsDataHeroEntitiesArrayWithoutDuplicates(state),\n  };\n};\n\nconst SpecificCardLoaderContainer = connect(mapStateToProps, {\n  hideSpecificCardLoader,\n  preview: setMenuPreviewCardJsonId,\n  clearPreview: clearMenuPreviewCardJsonId,\n})(SpecificCardLoader);\n\nexport default SpecificCardLoaderContainer;\n","import * as React from \"react\";\nimport { Component } from \"react\";\nimport { CounterTokenType } from \"./constants/card-constants\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from \"@material-ui/core/Button\";\n\ninterface IProps {\n  id: string;\n  tokenType: CounterTokenType;\n  updated: (payload: {\n    id: string;\n    tokenType: CounterTokenType;\n    value: number;\n  }) => void;\n}\n\nclass TokenValueModifier extends Component<IProps> {\n  inputValue: string = \"0\";\n\n  private focusInputField = (input: any) => {\n    if (input) {\n      setTimeout(() => {\n        input.querySelector(\"input\").focus();\n      }, 100);\n    }\n  };\n\n  render() {\n    return (\n      <div\n        onClick={this.cancelBubble}\n        onKeyPress={this.cancelBubble}\n        className=\"token-field-row\"\n      >\n        <TextField\n          ref={this.focusInputField}\n          onKeyPress={this.handleKeyPress}\n          variant=\"outlined\"\n          type=\"number\"\n          onChange={(event) => {\n            this.inputValue = event.target.value;\n          }}\n        ></TextField>\n        <Button\n          onClick={this.handleClick}\n          style={{ height: \"56px\", marginLeft: \"5px\" }}\n          variant=\"outlined\"\n          color=\"primary\"\n        >\n          Set\n        </Button>\n      </div>\n    );\n  }\n\n  private handleKeyPress = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    const code = event.key.toLocaleLowerCase();\n    if (code === \"enter\") {\n      this.complete(+this.inputValue);\n    }\n  };\n\n  private handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    this.complete(+this.inputValue);\n  };\n\n  private complete = (newValue: number) => {\n    this.props.updated({\n      id: this.props.id,\n      tokenType: this.props.tokenType,\n      value: newValue,\n    });\n  };\n\n  // private preventDefault = (\n  //   event: React.MouseEvent<HTMLElement, MouseEvent>\n  // ) => {\n  //   event.preventDefault();\n  // };\n\n  private cancelBubble = (event: React.SyntheticEvent) => {\n    event.stopPropagation();\n  };\n}\n\nexport default TokenValueModifier;\n","import * as React from \"react\";\nimport { Component } from \"react\";\nimport \"./OptionsMenu.scss\";\n//Icons\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport OpenWithIcon from \"@material-ui/icons/OpenWith\";\nimport SelectAllIcon from \"@material-ui/icons/SelectAll\";\nimport InfoIcon from \"@material-ui/icons/Info\";\nimport UndoIcon from \"@material-ui/icons/Undo\";\nimport RedoIcon from \"@material-ui/icons/Redo\";\nimport PanToolIcon from \"@material-ui/icons/PanTool\";\n\nimport { GameType } from \"./constants/app-constants\";\nimport { CounterTokenType, StatusTokenType } from \"./constants/card-constants\";\nimport { Vector2d } from \"konva/lib/types\";\nimport cx from \"classnames\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\ninterface IProps {\n  anyCardsSelected: boolean;\n  currentGameType: GameType | null;\n  panMode: boolean;\n  multiselectMode: boolean;\n  drawCardsIntoHand: boolean;\n  togglePanMode: () => void;\n  toggleMultiselectMode: () => void;\n  flipCards: () => void;\n  exhaustCard: (id?: string) => void;\n  toggleToken: (payload: {\n    id?: string;\n    tokenType: StatusTokenType;\n    value?: boolean;\n  }) => void;\n  shuffleStack: (id?: string) => void;\n  adjustCounterToken: (payload: {\n    id?: string;\n    tokenType: CounterTokenType;\n    delta?: number;\n    value?: number;\n  }) => void;\n  showRadialMenuAtPosition: (payload: Vector2d) => void;\n  showContextMenuAtPosition: (payload: Vector2d) => void;\n  undo: () => void;\n  redo: () => void;\n  toggleDrawCardsIntoHand: () => void;\n}\nclass OptionsMenu extends Component<IProps> {\n  render() {\n    return (\n      <div className=\"options-menu\">\n        <button\n          className={\"render-touch-only\"}\n          onClick={() => {\n            this.props.showContextMenuAtPosition({ x: 0, y: 0 });\n          }}\n        >\n          <MoreVertIcon fontSize=\"large\" />\n        </button>\n        <Tooltip title=\"Toggle Pan Mode\">\n          <button\n            className={cx({ \"toggle-on\": this.props.panMode })}\n            onClick={() => {\n              this.props.togglePanMode();\n            }}\n          >\n            <OpenWithIcon fontSize=\"large\" />\n          </button>\n        </Tooltip>\n        <Tooltip title=\"Toggle Draw Cards into Hand\">\n          <button\n            className={cx({ \"toggle-on\": this.props.drawCardsIntoHand })}\n            onClick={() => {\n              this.props.toggleDrawCardsIntoHand();\n            }}\n          >\n            <PanToolIcon fontSize=\"large\" />\n          </button>\n        </Tooltip>\n        <button\n          className={cx(\"render-touch-only\", {\n            \"toggle-on\": this.props.multiselectMode,\n          })}\n          onClick={() => {\n            this.props.toggleMultiselectMode();\n          }}\n        >\n          <SelectAllIcon fontSize=\"large\" />\n        </button>\n        <button\n          className={\"render-touch-only\"}\n          onClick={() => {\n            if (this.props.anyCardsSelected) {\n              this.props.showRadialMenuAtPosition({\n                x: 64,\n                y: window.visualViewport.height / 2,\n              });\n            }\n          }}\n        >\n          <InfoIcon fontSize=\"large\" />\n        </button>\n        <Tooltip title=\"Undo\">\n          <button\n            onClick={() => {\n              if (this.props.undo) {\n                this.props.undo();\n              }\n            }}\n          >\n            <UndoIcon fontSize=\"large\" />\n          </button>\n        </Tooltip>\n        <Tooltip title=\"Redo\">\n          <button\n            onClick={() => {\n              if (this.props.redo) {\n                this.props.redo();\n              }\n            }}\n          >\n            <RedoIcon fontSize=\"large\" />\n          </button>\n        </Tooltip>\n      </div>\n    );\n  }\n}\n\nexport default OptionsMenu;\n","import { connect } from \"react-redux\";\nimport {\n  anyCardsSelectedWithPeerRef,\n  getMultiselectMode,\n  getPanMode,\n} from \"./features/cards/cards.selectors\";\nimport {\n  exhaustCard,\n  flipCards,\n  togglePanMode,\n  toggleMultiselectMode,\n  toggleToken,\n  adjustCounterToken,\n} from \"./features/cards/cards.slice\";\nimport { shuffleStack } from \"./features/cards/cards.thunks\";\nimport { getGame } from \"./features/game/game.selectors\";\nimport { RootState } from \"./store/rootReducer\";\nimport OptionsMenu from \"./OptionsMenu\";\nimport {\n  showRadialMenuAtPosition,\n  toggleDrawCardsIntoHand,\n} from \"./features/game/game.slice\";\nimport { myPeerRef } from \"./constants/app-constants\";\nimport { ActionCreators } from \"redux-undo\";\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    anyCardsSelected: anyCardsSelectedWithPeerRef(myPeerRef)(state),\n    currentGameType: getGame(state).activeGameType,\n    panMode: getPanMode(state),\n    multiselectMode: getMultiselectMode(state),\n    drawCardsIntoHand: getGame(state).drawCardsIntoHand,\n  };\n};\n\nconst OptionsMenuContainer = connect(mapStateToProps, {\n  togglePanMode,\n  toggleMultiselectMode,\n  flipCards,\n  exhaustCard,\n  toggleToken,\n  shuffleStack,\n  adjustCounterToken,\n  showRadialMenuAtPosition,\n  undo: ActionCreators.undo,\n  redo: ActionCreators.redo,\n  toggleDrawCardsIntoHand,\n})(OptionsMenu);\n\nexport default OptionsMenuContainer;\n","export const copyToClipboard = (text: string) => {\n  navigator.clipboard.writeText(text);\n};\n\nexport const getBaseUrl = (): string => {\n  return `${window.location.origin}${window.location.pathname}`;\n};\n\nexport const generateRemoteGameUrl = (peerId: string) => {\n  return `${window.location.origin}${window.location.pathname}?remote=${peerId}`;\n};\n","import * as Intersects from \"intersects\";\nimport Konva from \"konva\";\nimport { KonvaEventObject } from \"konva/lib/Node\";\nimport { Vector2d } from \"konva/lib/types\";\nimport * as React from \"react\";\nimport { Component } from \"react\";\nimport { Layer, Rect, Stage } from \"react-konva\";\nimport { Provider, ReactReduxContext } from \"react-redux\";\nimport Card, { HORIZONTAL_TYPE_CODES } from \"./Card\";\nimport CardStackCardSelectorContainer from \"./CardStackCardSelectorContainer\";\nimport {\n  GameType,\n  myPeerRef,\n  PlayerColor,\n  playerHandHeightPx,\n  possibleColors,\n} from \"./constants/app-constants\";\nimport {\n  cardConstants,\n  CounterTokenType,\n  StatusTokenType,\n} from \"./constants/card-constants\";\nimport { GamePropertiesMap } from \"./constants/game-type-properties-mapping\";\nimport ContextMenu, { ContextMenuItem } from \"./ContextMenu\";\nimport Counter from \"./Counter\";\nimport DeckLoader from \"./DeckLoader\";\nimport EncounterLoaderContainer from \"./EncounterLoaderContainer\";\nimport { ICardData } from \"./features/cards-data/initialState\";\nimport { DrawCardsOutOfCardStackPayload } from \"./features/cards/cards.thunks\";\nimport { ICardsState, ICardStack } from \"./features/cards/initialState\";\nimport { ICounter } from \"./features/counters/initialState\";\nimport { IGameState } from \"./features/game/initialState\";\nimport FirstPlayerTokenContainer from \"./FirstPlayerTokenContainer\";\nimport \"./Game.scss\";\nimport PeerConnector from \"./PeerConnector\";\nimport PlayerHandContainer from \"./PlayerHandContainer\";\nimport RadialMenuContainer from \"./RadialMenuContainer\";\nimport SpecificCardLoaderContainer from \"./SpecificCardLoaderContainer\";\nimport TokenValueModifier from \"./TokenValueModifier\";\nimport TopLayer from \"./TopLayer\";\nimport OptionsMenuContainer from \"./OptionsMenuContainer\";\nimport {\n  anyCardStackHasStatus,\n  getImgUrls,\n  getMySelectedCards,\n} from \"./utilities/card-utils\";\nimport { getCenter, getDistance } from \"./utilities/geo\";\nimport { copyToClipboard, generateRemoteGameUrl } from \"./utilities/text-utils\";\n\nconst SCALE_BY = 1.02;\n\ninterface IProps {\n  currentGameType: GameType;\n  cards: ICardsState;\n  cardsData: ICardData;\n  gameState: IGameState;\n  panMode: boolean;\n  multiselectMode: boolean;\n  playerColors: { [key: string]: PlayerColor };\n  playerNumbers: { [key: string]: number };\n  menuPreviewCard: ICardStack | null;\n  cardMove: (info: { id: string; dx: number; dy: number }) => void;\n  endCardMove: (id: string) => void;\n  cardFromHandMove: (pos: Vector2d) => void;\n  exhaustCard: (id?: string) => void;\n  deleteCardStack: (id?: string) => void;\n  selectCard: (payload: { id: string; unselectOtherCards: boolean }) => void;\n  unselectCard: (id: string) => void;\n  toggleSelectCard: (id: string) => void;\n  startCardMove: (payload: { id: string; splitTopCard: boolean }) => void;\n  unselectAllCards: (payload?: any) => void;\n  selectMultipleCards: (cards: {\n    ids: string[];\n    unselectOtherCards?: boolean;\n  }) => void;\n  setPreviewCardId: (id: string) => void;\n  clearPreviewCard: () => void;\n  togglePanMode: () => void;\n  flipCards: () => void;\n  loadCardsData: () => void;\n  allJsonData: (payload: any) => void;\n  shuffleStack: (id?: string) => void;\n  fetchDecklistById: (payload: {\n    gameType: GameType;\n    decklistId: number;\n    position: Vector2d;\n  }) => void;\n  updateZoom: (zoom: Vector2d) => void;\n  updatePosition: (pos: Vector2d) => void;\n  resetApp: () => void;\n  addCardStack: (payload: {\n    cardJsonIds: string[];\n    position: Vector2d;\n  }) => void;\n  addToExistingCardStack: (payload: {\n    existingStackId: string;\n    cardJsonIds: string[];\n  }) => void;\n  toggleToken: (payload: {\n    id?: string;\n    tokenType: StatusTokenType;\n    value?: boolean;\n  }) => void;\n  adjustCounterToken: (payload: {\n    id?: string;\n    tokenType: CounterTokenType;\n    delta?: number;\n    value?: number;\n  }) => void;\n  pullCardOutOfCardStack: (payload: {\n    cardStackId: string;\n    jsonId: string;\n    pos: Vector2d;\n  }) => void;\n  addNewCounter: (pos: Vector2d) => void;\n  updateCounterValue: (payload: { id: string; delta: number }) => void;\n  removeCounter: (id: string) => void;\n  moveCounter: (payload: { id: string; newPos: Vector2d }) => void;\n  connectToRemoteGame: (peerId: string) => void;\n  undo: () => void;\n  redo: () => void;\n  counters: ICounter[];\n  requestResync: () => void;\n  peerId: string;\n  dropTargetCardsById: {\n    [key: string]: { ownerRef: string; card: ICardStack | null };\n  };\n  drawCardsOutOfCardStack: (payload: DrawCardsOutOfCardStackPayload) => void;\n  quitGame: () => void;\n  updateCounterColor: (payload: { id: string; newColor: PlayerColor }) => void;\n  createDeckFromTxt: (payload: {\n    gameType: GameType;\n    position: Vector2d;\n    txtContents: string;\n  }) => void;\n  createDeckFromJson: (payload: {\n    gameType: GameType;\n    position: Vector2d;\n    jsonContents: string;\n  }) => void;\n  generateGameStateUrl: () => void;\n  saveDeckAsJson: (stack: ICardStack | undefined) => void;\n  showRadialMenuAtPosition: (payload: Vector2d) => void;\n  showSpecificCardLoader: (payload: Vector2d) => void;\n  adjustModifier: (payload: {\n    id?: string;\n    modifierId: string;\n    delta?: number;\n    value?: number;\n  }) => void;\n  clearAllModifiers: (payload: { id?: string }) => void;\n  addToPlayerHand: (payload: { playerNumber: number }) => void;\n  addExtraIcon: (icon: string) => void;\n  removeExtraIcon: (icon: string) => void;\n}\n\ninterface IState {\n  drewASelectionRect: boolean;\n  selectRect: {\n    height: number;\n    width: number;\n  };\n  selectStartPos: {\n    x: number;\n    y: number;\n  };\n  selecting: boolean;\n  showContextMenu: boolean;\n  contextMenuPosition: Vector2d | null;\n  contextMenuItems: ContextMenuItem[];\n  showDeckImporter: boolean;\n  deckImporterPosition: Vector2d | null;\n  showEncounterImporter: boolean;\n  encounterImporterPosition: Vector2d | null;\n  showCardSearch: boolean;\n  cardSearchTouchBased: boolean;\n  cardSearchPosition: Vector2d | null;\n  cardStackForSearching: ICardStack | null;\n  showPeerConnector: boolean;\n  peerConnectorPosition: Vector2d | null;\n  showTokenValueModifier: boolean;\n  tokenValueModifierProps: { id: string; tokenType: CounterTokenType } | null;\n  tokenValueModifierPosition: Vector2d | null;\n  playmatImage: HTMLImageElement | null;\n  playmatImageLoaded: boolean;\n  previewCardModal: boolean;\n  stageWidth: number;\n  stageHeight: number;\n}\nclass Game extends Component<IProps, IState> {\n  public stage: Konva.Stage | null = null;\n\n  private touchTimer: any = null;\n  private doubleTapTimer: any = null;\n\n  private lastCenter: Vector2d | null = null;\n  private lastDist: number = 0;\n\n  private lastMousePos: Vector2d = { x: 0, y: 0 };\n  private captureLastMousePos = true;\n\n  constructor(props: IProps) {\n    super(props);\n\n    if (!!Konva) {\n      Konva.hitOnDragEnabled = true;\n    }\n\n    this.state = {\n      drewASelectionRect: false,\n      selectRect: {\n        height: 0,\n        width: 0,\n      },\n      selectStartPos: {\n        x: 0,\n        y: 0,\n      },\n      selecting: false,\n      showContextMenu: false,\n      contextMenuPosition: null,\n      contextMenuItems: [],\n      showDeckImporter: false,\n      deckImporterPosition: null,\n      showEncounterImporter: false,\n      encounterImporterPosition: null,\n      showCardSearch: false,\n      cardSearchTouchBased: false,\n      cardSearchPosition: null,\n      cardStackForSearching: null,\n      showPeerConnector: false,\n      peerConnectorPosition: null,\n      showTokenValueModifier: false,\n      tokenValueModifierProps: null,\n      tokenValueModifierPosition: null,\n      playmatImage: null,\n      playmatImageLoaded: false,\n      previewCardModal: false,\n      stageWidth: window.innerWidth,\n      stageHeight: window.innerHeight,\n    };\n  }\n\n  public componentDidMount() {\n    const image = new Image();\n    image.onload = () => {\n      this.setState({\n        playmatImage: image,\n        playmatImageLoaded: true,\n      });\n    };\n\n    image.onerror = (e) => {\n      console.error(e);\n    };\n    image.src =\n      GamePropertiesMap[this.props.currentGameType].backgroundImageLocation;\n    this.props.loadCardsData();\n    this.props.allJsonData(\"\");\n\n    window.addEventListener(\"resize\", this.handleResize);\n  }\n\n  public componentWillUnmount = () => {\n    window.removeEventListener(\"resize\", this.handleResize);\n  };\n\n  public render() {\n    // TODO: This feels like a bad hack. I bet all the\n    //       swallowing of click events is keeping\n    //       focus from behaving 'normally' and doing\n    //       the expected thing with focus. But there are\n    //       a lot of things that don't work quite right\n    //       if the body has focus, so we're going to\n    //       force the game area to have focus if it\n    //       lost it\n    if (document.activeElement === document.body) {\n      // setTimeout so we don't manually change the dom while rendering\n      setTimeout(() => {\n        const el = document.querySelector(\".play-area\") as HTMLElement;\n        el?.focus();\n      }, 0);\n    }\n    // END HACK\n\n    const staticCards = this.props.cards.cards\n      .filter((card) => !card.dragging)\n      .map((card) => {\n        return (\n          <Card\n            currentGameType={this.props.currentGameType}\n            code={this.getCardCode(card)}\n            name={this.getCardName(card)}\n            selectedColor={\n              this.props.playerColors[card.controlledBy] ?? \"black\"\n            }\n            controlledBy={card.controlledBy}\n            key={card.id}\n            id={card.id}\n            x={card.x}\n            y={card.y}\n            exhausted={card.exhausted}\n            fill={card.fill}\n            selected={card.selected}\n            dropTargetColor={\n              this.props.playerColors[\n                this.props.dropTargetCardsById[card.id]?.ownerRef\n              ] ?? \"\"\n            }\n            dragging={card.dragging}\n            shuffling={card.shuffling}\n            handleDragStart={this.handleCardDragStart}\n            handleDragMove={this.props.cardMove}\n            handleDoubleClick={this.handleSelectAndExhaust}\n            handleDoubleTap={this.showOrToggleModalPreviewCard}\n            handleClick={this.handleCardClick(card)}\n            handleHover={this.props.setPreviewCardId}\n            handleHoverLeave={this.props.clearPreviewCard}\n            handleContextMenu={this.handleCardContextMenu}\n            imgUrls={getImgUrls(\n              card,\n              this.props.cardsData,\n              this.props.currentGameType\n            )}\n            typeCode={this.getCardType(card)}\n            faceup={card.faceup}\n            numCardsInStack={card.cardStack.length}\n            cardState={{\n              stunned: card.statusTokens.stunned,\n              confused: card.statusTokens.confused,\n              tough: card.statusTokens.tough,\n              tokens: { damage: 0, threat: 0, generic: 0 },\n            }}\n          />\n        );\n      });\n\n    const ghostCards = this.props.cards.ghostCards.map((card) => {\n      return (\n        <Card\n          currentGameType={this.props.currentGameType}\n          name={this.getCardName(card)}\n          code={this.getCardCode(card)}\n          selectedColor={this.props.playerColors[card.controlledBy] ?? \"black\"}\n          controlledBy={card.controlledBy}\n          key={`ghost${card.id}`}\n          id={card.id}\n          x={card.x}\n          y={card.y}\n          exhausted={card.exhausted}\n          fill={card.fill}\n          selected={false}\n          dragging={false}\n          shuffling={false}\n          imgUrls={getImgUrls(\n            card,\n            this.props.cardsData,\n            this.props.currentGameType\n          )}\n          typeCode={this.getCardType(card)}\n          faceup={card.faceup}\n          isGhost={true}\n        />\n      );\n    });\n\n    const movingCards = this.props.cards.cards\n      .filter((card) => card.dragging)\n      .map((card) => {\n        return (\n          <Card\n            currentGameType={this.props.currentGameType}\n            name={this.getCardName(card)}\n            code={this.getCardCode(card)}\n            selectedColor={\n              this.props.playerColors[card.controlledBy] ?? \"black\"\n            }\n            controlledBy={card.controlledBy}\n            key={card.id}\n            id={card.id}\n            x={card.x}\n            y={card.y}\n            exhausted={card.exhausted}\n            fill={card.fill}\n            selected={card.selected}\n            dragging={card.dragging}\n            shuffling={card.shuffling}\n            handleDragStart={this.handleCardDragStart}\n            handleDragMove={this.props.cardMove}\n            handleDragEnd={this.handleCardDragEnd}\n            imgUrls={getImgUrls(\n              card,\n              this.props.cardsData,\n              this.props.currentGameType\n            )}\n            typeCode={this.getCardType(card)}\n            faceup={card.faceup}\n            numCardsInStack={card.cardStack.length}\n          />\n        );\n      });\n\n    const iAmDragging = this.props.cards.cards.some(\n      (c) => c.dragging && c.controlledBy === myPeerRef\n    );\n\n    const possiblePreviewCards = !!this.props.menuPreviewCard\n      ? [this.props.menuPreviewCard]\n      : this.props.cards.cards.filter(\n          (card) =>\n            !!this.props.gameState.previewCard &&\n            card.id === this.props.gameState.previewCard.id\n        );\n\n    const previewCards = this.stage\n      ? possiblePreviewCards\n          .filter((_card) => !this.state.selecting && !iAmDragging)\n          .map((card) => {\n            const isHorizontal = HORIZONTAL_TYPE_CODES.includes(\n              this.getCardType(card)\n            );\n            const imgUrls = getImgUrls(\n              card,\n              this.props.cardsData,\n              this.props.currentGameType\n            );\n            const rawPos = this.getRawPreviewCardPosition(isHorizontal);\n            const previewPos = this.getRelativePositionFromTarget(\n              this.stage,\n              rawPos\n            );\n\n            let previewCardHeight = cardConstants.CARD_PREVIEW_HEIGHT;\n            let previewCardWidth = cardConstants.CARD_PREVIEW_WIDTH;\n\n            // Note that we only adjust the height, because the card will\n            // be rotated if it supposed to be displayed horizontally\n            previewCardHeight = Math.min(\n              cardConstants.CARD_PREVIEW_HEIGHT,\n              isHorizontal ? window.innerWidth : window.innerHeight\n            );\n            const previewCardRatio =\n              previewCardHeight / cardConstants.CARD_PREVIEW_HEIGHT;\n            previewCardWidth *= previewCardRatio;\n\n            return imgUrls.some(\n              (url) => url.indexOf(\"card_back\") !== -1\n            ) ? null : (\n              <Card\n                currentGameType={this.props.currentGameType}\n                name={this.getCardName(card)}\n                code={this.getCardCode(card)}\n                selectedColor={\n                  this.props.playerColors[card.controlledBy] ?? \"black\"\n                }\n                controlledBy={card.controlledBy}\n                key={`preview${card.id}`}\n                id={card.id}\n                x={previewPos.x}\n                y={previewPos.y}\n                exhausted={isHorizontal}\n                fill={card.fill}\n                selected={false}\n                dragging={false}\n                shuffling={false}\n                imgUrls={imgUrls}\n                typeCode={this.getCardType(card)}\n                faceup={card.faceup}\n                height={previewCardHeight / this.props.gameState.stageZoom.y}\n                width={previewCardWidth / this.props.gameState.stageZoom.x}\n                isPreview={true}\n              />\n            );\n          })\n          .filter((c): c is JSX.Element => c !== null)\n      : [];\n\n    const playmatScale =\n      this.state.playmatImageLoaded && !!this.state.playmatImage?.naturalWidth\n        ? 2880 / this.state.playmatImage?.naturalWidth\n        : 1;\n\n    return (\n      <div\n        className=\"play-area\"\n        tabIndex={1}\n        onKeyDown={this.handleKeyDown}\n        onKeyPress={this.handleKeyPress}\n        onMouseUp={(_event) => {\n          if (this.props.gameState.draggingCardFromHand) {\n            this.captureLastMousePos = false;\n          }\n        }}\n        onTouchEnd={(_event) => {\n          if (this.props.gameState.draggingCardFromHand) {\n            this.captureLastMousePos = false;\n          }\n        }}\n        onTouchMove={(event) => {\n          if (event.touches.length > 0) {\n            if (this.captureLastMousePos) {\n              this.lastMousePos = {\n                x: event.touches.item(0).clientX,\n                y: event.touches.item(0).clientY,\n              };\n            }\n\n            if (this.props.gameState.draggingCardFromHand) {\n              this.props.cardFromHandMove(\n                this.getRelativePositionFromTarget(\n                  this.stage,\n                  this.lastMousePos\n                )\n              );\n            }\n          }\n        }}\n        onMouseMove={(event) => {\n          if (this.captureLastMousePos) {\n            this.lastMousePos = { x: event.clientX, y: event.clientY };\n          }\n\n          if (this.props.gameState.draggingCardFromHand) {\n            this.props.cardFromHandMove(\n              this.getRelativePositionFromTarget(this.stage, this.lastMousePos)\n            );\n          }\n        }}\n      >\n        <PlayerHandContainer\n          playerNumber={this.props.playerNumbers[myPeerRef] ?? 1}\n          droppedBackInHand={() => {\n            this.captureLastMousePos = true;\n          }}\n          droppedOnTable={(id: string, pos?: Vector2d) => {\n            const myDropTargetCard =\n              Object.values(this.props.dropTargetCardsById).filter(\n                (dt) => dt.ownerRef === myPeerRef\n              )[0] ?? null;\n            if (!!myDropTargetCard) {\n              this.props.addToExistingCardStack({\n                existingStackId: myDropTargetCard.card?.id ?? \"\",\n                cardJsonIds: [id],\n              });\n            } else {\n              this.props.addCardStack({\n                cardJsonIds: [id],\n                position: this.getRelativePositionFromTarget(\n                  this.stage,\n                  !!pos ? pos : this.lastMousePos\n                ),\n              });\n            }\n\n            this.captureLastMousePos = true;\n          }}\n        ></PlayerHandContainer>\n        <RadialMenuContainer\n          showCardSelector={(card, isSelect) => {\n            this.setState({\n              showCardSearch: true,\n              cardSearchTouchBased: isSelect,\n              cardSearchPosition: this.stage?.getPointerPosition() ?? null,\n              cardStackForSearching: card,\n            });\n          }}\n        ></RadialMenuContainer>\n        <SpecificCardLoaderContainer></SpecificCardLoaderContainer>\n        {this.renderEmptyMessage()}\n        {this.renderContextMenu()}\n        {this.renderPreviewCardModal()}\n        {this.renderOptionsMenu()}\n        {this.renderDeckImporter()}\n        {this.renderEncounterImporter()}\n        {this.renderCardSearch()}\n        {this.renderPeerConnector()}\n        {this.renderTokenModifier()}\n\n        <ReactReduxContext.Consumer>\n          {({ store }) => (\n            <Stage\n              ref={(ref) => {\n                if (!ref) return;\n\n                this.stage = ref;\n              }}\n              x={this.props.gameState.stagePosition.x}\n              y={this.props.gameState.stagePosition.y}\n              width={this.state.stageWidth}\n              height={this.state.stageHeight}\n              onClick={this.handleStageClickOrTap}\n              onTap={this.handleStageClickOrTap}\n              onMouseDown={\n                this.props.panMode ? this.noOp : this.handleMouseDown\n              }\n              onMouseUp={this.props.panMode ? this.noOp : this.handleMouseUp}\n              onMouseMove={\n                this.props.panMode ? this.noOp : this.handleMouseMove\n              }\n              onTouchStart={this.handleTouchStart}\n              onTouchMove={this.handleTouchMove}\n              onTouchEnd={this.handleTouchEnd}\n              onContextMenu={this.handleContextMenu}\n              scale={this.props.gameState.stageZoom}\n              onWheel={this.handleWheel}\n              draggable={this.props.panMode}\n              onDragMove={this.noOp}\n              onDragEnd={this.noOp}\n              preventDefault={true}\n            >\n              <Provider store={store}>\n                <Layer>\n                  <Rect\n                    fill={\n                      this.state.playmatImageLoaded ? undefined : \"lightgray\"\n                    }\n                    scale={{\n                      x: playmatScale,\n                      y: playmatScale,\n                    }}\n                    width={\n                      this.state.playmatImageLoaded\n                        ? this.state.playmatImage?.naturalWidth\n                        : 2880\n                    }\n                    height={\n                      this.state.playmatImageLoaded\n                        ? this.state.playmatImage?.naturalHeight\n                        : 1440\n                    }\n                    fillPatternImage={\n                      this.state.playmatImageLoaded && !!this.state.playmatImage\n                        ? this.state.playmatImage\n                        : undefined\n                    }\n                  ></Rect>\n                </Layer>\n                <Layer>\n                  {this.props.counters.map((counter) => (\n                    <Counter\n                      key={`${counter.id}-counter`}\n                      id={counter.id}\n                      pos={counter.position}\n                      value={counter.value}\n                      color={counter.color}\n                      updateCounterValueBy={this.handleCounterValueUpdate(\n                        counter.id\n                      )}\n                      handleContextMenu={this.handleCounterContextMenu(\n                        counter.id\n                      )}\n                      onDragEnd={this.handleCounterDrag(counter.id)}\n                    ></Counter>\n                  ))}\n                </Layer>\n                <Layer preventDefault={true}>\n                  {ghostCards.concat(staticCards).concat(movingCards)}\n\n                  <FirstPlayerTokenContainer\n                    currentGameType={this.props.currentGameType}\n                  ></FirstPlayerTokenContainer>\n\n                  {previewCards}\n                </Layer>\n                <Layer>\n                  <Rect\n                    x={this.state.selectStartPos.x}\n                    y={this.state.selectStartPos.y}\n                    width={this.state.selectRect.width}\n                    height={this.state.selectRect.height}\n                    stroke=\"yellow\"\n                    strokeWidth={4}\n                  />\n                </Layer>\n              </Provider>\n            </Stage>\n          )}\n        </ReactReduxContext.Consumer>\n      </div>\n    );\n  }\n\n  private handleCounterValueUpdate = (id: string) => (delta: number) => {\n    this.props.updateCounterValue({ id, delta });\n  };\n\n  private handleCounterDrag =\n    (id: string) => (event: KonvaEventObject<DragEvent>) => {\n      this.props.moveCounter({\n        id,\n        newPos: {\n          x: event.target.x(),\n          y: event.target.y(),\n        },\n      });\n    };\n\n  private noOp = () => {};\n\n  private renderEmptyMessage = () => {\n    if (this.props.cards.cards.length > 0) return null;\n\n    return (\n      <div>\n        <span>\n          Right click and select 'Load Deck ID' to load a deck from{\" \"}\n          {GamePropertiesMap[this.props.currentGameType].deckSite}\n        </span>\n      </div>\n    );\n  };\n\n  private renderContextMenu = () => {\n    if (!this.state.showContextMenu) return null;\n\n    const containerRect = this.stage?.container().getBoundingClientRect();\n    const pointerPosition = this.state.contextMenuPosition;\n    if (!containerRect || !pointerPosition) {\n      throw new Error(\"Problem computing context menu position\");\n    }\n\n    return (\n      <ContextMenu\n        position={{\n          x: containerRect.left + pointerPosition.x,\n          y: containerRect.top + pointerPosition.y,\n        }}\n        items={this.state.contextMenuItems}\n        hideContextMenu={() => this.clearContextMenu()}\n      ></ContextMenu>\n    );\n  };\n\n  private renderPreviewCardModal = () => {\n    if (!this.state.previewCardModal) return null;\n    return (\n      <TopLayer\n        position={{ x: 0, y: 0 }}\n        completed={() => {\n          this.props.clearPreviewCard();\n          this.setState({\n            previewCardModal: false,\n          });\n        }}\n      ></TopLayer>\n    );\n  };\n\n  private renderOptionsMenu = () => {\n    return (\n      <OptionsMenuContainer\n        showContextMenuAtPosition={(pos: Vector2d) => {\n          this.handleContextMenu(undefined, pos);\n        }}\n      ></OptionsMenuContainer>\n    );\n  };\n\n  private renderDeckImporter = () => {\n    if (!this.state.showDeckImporter) return null;\n\n    const containerRect = this.stage?.container().getBoundingClientRect();\n    const pointerPosition = this.state.deckImporterPosition;\n    if (!containerRect || !pointerPosition) {\n      throw new Error(\"Problem computing deck importer position\");\n    }\n\n    return (\n      <TopLayer\n        position={{\n          x: containerRect.left + pointerPosition.x,\n          y: containerRect.top + pointerPosition.y,\n        }}\n        completed={this.clearDeckImporter}\n      >\n        <DeckLoader\n          loadDeckId={this.handleImportDeck(\n            this.getRelativePositionFromTarget(this.stage)\n          )}\n        />\n      </TopLayer>\n    );\n  };\n\n  private renderEncounterImporter = () => {\n    if (!this.state.showEncounterImporter) return null;\n\n    const containerRect = this.stage?.container().getBoundingClientRect();\n    const pointerPosition = this.state.encounterImporterPosition;\n    if (!containerRect || !pointerPosition) {\n      throw new Error(\"Problem computing deck importer position\");\n    }\n\n    const pos = {\n      x: containerRect.left + pointerPosition.x,\n      y: containerRect.top + pointerPosition.y,\n    };\n\n    return (\n      <TopLayer position={pos} completed={this.clearEncounterImporter}>\n        <EncounterLoaderContainer\n          currentGameType={this.props.currentGameType}\n          loadCards={this.handleLoadEncounter(\n            this.getRelativePositionFromTarget(this.stage)\n          )}\n        />\n      </TopLayer>\n    );\n  };\n\n  private renderCardSearch = () => {\n    if (!this.state.showCardSearch) return null;\n\n    const containerRect = this.stage?.container().getBoundingClientRect();\n    const pointerPosition = this.state.cardSearchPosition;\n    if (!containerRect || !pointerPosition) {\n      throw new Error(\"Problem computing card search position\");\n    }\n\n    const pos = {\n      x: containerRect.left + pointerPosition.x,\n      y: containerRect.top + pointerPosition.y,\n    };\n\n    return !!this.state.cardStackForSearching ? (\n      <TopLayer position={pos} completed={this.clearCardSearch}>\n        <CardStackCardSelectorContainer\n          touchBased={this.state.cardSearchTouchBased}\n          card={this.state.cardStackForSearching}\n          cardSelected={this.handleCardSelectedFromCardStack(\n            this.state.cardStackForSearching.id,\n            pos\n          )}\n        />\n      </TopLayer>\n    ) : null;\n  };\n\n  private renderPeerConnector = () => {\n    if (!this.state.showPeerConnector) return null;\n\n    const containerRect = this.stage?.container().getBoundingClientRect();\n    const pointerPosition = this.state.peerConnectorPosition;\n    if (!containerRect || !pointerPosition) {\n      throw new Error(\"Problem computing peer connector position\");\n    }\n\n    const pos = {\n      x: containerRect.left + pointerPosition.x,\n      y: containerRect.top + pointerPosition.y,\n    };\n\n    return !!this.state.showPeerConnector ? (\n      <TopLayer position={pos} completed={this.clearPeerConnector}>\n        <PeerConnector connect={this.handlePeerConnect}></PeerConnector>\n      </TopLayer>\n    ) : null;\n  };\n\n  private renderTokenModifier = () => {\n    if (!this.state.showTokenValueModifier) return null;\n\n    const containerRect = this.stage?.container().getBoundingClientRect();\n    const pointerPosition = this.state.tokenValueModifierPosition;\n    if (!containerRect || !pointerPosition) {\n      throw new Error(\"Problem computing token Modifier position\");\n    }\n\n    const pos = {\n      x: containerRect.left + pointerPosition.x,\n      y: containerRect.top + pointerPosition.y,\n    };\n\n    return !!this.state.showTokenValueModifier &&\n      !!this.state.tokenValueModifierProps ? (\n      <TopLayer position={pos} completed={this.clearTokenValueModifier}>\n        <TokenValueModifier\n          id={this.state.tokenValueModifierProps.id}\n          tokenType={this.state.tokenValueModifierProps.tokenType}\n          updated={(payload) => {\n            this.props.adjustCounterToken(payload);\n            this.clearTokenValueModifier();\n          }}\n        ></TokenValueModifier>\n      </TopLayer>\n    ) : null;\n  };\n\n  private handleLoadEncounter = (position: Vector2d) => (cards: string[][]) => {\n    this.clearEncounterImporter();\n    cards.forEach((c, index) => {\n      this.props.addCardStack({\n        position: {\n          x: position.x + (cardConstants.CARD_WIDTH + 10) * index,\n          y: position.y,\n        },\n        cardJsonIds: c,\n      });\n    });\n  };\n\n  private handleImportDeck = (position: Vector2d) => (id: number) => {\n    this.clearDeckImporter();\n    this.props.fetchDecklistById({\n      gameType: this.props.currentGameType,\n      decklistId: id,\n      position,\n    });\n  };\n\n  private handlePeerConnect = (peerId: string) => {\n    this.clearPeerConnector();\n    this.props.connectToRemoteGame(peerId);\n  };\n\n  private handleCardSelectedFromCardStack =\n    (cardStackId: string, pos: Vector2d) => (jsonId: string) => {\n      this.clearCardSearch();\n      this.props.pullCardOutOfCardStack({ cardStackId, jsonId, pos });\n    };\n\n  private clearContextMenu = () => {\n    this.setState({\n      showContextMenu: false,\n      contextMenuPosition: null,\n      contextMenuItems: [],\n    });\n  };\n\n  private clearDeckImporter = () => {\n    this.setState({\n      showDeckImporter: false,\n      deckImporterPosition: null,\n    });\n  };\n\n  private clearTokenValueModifier = () => {\n    this.setState({\n      showTokenValueModifier: false,\n      tokenValueModifierProps: null,\n      tokenValueModifierPosition: null,\n    });\n  };\n\n  private clearEncounterImporter = () => {\n    this.setState({\n      showEncounterImporter: false,\n      encounterImporterPosition: null,\n    });\n  };\n\n  private clearCardSearch = () => {\n    this.setState({\n      showCardSearch: false,\n      cardSearchTouchBased: false,\n      cardSearchPosition: null,\n      cardStackForSearching: null,\n    });\n  };\n\n  private clearPeerConnector = () => {\n    this.setState({\n      showPeerConnector: false,\n      peerConnectorPosition: null,\n    });\n  };\n\n  private handleStageClickOrTap = (event: KonvaEventObject<MouseEvent>) => {\n    if (this.state.showContextMenu) {\n      return;\n    }\n    const mousePos = this.getRelativePositionFromTarget(this.stage);\n    if (\n      this.props.panMode ||\n      getDistance(this.state.selectStartPos, mousePos) < 30\n    ) {\n      this.props.unselectAllCards();\n    }\n  };\n\n  private handleWheel = (event: KonvaEventObject<WheelEvent>) => {\n    event.evt.preventDefault();\n\n    if (!this.stage) return;\n\n    var oldScale = this.props.gameState.stageZoom.x;\n\n    const pointer = this.stage.getPointerPosition() ?? { x: 0, y: 0 };\n\n    const mousePointTo = {\n      x: (pointer.x - this.stage.x()) / oldScale,\n      y: (pointer.y - this.stage.y()) / oldScale,\n    };\n\n    const newScale =\n      event.evt.deltaY < 0 ? oldScale * SCALE_BY : oldScale / SCALE_BY;\n\n    this.props.updateZoom({ x: newScale, y: newScale });\n\n    const newPos = {\n      x: pointer.x - mousePointTo.x * newScale,\n      y: pointer.y - mousePointTo.y * newScale,\n    };\n\n    this.props.updatePosition(newPos);\n  };\n\n  private handleCounterContextMenu =\n    (counterId: string) => (event: KonvaEventObject<PointerEvent>) => {\n      event.evt.preventDefault();\n      event.cancelBubble = true;\n\n      const counter = this.props.counters.find((c) => c.id === counterId);\n\n      const menuItems: ContextMenuItem[] = [\n        {\n          label: \"Remove\",\n          action: () => {\n            this.props.removeCounter(counterId);\n          },\n        },\n        {\n          label: \"Reset\",\n          action: () => {\n            this.props.updateCounterValue({\n              id: counterId,\n              delta: (counter?.value ?? 0) * -1,\n            });\n          },\n        },\n        {\n          label: \"Set Color\",\n          children: possibleColors.map((color) => {\n            return {\n              label: color,\n              action: () => {\n                this.props.updateCounterColor({\n                  id: counterId,\n                  newColor: color,\n                });\n              },\n            };\n          }),\n        },\n      ];\n\n      this.setState({\n        showContextMenu: true,\n        contextMenuPosition: this.stage?.getPointerPosition() ?? null,\n        contextMenuItems: menuItems,\n      });\n    };\n\n  private handleCardContextMenu = (\n    cardId: string,\n    event: KonvaEventObject<PointerEvent>\n  ) => {\n    event.evt.preventDefault();\n    event.cancelBubble = true;\n\n    // We want to unselect all the other cards if the card isn't actively selected\n    const cardStack = this.props.cards.cards.find((c) => c.id === cardId);\n\n    // Next, select the card that was right-clicked\n    this.props.selectCard({\n      id: cardId,\n      unselectOtherCards: !!cardStack ? !cardStack.selected : true,\n    });\n\n    const card = this.props.cards.cards.find((c) => c.id === cardId);\n    const numCardsInStack = card?.cardStack?.length || 0;\n\n    const mySelectedCards = getMySelectedCards(this.props.cards.cards);\n\n    const menuItems: ContextMenuItem[] = [\n      {\n        label: \"Add all to hand\",\n        action: () => {\n          this.props.addToPlayerHand({\n            playerNumber: this.props.gameState.playerNumbers[myPeerRef],\n          });\n        },\n      },\n      {\n        label: \"Flip\",\n        action: () => {\n          this.props.flipCards();\n        },\n      },\n    ];\n\n    if (numCardsInStack > 1) {\n      menuItems.push({\n        label: \"Shuffle\",\n        action: () => {\n          this.props.shuffleStack();\n        },\n      });\n\n      menuItems.push({\n        label: \"Find Specific Card\",\n        action: () => {\n          if (!!card) {\n            this.setState({\n              showCardSearch: true,\n              cardSearchPosition: this.stage?.getPointerPosition() ?? null,\n              cardStackForSearching: card,\n            });\n          }\n        },\n      });\n    }\n\n    menuItems.push({\n      label: \"Delete\",\n      action: () => {\n        this.props.deleteCardStack();\n      },\n    });\n\n    menuItems.push({\n      label: \"Save Deck as json file\",\n      action: () => {\n        this.props.saveDeckAsJson(card);\n      },\n    });\n\n    const tokenInfoForGameType =\n      GamePropertiesMap[this.props.currentGameType].tokens;\n\n    if (!!tokenInfoForGameType.stunned) {\n      menuItems.push({\n        label: anyCardStackHasStatus(StatusTokenType.Stunned, mySelectedCards)\n          ? tokenInfoForGameType.stunned.menuRemoveText\n          : tokenInfoForGameType.stunned.menuText,\n        action: () => {\n          this.props.toggleToken({\n            id: card?.id || \"\",\n            tokenType: StatusTokenType.Stunned,\n            value: !anyCardStackHasStatus(\n              StatusTokenType.Stunned,\n              mySelectedCards\n            ),\n          });\n        },\n      });\n    }\n\n    if (!!tokenInfoForGameType.confused) {\n      menuItems.push({\n        label: anyCardStackHasStatus(StatusTokenType.Confused, mySelectedCards)\n          ? tokenInfoForGameType.confused.menuRemoveText\n          : tokenInfoForGameType.confused.menuText,\n        action: () => {\n          this.props.toggleToken({\n            id: card?.id || \"\",\n            tokenType: StatusTokenType.Confused,\n            value: !anyCardStackHasStatus(\n              StatusTokenType.Confused,\n              mySelectedCards\n            ),\n          });\n        },\n      });\n    }\n\n    if (!!tokenInfoForGameType.tough) {\n      menuItems.push({\n        label: anyCardStackHasStatus(StatusTokenType.Tough, mySelectedCards)\n          ? tokenInfoForGameType.tough.menuRemoveText\n          : tokenInfoForGameType.tough.menuText,\n        action: () => {\n          this.props.toggleToken({\n            id: card?.id || \"\",\n            tokenType: StatusTokenType.Tough,\n            value: !anyCardStackHasStatus(\n              StatusTokenType.Tough,\n              mySelectedCards\n            ),\n          });\n        },\n      });\n    }\n\n    if (!!tokenInfoForGameType.damage) {\n      menuItems.push({\n        label: tokenInfoForGameType.damage.menuText,\n        action: () => {\n          this.setState({\n            showContextMenu: false,\n            contextMenuItems: [],\n            contextMenuPosition: null,\n\n            showTokenValueModifier: true,\n            tokenValueModifierProps: {\n              id: card?.id || \"\",\n              tokenType: CounterTokenType.Damage,\n            },\n            tokenValueModifierPosition:\n              this.stage?.getPointerPosition() ?? null,\n          });\n        },\n      });\n    }\n\n    if (!!tokenInfoForGameType.threat) {\n      menuItems.push({\n        label: tokenInfoForGameType.threat.menuText,\n        action: () => {\n          this.setState({\n            showContextMenu: false,\n            contextMenuItems: [],\n            contextMenuPosition: null,\n\n            showTokenValueModifier: true,\n            tokenValueModifierProps: {\n              id: card?.id || \"\",\n              tokenType: CounterTokenType.Threat,\n            },\n            tokenValueModifierPosition:\n              this.stage?.getPointerPosition() ?? null,\n          });\n        },\n      });\n    }\n\n    if (!!tokenInfoForGameType.generic) {\n      menuItems.push({\n        label: tokenInfoForGameType.generic.menuText,\n        action: () => {\n          this.setState({\n            showContextMenu: false,\n            contextMenuItems: [],\n            contextMenuPosition: null,\n\n            showTokenValueModifier: true,\n            tokenValueModifierProps: {\n              id: card?.id || \"\",\n              tokenType: CounterTokenType.Generic,\n            },\n            tokenValueModifierPosition:\n              this.stage?.getPointerPosition() ?? null,\n          });\n        },\n      });\n    }\n\n    menuItems.push({\n      label: \"Remove All Tokens\",\n      action: () => {\n        this.props.adjustCounterToken({\n          id: card?.id || \"\",\n          tokenType: CounterTokenType.Damage,\n          value: 0,\n        });\n\n        this.props.adjustCounterToken({\n          id: card?.id || \"\",\n          tokenType: CounterTokenType.Threat,\n          value: 0,\n        });\n\n        this.props.adjustCounterToken({\n          id: card?.id || \"\",\n          tokenType: CounterTokenType.Generic,\n          value: 0,\n        });\n      },\n    });\n\n    const modifiersForGameType =\n      GamePropertiesMap[this.props.currentGameType].modifiers;\n\n    const extraIconsForGameType =\n      GamePropertiesMap[this.props.currentGameType].possibleIcons;\n\n    if (modifiersForGameType.length > 0) {\n      menuItems.push({\n        label: \"Modifiers\",\n        children: modifiersForGameType\n          .map((m) => {\n            return {\n              label: m.attributeName,\n              children: [\n                {\n                  label: \"Add 1\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      delta: 1,\n                    });\n                  },\n                },\n                {\n                  label: \"Remove 1\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      delta: -1,\n                    });\n                  },\n                },\n                {\n                  label: \"-3\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      value: -3,\n                    });\n                  },\n                },\n                {\n                  label: \"-2\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      value: -2,\n                    });\n                  },\n                },\n                {\n                  label: \"-1\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      value: -1,\n                    });\n                  },\n                },\n                {\n                  label: \"0\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      value: 0,\n                    });\n                  },\n                },\n                {\n                  label: \"1\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      value: 1,\n                    });\n                  },\n                },\n                {\n                  label: \"2\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      value: 2,\n                    });\n                  },\n                },\n                {\n                  label: \"3\",\n                  action: () => {\n                    this.props.adjustModifier({\n                      id: card?.id || \"\",\n                      modifierId: m.attributeId,\n                      value: 3,\n                    });\n                  },\n                },\n              ],\n            } as ContextMenuItem;\n          })\n          .concat(\n            extraIconsForGameType.length > 0\n              ? [\n                  {\n                    label: \"Add Icon\",\n                    children: extraIconsForGameType.map((icon) => ({\n                      label: icon.iconName,\n                      action: () => {\n                        this.props.addExtraIcon(icon.iconId);\n                      },\n                    })),\n                  },\n                  {\n                    label: \"Remove Icon\",\n                    children: extraIconsForGameType.map((icon) => ({\n                      label: icon.iconName,\n                      action: () => {\n                        this.props.removeExtraIcon(icon.iconId);\n                      },\n                    })),\n                  },\n                ]\n              : []\n          )\n          .concat([\n            {\n              label: \"Clear all modifiers\",\n              action: () => {\n                this.props.clearAllModifiers({ id: card?.id || \"\" });\n              },\n            },\n          ]),\n      });\n    }\n\n    this.setState({\n      showContextMenu: true,\n      contextMenuPosition: this.stage?.getPointerPosition() ?? null,\n      contextMenuItems: menuItems,\n    });\n  };\n\n  private handleCardClick =\n    (card: ICardStack) =>\n    (\n      cardId: string,\n      event: KonvaEventObject<MouseEvent> | KonvaEventObject<TouchEvent>,\n      wasTouch: boolean\n    ) => {\n      // Here check if modifier held down\n      const modifierKeyHeld =\n        event.evt.shiftKey || event.evt.metaKey || event.evt.ctrlKey;\n\n      if (card.selected && (modifierKeyHeld || this.props.multiselectMode)) {\n        this.props.toggleSelectCard(cardId);\n      } else {\n        this.props.selectCard({\n          id: cardId,\n          unselectOtherCards: !modifierKeyHeld && !this.props.multiselectMode,\n        });\n\n        if (\n          wasTouch &&\n          !modifierKeyHeld &&\n          !this.props.multiselectMode &&\n          !this.doubleTapTimer &&\n          !this.state.showContextMenu\n        ) {\n          this.doubleTapTimer = setTimeout(() => {\n            this.props.showRadialMenuAtPosition(\n              this.stage?.getPointerPosition() || { x: 0, y: 0 }\n            );\n            this.doubleTapTimer = null;\n          }, 200);\n        }\n      }\n    };\n\n  private handleSelectAndExhaust = (\n    cardId: string,\n    event: KonvaEventObject<MouseEvent>\n  ) => {\n    // Here check if modifier held down\n    const modifierKeyHeld =\n      event.evt.shiftKey || event.evt.metaKey || event.evt.ctrlKey;\n    this.props.selectCard({ id: cardId, unselectOtherCards: !modifierKeyHeld });\n    this.props.exhaustCard(cardId);\n  };\n\n  private showOrToggleModalPreviewCard = (\n    cardId: string,\n    _event: KonvaEventObject<TouchEvent>\n  ) => {\n    // Clear the timer if we were waiting\n    if (!!this.doubleTapTimer) {\n      clearTimeout(this.doubleTapTimer);\n      this.doubleTapTimer = null;\n    }\n\n    if (\n      !!this.props.gameState.previewCard &&\n      this.props.gameState.previewCard.id === cardId\n    ) {\n      this.props.clearPreviewCard();\n    } else {\n      this.setState({\n        previewCardModal: true,\n      });\n      this.props.setPreviewCardId(cardId);\n    }\n  };\n\n  private handleCardDragStart = (\n    cardId: string,\n    event: KonvaEventObject<DragEvent>\n  ) => {\n    let splitTopCard = false;\n    // If multiple things are selected, you can't pull something off the top of a stack,\n    // so just do a normal drag\n    const multipleSelected =\n      this.props.cards.cards.filter(\n        (c) => c.selected && c.controlledBy === myPeerRef\n      ).length > 1;\n\n    if (!multipleSelected) {\n      const draggingCard = this.props.cards.cards.find((c) => c.id === cardId);\n      const hasStack = (draggingCard?.cardStack || []).length > 1;\n      if (!!draggingCard && hasStack) {\n        // Check if we're dragging in the upper right corner of the card\n        const upperRightPoint = {\n          x:\n            draggingCard.x +\n            (draggingCard.exhausted\n              ? cardConstants.CARD_HEIGHT\n              : cardConstants.CARD_WIDTH) /\n              2,\n          y:\n            draggingCard.y -\n            (draggingCard.exhausted\n              ? cardConstants.CARD_WIDTH\n              : cardConstants.CARD_HEIGHT) /\n              2,\n        };\n        const distance = getDistance(\n          upperRightPoint,\n          this.getRelativePositionFromTarget(this.stage)\n        );\n\n        const dragDistanceThreshold =\n          event.evt instanceof TouchEvent\n            ? cardConstants.TOUCH_DRAG_SPLIT_DISTANCE\n            : cardConstants.MOUSE_DRAG_SPLIT_DISTANCE;\n\n        if (distance < dragDistanceThreshold) {\n          splitTopCard = true;\n        }\n      }\n    }\n\n    this.props.startCardMove({ id: cardId, splitTopCard });\n  };\n\n  private handleCardDragEnd = (\n    cardId: string,\n    event: KonvaEventObject<DragEvent>\n  ) => {\n    const verticalMax = window.innerHeight;\n    const verticalMin = window.innerHeight - playerHandHeightPx;\n    const max = { x: 0, y: verticalMax };\n    const min = { x: 0, y: verticalMin };\n\n    const translatedMax = this.getRelativePositionFromTarget(this.stage, max);\n    const translatedMin = this.getRelativePositionFromTarget(this.stage, min);\n    this.props.endCardMove(cardId);\n    if (\n      event.target.y() > translatedMin.y &&\n      event.target.y() < translatedMax.y\n    ) {\n      this.props.addToPlayerHand({\n        playerNumber: this.props.gameState.playerNumbers[myPeerRef],\n      });\n    }\n  };\n\n  private handleKeyPress = (event: React.KeyboardEvent<HTMLElement>) => {\n    const modifier: boolean = event.ctrlKey || event.metaKey;\n    const code = event.key.toLocaleLowerCase();\n    const intCode = parseInt(code);\n    if (code === \"p\") {\n      this.props.togglePanMode();\n    } else if (code === \"f\") {\n      this.props.flipCards();\n    } else if (code === \"e\") {\n      this.props.exhaustCard();\n    } else if (code === \"s\") {\n      this.props.shuffleStack();\n    } else if (!Number.isNaN(intCode)) {\n      // if a ctrl / cmd key was held, we're\n      // adding tokens\n      if (modifier) {\n      } else {\n        // First, get the selected card stack\n        const mySelectedCards = getMySelectedCards(this.props.cards.cards);\n        if (mySelectedCards.length !== 1) {\n          console.log(\n            \"will not be drawing any cards because the number of selected stacks is \" +\n              mySelectedCards.length\n          );\n        } else {\n          this.props.drawCardsOutOfCardStack({\n            cardStackId: mySelectedCards[0].id,\n            numberToDraw: intCode,\n          });\n        }\n      }\n    }\n  };\n\n  private handleKeyDown = (event: React.KeyboardEvent<HTMLElement>) => {\n    const code = event.key.toLocaleLowerCase();\n    const intCode = parseInt(code);\n\n    if ((event.ctrlKey || event.metaKey) && !Number.isNaN(intCode)) {\n      const tokenInfoForGameType =\n        GamePropertiesMap[this.props.currentGameType].tokens;\n      switch (intCode) {\n        case 1:\n          if (!!tokenInfoForGameType.damage) {\n            this.props.adjustCounterToken({\n              tokenType: CounterTokenType.Damage,\n              delta: 1,\n            });\n          }\n          break;\n        case 2:\n          if (!!tokenInfoForGameType.threat) {\n            this.props.adjustCounterToken({\n              tokenType: CounterTokenType.Threat,\n              delta: 1,\n            });\n          }\n          break;\n\n        case 3:\n          if (!!tokenInfoForGameType.generic) {\n            this.props.adjustCounterToken({\n              tokenType: CounterTokenType.Generic,\n              delta: 1,\n            });\n          }\n          break;\n        case 4:\n          if (!!tokenInfoForGameType.damage) {\n            this.props.adjustCounterToken({\n              tokenType: CounterTokenType.Damage,\n              delta: -1,\n            });\n          }\n          break;\n        case 5:\n          if (!!tokenInfoForGameType.threat) {\n            this.props.adjustCounterToken({\n              tokenType: CounterTokenType.Threat,\n              delta: -1,\n            });\n          }\n          break;\n\n        case 6:\n          if (!!tokenInfoForGameType.generic) {\n            this.props.adjustCounterToken({\n              tokenType: CounterTokenType.Generic,\n              delta: -1,\n            });\n          }\n          break;\n      }\n      event.preventDefault();\n    }\n\n    if (\n      event.shiftKey &&\n      (event.ctrlKey || event.metaKey) &&\n      event.key === \"z\"\n    ) {\n      this.props.redo();\n    } else if ((event.ctrlKey || event.metaKey) && event.key === \"z\") {\n      event.preventDefault();\n      this.props.undo();\n    }\n  };\n\n  private getRawPreviewCardPosition = (horizontal: boolean): Vector2d => {\n    const pointerPos = this.stage?.getPointerPosition() ?? { x: 0, y: 0 };\n    const screenMidPointX = window.innerWidth / 2;\n    const screenMidPointY = window.innerHeight / 2;\n\n    const widthToUse = horizontal\n      ? cardConstants.CARD_PREVIEW_HEIGHT\n      : cardConstants.CARD_PREVIEW_WIDTH;\n    const heightToUse = horizontal\n      ? cardConstants.CARD_PREVIEW_WIDTH\n      : cardConstants.CARD_PREVIEW_HEIGHT;\n\n    if (this.state.previewCardModal) {\n      return {\n        x: screenMidPointX,\n        y: screenMidPointY,\n      };\n    }\n\n    return pointerPos.x < screenMidPointX\n      ? {\n          x: window.innerWidth - widthToUse / 2,\n          y: heightToUse / 2,\n        }\n      : {\n          x: widthToUse / 2,\n          y: heightToUse / 2,\n        };\n  };\n\n  private getRelativePositionFromTarget = (\n    target: any,\n    posParam?: Vector2d\n  ) => {\n    const transform = target.getAbsoluteTransform().copy();\n    transform.invert();\n    let pos = posParam || target.getPointerPosition();\n    return transform.point(pos ?? { x: 20, y: 20 }) as Vector2d;\n  };\n\n  private handleMouseDown = (\n    event: KonvaEventObject<MouseEvent> | KonvaEventObject<TouchEvent>\n  ) => {\n    if (\n      (event.evt instanceof MouseEvent && event.evt.button === 0) ||\n      event.evt instanceof TouchEvent\n    ) {\n      // Only do something if it's the primary button (not a right-click)\n      const pos = this.getRelativePositionFromTarget(this.stage);\n\n      this.setState({\n        selectStartPos: {\n          x: pos.x,\n          y: pos.y,\n        },\n        selecting: true,\n      });\n    }\n\n    return false;\n  };\n\n  private getSelectionRectInfo = () => {\n    const selectStartPos = this.state.selectStartPos;\n    const selectRect = this.state.selectRect;\n    return {\n      height: Math.abs(selectRect.height),\n      width: Math.abs(selectRect.width),\n      x:\n        selectRect.width < 0\n          ? selectStartPos.x + selectRect.width\n          : selectStartPos.x,\n      y:\n        selectRect.height < 0\n          ? selectStartPos.y + selectRect.height\n          : selectStartPos.y,\n    };\n  };\n\n  private handleMouseUp = (\n    event: KonvaEventObject<MouseEvent> | KonvaEventObject<TouchEvent>\n  ) => {\n    // if we were selecting, check for intersection\n    if (this.state.drewASelectionRect) {\n      const selectRect = this.getSelectionRectInfo();\n      const selectedCards: any[] = this.props.cards.cards.reduce<ICardStack[]>(\n        (currSelectedCards, card) => {\n          const intersects = Intersects.boxBox(\n            selectRect.x,\n            selectRect.y,\n            selectRect.width,\n            selectRect.height,\n            card.x - 50,\n            card.y - 75,\n            cardConstants.CARD_WIDTH,\n            cardConstants.CARD_HEIGHT\n          );\n\n          if (intersects) {\n            currSelectedCards.push(card);\n          }\n\n          return currSelectedCards;\n        },\n        []\n      );\n\n      // Here check if modifier held down\n      const modifierKeyHeld =\n        event.evt.shiftKey || event.evt.metaKey || event.evt.ctrlKey;\n\n      this.props.selectMultipleCards({\n        ids: selectedCards.map((card) => card.id),\n        unselectOtherCards: !modifierKeyHeld,\n      });\n    }\n\n    this.setState({\n      drewASelectionRect: false,\n      selectRect: {\n        height: 0,\n        width: 0,\n      },\n      selecting: false,\n    });\n\n    return false;\n  };\n\n  private handleTouchStart = (event: KonvaEventObject<TouchEvent>) => {\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n\n    this.touchTimer = setTimeout(() => {\n      this.handleContextMenu(event);\n    }, 750);\n\n    if (!this.props.panMode) {\n      this.handleMouseDown(event);\n    }\n  };\n\n  private handleTouchMove = (e: any) => {\n    e.evt.preventDefault();\n\n    var touch1 = e.evt.touches[0];\n    var touch2 = e.evt.touches[1];\n\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n\n    if (touch1 && touch2) {\n      this.handleMultiTouch(touch1, touch2);\n    } else {\n      this.handleMouseMove(e);\n    }\n  };\n\n  private handleMultiTouch = (touch1: any, touch2: any) => {\n    if (!this.stage) {\n      return;\n    }\n    // if the stage was under Konva's drag&drop\n    // we need to stop it, and implement our own pan logic with two pointers\n    if (this.stage.isDragging()) {\n      this.stage.stopDrag();\n    }\n\n    const p1 = {\n      x: touch1.clientX,\n      y: touch1.clientY,\n    };\n    const p2 = {\n      x: touch2.clientX,\n      y: touch2.clientY,\n    };\n\n    if (!this.lastCenter) {\n      this.lastCenter = getCenter(p1, p2);\n      return;\n    }\n    const newCenter = getCenter(p1, p2);\n\n    const dist = getDistance(p1, p2);\n\n    if (!this.lastDist) {\n      this.lastDist = dist;\n    }\n\n    // local coordinates of center point\n    const pointTo = {\n      x: (newCenter.x - this.stage.x()) / this.props.gameState.stageZoom.x,\n      y: (newCenter.y - this.stage.y()) / this.props.gameState.stageZoom.y,\n    };\n\n    const scale = this.props.gameState.stageZoom.x * (dist / this.lastDist);\n    this.props.updateZoom({ x: scale, y: scale });\n\n    // calculate new position of the stage\n    const dx = newCenter.x - this.lastCenter.x;\n    const dy = newCenter.y - this.lastCenter.y;\n\n    const newPos = {\n      x: newCenter.x - pointTo.x * scale + dx,\n      y: newCenter.y - pointTo.y * scale + dy,\n    };\n\n    this.props.updatePosition(newPos);\n\n    this.lastDist = dist;\n    this.lastCenter = newCenter;\n  };\n\n  private handleTouchEnd = (event: KonvaEventObject<TouchEvent>) => {\n    this.lastDist = 0;\n    this.lastCenter = null;\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n\n    if (!this.props.panMode) {\n      this.handleMouseUp(event);\n    }\n  };\n\n  private handleMouseMove = (event: any) => {\n    if (this.state.selecting) {\n      const pos = this.getRelativePositionFromTarget(event.currentTarget);\n      this.setState({\n        drewASelectionRect: true,\n        selectRect: {\n          height: pos.y - this.state.selectStartPos.y,\n          width: pos.x - this.state.selectStartPos.x,\n        },\n      });\n    }\n    event.cancelBubble = true;\n  };\n\n  private handleContextMenu = (\n    event?: KonvaEventObject<PointerEvent> | KonvaEventObject<TouchEvent>,\n    pos?: Vector2d\n  ): void => {\n    if (!!this.touchTimer) {\n      clearTimeout(this.touchTimer);\n      this.touchTimer = null;\n    }\n    if (!!event) {\n      event.evt.preventDefault();\n      event.cancelBubble = true;\n    }\n\n    const menuItems: ContextMenuItem[] = [\n      {\n        label: \"Undo\",\n        action: this.props.undo,\n      },\n      {\n        label: \"Redo\",\n        action: this.props.redo,\n      },\n      {\n        label: \"Load Deck by ID\",\n        action: () => {\n          this.setState({\n            showDeckImporter: true,\n            deckImporterPosition: this.stage?.getPointerPosition() ?? {\n              x: 0,\n              y: 0,\n            },\n          });\n        },\n      },\n      {\n        label: \"Load Deck from json file\",\n        fileLoadedAction: (jsonContents: string) => {\n          this.props.createDeckFromJson({\n            gameType: this.props.currentGameType,\n            position: this.stage?.getPointerPosition() ?? { x: 0, y: 0 },\n            jsonContents,\n          });\n        },\n        fileUploader: true,\n      },\n      {\n        label: `Load ${\n          GamePropertiesMap[this.props.currentGameType].encounterUiName\n        }`,\n        action: () => {\n          this.setState({\n            showEncounterImporter: true,\n            encounterImporterPosition: this.stage?.getPointerPosition() ?? null,\n          });\n        },\n      },\n      {\n        label: `Load Specific Card`,\n        action: () => {\n          this.props.showSpecificCardLoader(\n            this.stage?.getPointerPosition() || { x: 0, y: 0 }\n          );\n        },\n      },\n      {\n        label: \"Create new counter\",\n        action: () => {\n          this.props.addNewCounter(\n            this.getRelativePositionFromTarget(this.stage) ?? { x: 0, y: 0 }\n          );\n        },\n      },\n      { label: \"Reset Game\", action: this.props.resetApp },\n      {\n        label: \"Quit Game\",\n        action: () => {\n          this.props.quitGame();\n          this.props.resetApp();\n        },\n      },\n      {\n        label: \"Connect to Remote Game\",\n        action: () => {\n          this.setState({\n            showPeerConnector: true,\n            peerConnectorPosition: this.stage?.getPointerPosition() ?? null,\n          });\n        },\n      },\n      {\n        label: \"Request resync from Remote Game\",\n        action: this.props.requestResync,\n      },\n      {\n        label: `Peer id is ${this.props.peerId}`,\n        action: () => {\n          if (!!this.props.peerId) {\n            copyToClipboard(generateRemoteGameUrl(this.props.peerId));\n          }\n        },\n      },\n      {\n        label: `Copy game state as url`,\n        action: () => {\n          this.props.generateGameStateUrl();\n        },\n      },\n      {\n        label: `Version 278`,\n        action: () => {},\n      },\n    ];\n\n    this.setState({\n      showContextMenu: true,\n      contextMenuPosition: pos ?? this.stage?.getPointerPosition() ?? null,\n      contextMenuItems: menuItems,\n    });\n  };\n\n  private getCardType = (card: ICardStack): string => {\n    if (Object.keys(this.props.cardsData).length === 0) return \"\";\n    let cardData;\n    const mainCardData = this.props.cardsData[card.cardStack[0].jsonId];\n    if (!!mainCardData) {\n      cardData = mainCardData;\n      if (!card.faceup && !!mainCardData.backLink) {\n        cardData = this.props.cardsData[mainCardData.backLink];\n      }\n    }\n\n    return (cardData?.typeCode ?? \"\").toLocaleLowerCase();\n  };\n\n  private getCardName = (card: ICardStack) => {\n    const cardInQuestion = card.faceup\n      ? card.cardStack[0]\n      : card.cardStack[card.cardStack.length - 1];\n    return this.props.cardsData[cardInQuestion.jsonId]?.name ?? \"\";\n  };\n\n  private getCardCode = (card: ICardStack) => {\n    const cardInQuestion = card.faceup\n      ? card.cardStack[0]\n      : card.cardStack[card.cardStack.length - 1];\n\n    if (!cardInQuestion) {\n      console.error(\"Could not get card in question for stack:\", card);\n    }\n\n    const idToGrab = cardInQuestion?.jsonId ?? \"missing-id\";\n\n    return (\n      this.props.cardsData[idToGrab]?.code ?? `code missing for ${idToGrab}`\n    );\n  };\n\n  private handleResize = () => {\n    this.setState({\n      stageHeight: window.innerHeight,\n      stageWidth: window.innerWidth,\n    });\n  };\n}\n\nexport default Game;\n","export const packList = [\n\"ant.json\",\n\"ant_encounter.json\",\n\"bkw.json\",\n\"bkw_encounter.json\",\n\"cap.json\",\n\"cap_encounter.json\",\n\"core.json\",\n\"core_encounter.json\",\n\"drax.json\",\n\"drax_encounter.json\",\n\"drs.json\",\n\"drs_encounter.json\",\n\"gam.json\",\n\"gam_encounter.json\",\n\"gmw.json\",\n\"gmw_encounter.json\",\n\"gob_encounter.json\",\n\"hlk.json\",\n\"hlk_encounter.json\",\n\"msm.json\",\n\"msm_encounter.json\",\n\"mts.json\",\n\"mts_encounter.json\",\n\"nebu.json\",\n\"nebu_encounter.json\",\n\"qsv.json\",\n\"qsv_encounter.json\",\n\"ron_encounter.json\",\n\"scw.json\",\n\"scw_encounter.json\",\n\"stld.json\",\n\"stld_encounter.json\",\n\"thor.json\",\n\"thor_encounter.json\",\n\"toafk_encounter.json\",\n\"trors.json\",\n\"trors_encounter.json\",\n\"twc_encounter.json\",\n\"vnm.json\",\n\"vnm_encounter.json\",\n\"warm.json\",\n\"warm_encounter.json\",\n\"wsp.json\",\n\"wsp_encounter.json\",\n];","export const packList = [\n\"A Journey To Rhosgobel.json\",\n\"A Journey to Rhosgobel Nightmare.json\",\n\"A Knife in the Dark Nightmare.json\",\n\"A Shadow in the East.json\",\n\"A Shadow of the Past Nightmare.json\",\n\"A Storm on Cobas Haven Nightmare.json\",\n\"A Storm on Cobas Haven.json\",\n\"Across the Ettenmoors Nightmare.json\",\n\"Across the Ettenmoors.json\",\n\"Among the Outlaws.json\",\n\"Assault on Osgiliath Nightmare.json\",\n\"Assault on Osgiliath.json\",\n\"Attack on Dol Guldur.json\",\n\"Beneath the Sands.json\",\n\"Breaking of the Fellowship Nightmare.json\",\n\"Celebrimbor's Secret Nightmare.json\",\n\"Celebrimbor's Secret.json\",\n\"Challenge of the Wainriders.json\",\n\"Children of Eorl.json\",\n\"Conflict at the Carrock Nightmare.json\",\n\"Conflict at the Carrock.json\",\n\"Core Set.json\",\n\"Deadmen's Dike Nightmare.json\",\n\"Dungeons Deep and Caverns Dim Nightmare.json\",\n\"Encounter at Amon Dn Nightmare.json\",\n\"Encounter at Amon Dn.json\",\n\"Escape From Dol Guldur Nightmare.json\",\n\"Escape from Khazad-dm.json\",\n\"Escape from Mount Gram Nightmare.json\",\n\"Escape from Mount Gram.json\",\n\"Fire in the Night.json\",\n\"Fire on the Eastemnet.json\",\n\"First Age.json\",\n\"Flies and Spiders Nightmare.json\",\n\"Flight from Moria Nightmare.json\",\n\"Flight of the Stormcaller Nightmare.json\",\n\"Flight of the Stormcaller.json\",\n\"Flight to the Ford Nightmare.json\",\n\"Fog on the Barrow-downs.json\",\n\"Foundations of Stone Nightmare.json\",\n\"Foundations of Stone.json\",\n\"Heirs of Nmenor.json\",\n\"Helm's Deep Nightmare.json\",\n\"Into Fangorn Nightmare.json\",\n\"Into Ithilien Nightmare.json\",\n\"Into the Pit Nightmare.json\",\n\"Intruders in Chetwood Nightmare.json\",\n\"Journey Along the Anduin Nightmare.json\",\n\"Journey in the Dark Nightmare.json\",\n\"Journey to the Cross-roads Nightmare.json\",\n\"Khazad-dm.json\",\n\"Mount Gundabad.json\",\n\"Murder at the Prancing Pony.json\",\n\"Over the Misty Mountains Grim Nightmare.json\",\n\"Passage Through Mirkwood Nightmare.json\",\n\"Peril in Pelargir Nightmare.json\",\n\"Race Across Harad.json\",\n\"Raid on the Grey Havens Nightmare.json\",\n\"Return to Mirkwood Nightmare.json\",\n\"Return to Mirkwood.json\",\n\"Revised Core Set.json\",\n\"Road to Rivendell Nightmare.json\",\n\"Road to Rivendell.json\",\n\"Roam Across Rhovanion.json\",\n\"Shadow and Flame Nightmare.json\",\n\"Shadow and Flame.json\",\n\"Shelob's Lair Nightmare.json\",\n\"Temple of the Deceived Nightmare.json\",\n\"Temple of the Deceived.json\",\n\"The Aldburg Plot.json\",\n\"The Antlered Crown Nightmare.json\",\n\"The Antlered Crown.json\",\n\"The Battle of Carn Dm Nightmare.json\",\n\"The Battle of Carn Dm.json\",\n\"The Battle of Five Armies Nightmare.json\",\n\"The Battle of Lake-town.json\",\n\"The Betrayal of Mm.json\",\n\"The Black Riders.json\",\n\"The Black Serpent.json\",\n\"The Blood of Gondor Nightmare.json\",\n\"The Blood of Gondor.json\",\n\"The City of Corsairs Nightmare.json\",\n\"The City of Corsairs.json\",\n\"The City of Ulfast.json\",\n\"The Crossings of Poros.json\",\n\"The Dark of Mirkwood.json\",\n\"The Dead Marshes Nightmare.json\",\n\"The Dead Marshes.json\",\n\"The Dread Realm Nightmare.json\",\n\"The Dread Realm.json\",\n\"The Drowned Ruins Nightmare.json\",\n\"The Drowned Ruins.json\",\n\"The Dradan Forest Nightmare.json\",\n\"The Dradan Forest.json\",\n\"The Dungeons of Cirith Gurat.json\",\n\"The Dunland Trap Nightmare.json\",\n\"The Dunland Trap.json\",\n\"The Fall of Nargothrond.json\",\n\"The Fate of Nmenor Nightmare.json\",\n\"The Fate of Wilderland.json\",\n\"The Flame of the West.json\",\n\"The Fords of Isen Nightmare.json\",\n\"The Fortress of Nurn.json\",\n\"The Ghost of Framsburg.json\",\n\"The Grey Havens.json\",\n\"The Hills of Emyn Muil Nightmare.json\",\n\"The Hills of Emyn Muil.json\",\n\"The Hobbit: On the Doorstep.json\",\n\"The Hobbit: Over Hill and Under Hill.json\",\n\"The Hunt for Gollum Nightmare.json\",\n\"The Hunt for Gollum.json\",\n\"The Hunt for the Dreadnaught.json\",\n\"The Land of Shadow.json\",\n\"The Land of Sorrow.json\",\n\"The Lonely Mountain Nightmare.json\",\n\"The Long Dark Nightmare.json\",\n\"The Long Dark.json\",\n\"The Lost Realm.json\",\n\"The Massing at Osgiliath.json\",\n\"The Mines of Moria.json\",\n\"The Morgul Vale Nightmare.json\",\n\"The Morgul Vale.json\",\n\"The Mountain of Fire.json\",\n\"The Mmakil.json\",\n\"The Nn-in-Eilph Nightmare.json\",\n\"The Nn-in-Eilph.json\",\n\"The Old Forest.json\",\n\"The Passage of the Marshes Nightmare.json\",\n\"The Redhorn Gate Nightmare.json\",\n\"The Redhorn Gate.json\",\n\"The Ring Goes South Nightmare.json\",\n\"The Road Darkens.json\",\n\"The Road to Isengard Nightmare.json\",\n\"The Ruins of Belegost.json\",\n\"The Sands of Harad.json\",\n\"The Scouring of the Shire.json\",\n\"The Seventh Level Nightmare.json\",\n\"The Siege of Annminas.json\",\n\"The Siege of Cair Andros Nightmare.json\",\n\"The Steward's Fear Nightmare.json\",\n\"The Steward's Fear.json\",\n\"The Stone of Erech.json\",\n\"The Thing in the Depths Nightmare.json\",\n\"The Thing in the Depths.json\",\n\"The Three Trials Nightmare.json\",\n\"The Three Trials.json\",\n\"The Treachery of Rhudaur Nightmare.json\",\n\"The Treachery of Rhudaur.json\",\n\"The Treason of Saruman.json\",\n\"The Uruk-hai Nightmare.json\",\n\"The Voice of Isengard.json\",\n\"The Wastes of Eriador Nightmare.json\",\n\"The Wastes of Eriador.json\",\n\"The Watcher in the Water Nightmare.json\",\n\"The Watcher in the Water.json\",\n\"The Weather Hills Nightmare.json\",\n\"The Wilds of Rhovanion.json\",\n\"The Withered Heath.json\",\n\"The Wizard's Quest.json\",\n\"The Woodland Realm.json\",\n\"To Catch an Orc Nightmare.json\",\n\"Trial Upon the Marches.json\",\n\"Trouble in Tharbad Nightmare.json\",\n\"Trouble in Tharbad.json\",\n\"Two-Player Limited Edition Starter.json\",\n\"Under the Ash Mountains.json\",\n\"Voyage Across Belegaer Nightmare.json\",\n\"We Must Away, Ere Break of Day Nightmare.json\",\n\"Wrath and Ruin.json\",\n];","import { Action, ThunkAction } from \"@reduxjs/toolkit\";\nimport axios, { AxiosResponse } from \"axios\";\nimport { CardPack as CardPackMarvel } from \"../../external-api/marvel-card-data\";\nimport {\n  CardPack as CardPackLOTR,\n  Scenario,\n} from \"../../external-api/beorn-json-data\";\nimport { packList as marvelPackList } from \"../../generated/packsList\";\nimport { packList as lotrPackList } from \"../../generated/packsList_lotr\";\nimport scenarioListLOTR from \"../../external/ringsteki-json-data/scenarios.json\";\nimport { RootState } from \"../../store/rootReducer\";\nimport {\n  loadCardsDataForPack,\n  loadCardsForEncounterSet,\n} from \"./cards-data.slice\";\nimport { GameType } from \"../../constants/app-constants\";\n\nexport const allJsonData = (): ThunkAction<\n  void,\n  RootState,\n  unknown,\n  Action<string>\n> => async (dispatch) => {\n  let resultsList = await Promise.all(\n    marvelPackList.map((pack) => getSpecificMarvelPack(pack))\n  );\n\n  resultsList.forEach((result) => {\n    if (result.res.status === 200) {\n      dispatch(\n        loadCardsDataForPack({\n          packType: GameType.MarvelChampions,\n          pack: result.res.data as any,\n          pack_code: result.packCode,\n        })\n      );\n    } else {\n      console.error(\"Failed to load some json data\");\n    }\n  });\n\n  const resultsListLOTR = await Promise.all(\n    lotrPackList.map((pack) => getSpecificLOTRPack(pack))\n  );\n\n  resultsListLOTR.forEach((result) => {\n    if (result.res.status === 200) {\n      dispatch(\n        loadCardsDataForPack({\n          packType: GameType.LordOfTheRingsLivingCardGame,\n          pack: result.res.data as any,\n          pack_code: result.packCode,\n        })\n      );\n    } else {\n      console.error(\"Failed to load some json data\");\n    }\n  });\n\n  const resultsListLOTRScenarios = await Promise.all(\n    scenarioListLOTR.map((scenario) => getSpecificLOTRScenario(scenario.Title))\n  );\n\n  resultsListLOTRScenarios.forEach((result) => {\n    if (result.status === 200) {\n      dispatch(\n        loadCardsForEncounterSet({\n          setCode: result.data.Slug,\n          cards: result.data.AllCards,\n        })\n      );\n    } else {\n      console.error(\"Failed to load some json data\");\n    }\n  });\n};\n\nconst getSpecificMarvelPack = async (\n  packName: string\n): Promise<{ res: AxiosResponse<CardPackMarvel>; packCode: string }> => {\n  const response = await axios.get<CardPackMarvel>(\n    process.env.PUBLIC_URL + \"/json_data/\" + packName\n  );\n  return {\n    res: response,\n    packCode: packName.split(\".json\")[0],\n  };\n};\n\nconst getSpecificLOTRPack = async (\n  packName: string\n): Promise<{ res: AxiosResponse<CardPackLOTR>; packCode: string }> => {\n  const response = await axios.get<CardPackLOTR>(\n    process.env.PUBLIC_URL + \"/json_data/\" + packName\n  );\n  return {\n    res: response,\n    packCode: packName.split(\".json\")[0],\n  };\n};\n\nconst getSpecificLOTRScenario = async (\n  scenario: string\n): Promise<AxiosResponse<Scenario>> => {\n  const response = await axios.get<Scenario>(\n    process.env.PUBLIC_URL + \"/json_data/scenarios/\" + scenario + \".json\"\n  );\n  return response;\n};\n","import { connect } from \"react-redux\";\nimport { ActionCreators } from \"redux-undo\";\nimport Game from \"./Game\";\nimport { getCardsDataEntities } from \"./features/cards-data/cards-data.selectors\";\nimport { loadCardsData } from \"./features/cards-data/cards-data.slice\";\nimport {\n  getCards,\n  getDropTargetCardsById,\n  getMultiselectMode,\n  getPanMode,\n} from \"./features/cards/cards.selectors\";\nimport {\n  adjustCounterToken,\n  cardMove,\n  endCardMove,\n  cardFromHandMove,\n  exhaustCard,\n  deleteCardStack,\n  flipCards,\n  selectCard,\n  selectMultipleCards,\n  togglePanMode,\n  toggleSelectCard,\n  toggleToken,\n  unselectAllCards,\n  unselectCard,\n  adjustModifier,\n  clearAllModifiers,\n  addToPlayerHand,\n  addToExistingCardStack,\n  addExtraIcon,\n  removeExtraIcon,\n} from \"./features/cards/cards.slice\";\nimport {\n  addCardStack,\n  fetchDecklistById,\n  pullCardOutOfCardStack,\n  startCardMove,\n  shuffleStack,\n  drawCardsOutOfCardStack,\n  createDeckFromTxt,\n  createDeckFromJson,\n} from \"./features/cards/cards.thunks\";\nimport {\n  generateGameStateUrl,\n  saveDeckAsJson,\n} from \"./features/game/game.thunks\";\nimport { allJsonData } from \"./features/cards-data/cards-data.thunks\";\nimport {\n  getGame,\n  getMenuPreviewCard,\n  getPeerId,\n  getPlayerColors,\n  getPlayerNumbers,\n} from \"./features/game/game.selectors\";\nimport {\n  connectToRemoteGame,\n  updatePosition,\n  updateZoom,\n  requestResync,\n  setPreviewCardId,\n  clearPreviewCard,\n  quitGame,\n  showRadialMenuAtPosition,\n  showSpecificCardLoader,\n} from \"./features/game/game.slice\";\n\nimport {\n  moveCounter,\n  removeCounter,\n  updateCounterValue,\n  updateCounterColor,\n} from \"./features/counters/counters.slice\";\nimport { addNewCounter } from \"./features/counters/counters.thunks\";\nimport { resetApp } from \"./store/global.actions\";\nimport { RootState } from \"./store/rootReducer\";\nimport { getCurrentCounters } from \"./features/counters/counters.selectors\";\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    playerColors: getPlayerColors(state),\n    playerNumbers: getPlayerNumbers(state),\n    cards: getCards(state),\n    cardsData: getCardsDataEntities(state),\n    panMode: getPanMode(state),\n    multiselectMode: getMultiselectMode(state),\n    gameState: getGame(state),\n    counters: getCurrentCounters(state),\n    peerId: getPeerId(state),\n    dropTargetCardsById: getDropTargetCardsById(state),\n    menuPreviewCard: getMenuPreviewCard(state),\n  };\n};\n\nconst GameContainer = connect(mapStateToProps, {\n  cardMove,\n  endCardMove,\n  cardFromHandMove,\n  exhaustCard,\n  deleteCardStack,\n  loadCardsData,\n  allJsonData,\n  selectCard,\n  unselectCard,\n  toggleSelectCard,\n  selectMultipleCards,\n  startCardMove,\n  unselectAllCards,\n  togglePanMode,\n  flipCards,\n  shuffleStack,\n  fetchDecklistById,\n  updateZoom,\n  updatePosition,\n  resetApp,\n  addCardStack,\n  toggleToken,\n  adjustCounterToken,\n  pullCardOutOfCardStack,\n  addNewCounter,\n  updateCounterValue,\n  removeCounter,\n  moveCounter,\n  connectToRemoteGame,\n  requestResync,\n  undo: ActionCreators.undo,\n  redo: ActionCreators.redo,\n  drawCardsOutOfCardStack,\n  setPreviewCardId,\n  clearPreviewCard,\n  quitGame,\n  updateCounterColor,\n  createDeckFromTxt,\n  createDeckFromJson,\n  generateGameStateUrl,\n  saveDeckAsJson,\n  showRadialMenuAtPosition,\n  showSpecificCardLoader,\n  adjustModifier,\n  clearAllModifiers,\n  addToPlayerHand,\n  addToExistingCardStack,\n  addExtraIcon,\n  removeExtraIcon,\n})(Game);\n\nexport default GameContainer;\n","import { Vector2d } from \"konva/lib/types\";\nimport { Action } from \"redux\";\nimport { ThunkAction } from \"redux-thunk\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { RootState } from \"../../store/rootReducer\";\nimport { addNewCounterWithId } from \"./counters.actions\";\n\nexport const addNewCounter =\n  (pos: Vector2d): ThunkAction<void, RootState, unknown, Action<string>> =>\n  (dispatch) => {\n    const payloadWithId = {\n      pos,\n      id: uuidv4(),\n    };\n    dispatch(addNewCounterWithId(payloadWithId));\n  };\n","import { Vector2d } from \"konva/lib/types\";\nimport { CardData } from \"../external-api/common-card-data\";\n\nexport const convertMarvelTxtToDeckInfo = (\n  heroDataByName: { [key: string]: CardData },\n  playerCardDataByName: { [key: string]: CardData },\n  position: Vector2d,\n  txtContents: string\n) => {\n  const nonEmptyLines = txtContents\n    .split(\"\\n\")\n    .map((l) => l.trim())\n    .filter((l) => !!l);\n\n  let heroName = \"\";\n  const packLineIndex = nonEmptyLines.findIndex((l) =>\n    l.toLocaleLowerCase().startsWith(\"pack\")\n  );\n  if (packLineIndex !== -1) {\n    heroName = nonEmptyLines[packLineIndex - 1];\n  }\n\n  const hero = heroDataByName[heroName];\n  if (!hero) {\n    throw new Error(`Could not find hero with name ${heroName}`);\n  }\n\n  // Mock out the slots\n  const pattern = /^\\dx/;\n  const slotLines = nonEmptyLines.filter((l) => l.match(pattern)?.index === 0);\n  let slots: { [key: string]: number } = {};\n\n  slotLines.forEach((sl) => {\n    // first character should be a number\n    const quantity = parseInt(sl[0]);\n    if (Number.isNaN(quantity)) {\n      throw new Error(\"Could not get number from txt file for card\");\n    }\n\n    const cardName = sl.split(pattern)[1].split(\"(\")[0].trim();\n    const card = playerCardDataByName[cardName];\n    slots[card.code] = quantity;\n  });\n\n  console.log(heroName);\n  return {\n    data: {\n      investigator_code: hero.code,\n      slots,\n    },\n  };\n};\n","import { Action, ThunkAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../../store/rootReducer\";\nimport JSONCrush from \"jsoncrush\";\nimport { copyToClipboard, getBaseUrl } from \"../../utilities/text-utils\";\nimport { ICardStack } from \"../cards/initialState\";\nexport const generateGameStateUrl =\n  (): ThunkAction<void, RootState, unknown, Action<any>> =>\n  (_dispatch, getState) => {\n    const currentStoreState = getState();\n\n    const cards = currentStoreState.liveState.present.cards.cards;\n    const counters = currentStoreState.liveState.present.counters;\n    const gameType = currentStoreState.game.activeGameType;\n    const crushedCardsString = JSONCrush.crush(JSON.stringify(cards));\n    const crushedCountersString = JSONCrush.crush(JSON.stringify(counters));\n    copyToClipboard(\n      `${getBaseUrl()}?gameType=${gameType}&cards=${encodeURIComponent(\n        crushedCardsString\n      )}&counters=${encodeURIComponent(crushedCountersString)}`\n    );\n  };\n\nexport const clearQueryParams =\n  (): ThunkAction<void, RootState, unknown, Action<any>> => () => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const queryParamsGameType = queryParams.get(\"gameType\");\n    if (!!queryParamsGameType) {\n      window.history.replaceState(\n        {},\n        document.title,\n        window.location.pathname || \"/\"\n      );\n    }\n  };\n\nexport const saveDeckAsJson =\n  (\n    cardStack: ICardStack | undefined\n  ): ThunkAction<void, RootState, unknown, Action<any>> =>\n  () => {\n    if (!cardStack || cardStack.cardStack.length < 1) return;\n\n    const topCard = cardStack.cardStack[0];\n\n    // convert to an object\n    const objectData: any = {\n      data: {\n        investigator_code: topCard.jsonId,\n      },\n    };\n\n    const slots: { [key: string]: number } = {};\n\n    cardStack.cardStack.forEach((c, index) => {\n      if (index === 0) return;\n\n      if (!!slots[c.jsonId]) {\n        slots[c.jsonId] = slots[c.jsonId] + 1;\n      } else {\n        slots[c.jsonId] = 1;\n      }\n    });\n\n    objectData.data.slots = slots;\n\n    let filename = `${topCard.jsonId}_deck.json`;\n    let contentType = \"application/json;charset=utf-8;\";\n\n    var a = document.createElement(\"a\");\n    a.style.display = \"none\";\n    a.download = filename;\n    a.href =\n      \"data:\" +\n      contentType +\n      \",\" +\n      encodeURIComponent(JSON.stringify(objectData, null, 2));\n    a.target = \"_blank\";\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n  };\n","export default __webpack_public_path__ + \"static/media/card-table-transparent.c608764a.png\";","import React, { useEffect } from \"react\";\nimport { GameType } from \"./constants/app-constants\";\nimport GameContainer from \"./GameContainer\";\nimport \"./App.scss\";\nimport Select from \"@material-ui/core/Select\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport mainLogo from \"./images/card-table-transparent.png\";\ninterface IProps {\n  activeGameType: GameType | null;\n  updateActiveGameType: (val: GameType) => void;\n  clearQueryParams: () => void;\n}\n\nconst App = (props: IProps) => {\n  const clearQueryParams = props.clearQueryParams;\n  useEffect(() => {\n    clearQueryParams();\n  }, [clearQueryParams]);\n\n  return !!props.activeGameType ? (\n    <GameContainer currentGameType={props.activeGameType}></GameContainer>\n  ) : (\n    renderGamePicker(props)\n  );\n};\n\nconst camelCaseToSpaces = (str: string) => {\n  // insert a space before all caps\n  return (\n    str\n      .replace(/([A-Z])/g, \" $1\")\n      // uppercase the first character\n      .replace(/^./, (s) => {\n        return s.toUpperCase();\n      })\n  );\n};\n\nconst renderGamePicker = (props: IProps) => {\n  return (\n    <div className=\"game-picker\">\n      <img className=\"logo\" alt=\"cardtable\" src={mainLogo}></img>\n      <FormControl className=\"select\">\n        <InputLabel id=\"game-picker-label\">Select Game</InputLabel>\n        <Select\n          id=\"game-picker\"\n          labelId=\"game-picker-label\"\n          onChange={(e) => {\n            props.updateActiveGameType(e.target.value as GameType);\n          }}\n        >\n          {Object.entries(GameType).map(([key, value]) => {\n            const label = camelCaseToSpaces(key);\n            return <MenuItem value={value}>{label}</MenuItem>;\n          })}\n        </Select>\n      </FormControl>\n    </div>\n  );\n};\n\nexport default App;\n","import { connect } from \"react-redux\";\nimport App from \"./App\";\nimport { getActiveGameType } from \"./features/game/game.selectors\";\nimport { updateActiveGameType } from \"./features/game/game.slice\";\nimport { clearQueryParams } from \"./features/game/game.thunks\";\nimport { RootState } from \"./store/rootReducer\";\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    activeGameType: getActiveGameType(state),\n  };\n};\n\nconst AppContainer = connect(mapStateToProps, {\n  updateActiveGameType,\n  clearQueryParams,\n})(App);\n\nexport default AppContainer;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.scss\";\nimport { Provider } from \"react-redux\";\nimport * as serviceWorkerRegistration from \"./serviceWorkerRegistration\";\nimport configureStore from \"./store/configureStore\";\nimport AppContainer from \"./AppContainer\";\n\nconst store = configureStore();\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <AppContainer />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorkerRegistration.register();\n"],"sourceRoot":""}